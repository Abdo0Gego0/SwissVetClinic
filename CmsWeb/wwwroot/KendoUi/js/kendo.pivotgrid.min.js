/** 
 * Kendo UI v2022.1.119 (http://www.telerik.com/kendo-ui)                                                                                                                                               
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.                                                                                      
 *                                                                                                                                                                                                      
 * Kendo UI commercial licenses may be obtained at                                                                                                                                                      
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete                                                                                                                                  
 * If you do not own a commercial license, this file shall be governed by the trial license terms.                                                                                                      
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       

*/
!function(e,define){define("pivotgrid/common.min",["kendo.core.min"],e)}(function(){!function(){window.kendo.pivotgrid=window.kendo.pivotgrid||{},window.kendo.pivotgrid.common=function(e){function t(e,t){var n,a="",s="";for(n=e.length-1;n>=0;n--)s="SELECT (",s+=r(e[n]),s+=") ON 0",n===e.length-1?(s+=" FROM ["+t+"]",a=s):a=s+" FROM ( "+a+" )";return a}function r(e){var t="",r=e.value+"",a=e.field,s=e.operator;return s===L["in"]?(t+="{",t+=r,t+="}"):(t+=s===L.neq||s===L.doesnotcontain?"-":"",t+="Filter(",t+=a+".MEMBERS",t+=n(U[s],a,r),t+=")"),t}function n(e){var t,r=[];for(t=1;t<arguments.length;t++)r[t-1]=arguments[t];return r.forEach(function(t,r){e=e.replace(RegExp("\\{"+r+"\\}","g"),t)}),e}function a(e,t,r){var n,a,s,h,d,p,m,f,g="";if(e=e||[],n=o(e),a=n.expanded,s=i(n.root),h=[],d=a.length,p=0,f=[],s.length>1||t.length>1){for(h.push(u(s,t));p<d;p++)m=c(a[p].name,r),f=l(m,s),h.push(u(f,t));g+=h.join(",")}else{for(;p<d;p++)m=c(a[p].name,r),f.push(m[0]);g+=s.concat(f).join(",")}return g}function s(e){var t,r,n=e.length,a=[];for(r=0;r<n;r++)t=e[r],a.push(void 0!==t.name?t.name:t);return a}function i(e){var t=[];return e.forEach(function(e){var r=e.name[0],n=d(r);t.some(function(e){return 0===e.indexOf(n)})||t.push(r)}),t}function o(e){for(var t,r,n,a,s,i,o=[],l=[],u=[],c=0;c<e.length;c++)if(r=e[c],n=r.name,t=!1,n.length>1)l.push(r);else{for(a=d(n[0]),s=0,i=u.length;s<i;s++)if(0===u[s].name[0].indexOf(a)){t=!0;break}t||u.push(r),r.expand&&o.push(r)}return o=o.concat(l),{expanded:o,root:u}}function l(e,t){var r,n,a,s,i=t.length;for(t=t.slice(0),r=0;r<e.length;r++)for(n=e[r],a=0;a<i;a++)if(s=d(t[a]),n.indexOf(s)!==-1){t[a]=n;break}return t}function u(e,t){var r=e.slice(0);return t.length>1&&r.push("{"+s(t).join(",")+"}"),p(r)}function c(e,t){var r=e.length-1,n=e[r],a=h(t,n);return a&&a.dir?n="ORDER("+n+".Children,"+a.field+".CurrentMember.MEMBER_CAPTION,"+a.dir+")":n+=".Children",e[r]=n,e}function h(e,t){for(var r=0,n=e.length;r<n;r++)if(0===t.indexOf(e[r].field))return e[r];return null}function d(e){var t=e.split(".");return t.length>2?t[0]+"."+t[1]:e}function p(e){var t,r="CROSSJOIN({";return e.length>2?(t=e.pop(),r+=p(e)):(r+=e.shift(),t=e.pop()),r+="},{",r+=t,r+="})"}function m(e){var r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>',n=e.columnAxes,i=void 0===n?[]:n,o=e.rowAxes,l=void 0===o?[]:o,u=e.measureAxes,c=void 0===u?[]:u,h=e.sort,d=void 0===h?[]:h,p=e.filter,m=void 0===p?[]:p,f="rows"===e.measuresAxis;return r+="SELECT NON EMPTY {",!i.length&&l.length&&(!c.length||c.length&&f)&&(i=l,l=[],f=!1),i.length||l.length||(f=!1),i.length?r+=a(i,f?[]:c,d):c.length&&!f&&(r+=s(c).join(",")),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(l.length||f&&c.length>1)&&(r+=", NON EMPTY {",r+=l.length?a(l,f?c:[],d):s(c).join(","),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),m.length?(r+=" FROM ",r+="(",r+=t(m,e.connection.cube),r+=")"):r+=" FROM ["+e.connection.cube+"]",1===c.length&&i.length&&(r+=" WHERE ("+s(c).join(",")+")"),r+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>",r.replace(/&/g,"&amp;")}function f(e,t,r,n){function a(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?r(e.value):a(e.value).then(i,o)}l((n=n.apply(e,t||[])).next())})}function g(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,s&&(i=2&r[0]?s["return"]:r[0]?s["throw"]||((i=s["return"])&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,s=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(n){r=[6,n],s=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var a,s,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}function _(){var e,t,r,n,a,s,i,o;for(e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(n=Array(e),a=0,t=0;t<r;t++)for(s=arguments[t],i=0,o=s.length;i<o;i++,a++)n[a]=s[i];return n}function v(e){var t,r,n=(new DOMParser).parseFromString(e,"text/xml"),a=Array.from(n.querySelectorAll("Axis")),s=Array.from(n.querySelectorAll("CellData > Cell")).map(function(e){return{fmtValue:x(e,"FmtValue"),ordinal:parseInt(e.getAttribute("CellOrdinal"),10),value:x(e,"Value")}}),i={tuples:[]},o={tuples:[]},l=[];return a.forEach(function(e){if("SlicerAxis"!==e.getAttribute("name")){var t=0===i.tuples.length?i.tuples:o.tuples;Array.prototype.push.apply(t,A(e))}}),t=Array(o.tuples.length*i.tuples.length).fill(null),s.forEach(function(e){t[e.ordinal]=e}),r=0,o.tuples.forEach(function(e){i.tuples.forEach(function(n){l.push({columnTuple:n,data:t[r],rowTuple:e}),r++})}),{columns:i,data:l,rows:o}}function x(e,t){var r=e.querySelector(t);return r?r.textContent:""}function A(e){var t=Array.from(e.querySelectorAll("Tuple"));return t.map(function(e){var t=Array.from(e.querySelectorAll("Member")),r=t.map(function(e){var t=parseInt(x(e,"LNum")||"0",10),r=parseInt(x(e,"CHILDREN_CARDINALITY")||"0",10)>0;return{caption:x(e,"Caption"),children:[],hasChildren:r,hierarchy:e.getAttribute("Hierarchy"),levelName:x(e,"LName"),levelNum:t,name:x(e,"UName"),parentName:x(e,"PARENT_UNIQUE_NAME")}});return{members:r}})}function N(e){var t={},r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';return r+="<RequestType>"+(G[e.command]||e.command)+"</RequestType>",r+="<Restrictions>"+I("RestrictionList",e.restrictions,!0)+"</Restrictions>",e.connection&&e.connection.catalog&&(t.Catalog=e.connection.catalog),r+="<Properties>"+I("PropertyList",t,!1)+"</Properties>",r+="</Discover></Body></Envelope>"}function I(e,t,r){var n,a,s="";if(t){s+="<"+e+">",n=void 0;for(a in t)t[a]&&(n=t[a],r&&(a=a.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),s+="<"+a+">"+n+"</"+a+">");s+="</"+e+">"}else s+="<"+e+"/>";return s}function w(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"CUBE_NAME"),caption:x(e,"CUBE_CAPTION"),description:x(e,"DESCRIPTION"),type:x(e,"CUBE_TYPE")}});return r}function T(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"CATALOG_NAME"),description:x(e,"DESCRIPTION")}});return r}function E(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"MEASURE_NAME"),caption:x(e,"MEASURE_CAPTION"),uniqueName:x(e,"MEASURE_UNIQUE_NAME"),description:x(e,"DESCRIPTION"),aggregator:x(e,"MEASURE_AGGREGATOR"),groupName:x(e,"MEASUREGROUP_NAME"),displayFolder:x(e,"MEASURE_DISPLAY_FOLDER"),defaultFormat:x(e,"DEFAULT_FORMAT_STRING")}});return r}function b(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"KPI_NAME"),uniqueName:x(e,"KPI_NAME"),caption:x(e,"KPI_CAPTION"),value:x(e,"KPI_VALUE"),goal:x(e,"KPI_GOAL"),status:x(e,"KPI_STATUS"),trend:x(e,"KPI_TREND"),statusGraphic:x(e,"KPI_STATUS_GRAPHIC"),trendGraphic:x(e,"KPI_TREND_GRAPHIC"),description:x(e,"KPI_DESCRIPTION"),groupName:x(e,"MEASUREGROUP_NAME"),type:"kpi"}});return r}function S(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{caption:x(e,"DIMENSION_CAPTION"),defaultHierarchy:x(e,"DEFAULT_HIERARCHY"),description:x(e,"DESCRIPTION"),name:x(e,"DIMENSION_NAME"),type:parseInt(x(e,"DIMENSION_TYPE"),10),uniqueName:x(e,"DIMENSION_UNIQUE_NAME")}});return r}function O(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"HIERARCHY_NAME"),caption:x(e,"HIERARCHY_CAPTION"),description:x(e,"DESCRIPTION"),uniqueName:x(e,"HIERARCHY_UNIQUE_NAME"),dimensionUniqueName:x(e,"DIMENSION_UNIQUE_NAME"),displayFolder:x(e,"HIERARCHY_DISPLAY_FOLDER"),origin:x(e,"HIERARCHY_ORIGIN"),defaultMember:x(e,"DEFAULT_MEMBER")}});return r}function C(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"LEVEL_NAME"),caption:x(e,"LEVEL_CAPTION"),description:x(e,"DESCRIPTION"),uniqueName:x(e,"LEVEL_UNIQUE_NAME"),dimensionUniqueName:x(e,"DIMENSION_UNIQUE_NAME"),displayFolder:x(e,"LEVEL_DISPLAY_FOLDER"),orderingProperty:x(e,"LEVEL_ORDERING_PROPERTY"),origin:x(e,"LEVEL_ORIGIN"),hierarchyUniqueName:x(e,"HIERARCHY_UNIQUE_NAME")}});return r}function R(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(t.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:x(e,"MEMBER_NAME"),caption:x(e,"MEMBER_CAPTION"),uniqueName:x(e,"MEMBER_UNIQUE_NAME"),dimensionUniqueName:x(e,"DIMENSION_UNIQUE_NAME"),hierarchyUniqueName:x(e,"HIERARCHY_UNIQUE_NAME"),levelUniqueName:x(e,"LEVEL_UNIQUE_NAME"),childrenCardinality:x(e,"CHILDREN_CARDINALITY")}});return r}function y(e){var t,r,n,a=[];for(t=0,r=Object.keys(e);t<r.length;t++)n=r[t],a.push({name:JSON.parse(n),expand:e[n]});return a}function M(e){return JSON.parse(JSON.stringify(e))}function D(e){var t=e.name;return[ae(t,e.value,"value"),ae(t,e.goal,"goal"),ae(t,e.status,"status"),ae(t,e.trend,"trend")]}var P,k,H,U={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}")',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"'},L={doesnotcontain:"doesnotcontain","in":"in",neq:"neq"},F=function(){return F=Object.assign||function(e){var t,r,n,a;for(r=1,n=arguments.length;r<n;r++){t=arguments[r];for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},F.apply(this,arguments)},G={schemaCatalogs:"DBSCHEMA_CATALOGS",schemaCubes:"MDSCHEMA_CUBES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaKPIs:"MDSCHEMA_KPIS",schemaLevels:"MDSCHEMA_LEVELS",schemaMeasures:"MDSCHEMA_MEASURES",schemaMembers:"MDSCHEMA_MEMBERS"},B={schemaCatalogs:T,schemaCubes:w,schemaDimensions:S,schemaHierarchies:O,schemaKPIs:b,schemaLevels:C,schemaMeasures:E,schemaMembers:R},V=function(e,t){return f(void 0,void 0,void 0,function(){var r,n,a;return g(this,function(s){switch(s.label){case 0:return r=F({body:m(t),headers:{"Content-Type":"text/xml"},method:"POST"},e.init),[4,fetch(e.url,r)];case 1:return n=s.sent(),[4,n.text()];case 2:return a=s.sent(),[2,v(a)]}})})},q=function(e,t){return f(void 0,void 0,void 0,function(){var r,n,a;return g(this,function(s){switch(s.label){case 0:return r=F({body:N(t),headers:{"Content-Type":"text/xml"},method:"POST"},e.init),[4,fetch(e.url,r)];case 1:return n=s.sent(),[4,n.text()];case 2:return a=s.sent(),[2,B[t.command](a)]}})})},W=function(e){var t={columns:e.columns.tuples,data:e.data,rows:e.rows.tuples};return t},z=function(e,t){void 0===t&&(t=[]),e.sort=t},Y=function(e,t){void 0===t&&(t=[]),e.filter=t},j=function(e,t){return void 0===t&&(t=new Set),(e.children||[]).forEach(function(e){t.add(e.levelName),j(e,t)}),t.size},K=function(e){var t=0;return(e.children||[]).forEach(function(e){t+=K(e)||1}),t},Q=function(e,t){return(t&&t.hierarchy===e.hierarchy?_((t.normalizedPath||[]).slice(0,-1),[e.name||null]):_(t&&t.normalizedPath?t.normalizedPath:[],[e.name])).filter(Boolean)},X=function(e,t){return(t&&t.hierarchy===e.hierarchy?_((t.path||[]).slice(0,-1),[(0===e.levelNum?e.hierarchy:e.name)||null]):_(t&&t.path?t.path:[],[0===e.levelNum?e.hierarchy:e.name])).filter(Boolean)},$=function(e,t,r,n,a,s,i,o){var l,u,c,h,d,p,m,f,g,_,v,x,A,N;if(void 0===t&&(t=-1),void 0===r&&(r=0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===i&&(i=void 0),void 0===o&&(o=void 0),l=j(e),u=K(e),c=n||l,h=a||u,d=s?s.slice():[],p=i?i.slice():Array(h),m=d.findIndex(function(t){return t&&t.name===e.levelName&&t.level===e.levelNum}),f=d[m],g={name:e.levelName,level:e.levelNum,index:t,cells:Array(h).fill(null)},_=t!==-1&&r!==-1,v={caption:e.caption,name:e.name,levelName:e.levelName,levelNum:e.levelNum,hasChildren:e.hasChildren,parentName:e.parentName,hierarchy:e.hierarchy,total:void 0!==e.total&&e.total||o&&o.children.length<=1&&o.total,parent:o,rowIndex:t,colIndex:r,depth:1,breadth:1,path:e.path||[],normalizedPath:e.normalizedPath||[],children:e.children.filter(function(t){return t.hierarchy===e.hierarchy})},_)if(f)f.cells[r]=v,f.index>=t&&(t=f.index);else if(d[t]&&d[t].cells.length){for(x=t;x<d.length;x++)A=d[x],A.index++;d.splice(t,0,g),d[t].cells[r]=v}else d[t]=g,d[t].cells[r]=v;return N=0,e.children&&e.children.length?e.children.forEach(function(e){var n=$(e,t+1,r+N,c,h,d,p,v),a=n[0],s=n[1],i=n[3];N+=i||1,d=a.slice(),p=s.slice()}):e.normalizedPath&&(p[r]={total:v.total,path:e.normalizedPath}),v.depth=l,v.breadth=u,[d,p,l,u]},J=function(e,t,r){var n,a,s,i,o;for(void 0===t&&(t=null),void 0===r&&(r=0),a=F(F({},e),{total:!0,hasChildren:!1,children:[]}),s=0;s<e.children.length;s++)i=J(e.children[s],e,s),n=n||i.hierarchy,i.hierarchy===n||!t||t.children.some(function(e){return e.total&&e.name===a.name})||e.total||(a.children.push(i),e.children.splice(s,1),s--);return e.children.filter(function(e){return!e.total}).length>=1&&t&&!t.children.some(function(e){return e.total&&e.name===a.name})&&!e.total&&(o=e.children[0].hierarchy,e.hierarchy===o&&t.children.splice(r+1,0,a)),e},Z=function(e){var t,r={children:[]},n={},a=function(t){var a,s=M(e[t]),i="",o=function(e){var t,a,o,l=s.members[e];r.children&&0===r.children.length?t=r:n[i]&&!n[i+l.name]&&0===l.levelNum?t=n[i]:n[i+l.parentName]&&l.levelNum>0&&!n[i+l.parentName+l.name]?t=n[i+l.parentName]:!n[i+l.parentName]&&l.levelNum>0&&!n[i+l.parentName+l.name]&&(a=Object.keys(n).find(function(e){return 0===e.indexOf(l.hierarchy)&&e.lastIndexOf(i+l.parentName)+(i+l.parentName).length===e.length}),a&&(t=n[a])),t&&(l.path=X(l,t),l.normalizedPath=Q(l,t),o=t.children.findIndex(function(e){return e.hierarchy!==t.hierarchy}),o!==-1?t.children.splice(Math.max(o,0),0,l):t.children.push(l)),i+=l.parentName+=l.name,n[i]||(n[i]=l)};for(a=0;a<s.members.length;a++)o(a)};for(t=0;t<e.length;t++)a(t);return M(J(r))},ee=function(e,t,r,n,a){var s=Array.from(Array(a),function(){return{cells:Array.from(Array(n),function(){return null})}}),i=function(e){return e.join("|")},o=function(e){return e.members.map(function(e){return e.name})},l=new Map,u=new Map;return t.forEach(function(e,t){l.set(i(e.path),t)}),r.forEach(function(e,t){u.set(i(e.path),t)}),e.forEach(function(e){var t=l.get(i(o(e.columnTuple))),n=u.get(i(o(e.rowTuple)));void 0!==t&&void 0!==n&&(s[n].cells[t]||(s[n].row=r[n].path,s[n].cells[t]=e))}),s},te=function(e,t,r,n){var a,s,i,o=Array(n);for(a=0;a<n;a++)for(s=0;s<r;s++)e[s]&&e[s].cells[a]&&(i=e[s].cells[a],o[a]||(o[a]={cells:Array(r).fill(null)}),o[a].cells[s]=F(F({},i),{rowSpan:i.colSpan,colSpan:i.rowSpan}));return[o,t,n,r]},re=function(e){var t,r,n,a,s=$(e),i=s[0],o=s[1],l=s[2],u=s[3];for(t=0;t<u;t++)for(r=null,n=0;n<l;n++)i[n]&&(a=i[n].cells[t],!a&&r&&(r.rowSpan=(r.rowSpan||1)+1),r&&(r.colSpan=r.breadth||1),a&&(r=a));return[i,o,l,u]},ne=function(e){var t,r,n,a,s=$(e),i=s[0],o=s[1],l=s[2],u=s[3];for(t=0;t<u;t++)for(r=null,n=0;n<l;n++)i[n]&&(a=i[n].cells[t],!a&&r&&(r.rowSpan=(r.rowSpan||1)+1),r&&(r.colSpan=r.breadth),a&&(r=a));return te(i,o,l,u)},ae=function(e,t,r){return{hierarchyUniqueName:e,uniqueName:t,caption:t,measure:t,name:t,type:r,kpi:!0}},se=function(e){for(var t,r=0;r<e.length;r++)if(2===e[r].type){t=!0;break}t&&e.splice(r+1,0,{caption:"KPIs",defaultHierarchy:"[KPIs]",name:"KPIs",uniqueName:"[KPIs]"})},ie=function(e,t){return e.name+""==[t.defaultHierarchy?t.defaultHierarchy:t.uniqueName]+""},oe=function(e,t){return e.name+""==t.name+""};return e.HEADERS_ACTION=void 0,function(e){e.toggle="HEADERS_ACTION_TOGGLE",e.expand="HEADERS_ACTION_EXPAND",e.collapse="HEADERS_ACTION_COLLAPSE"}(e.HEADERS_ACTION||(e.HEADERS_ACTION={})),P=function(e,t,r){var n=new Set;return e.children.forEach(function(e){var a=t(e);r&&n.add(e.path+""),P(e,t,r||a).map(function(e){n.add(e)})}),Array.from(n.values())},k=function(t,r){var n,a,s,i;switch(r.type){case e.HEADERS_ACTION.toggle:return n=t.find(function(e){return e.name+""==r.payload+""}),k(t,F(F({},r),{type:n&&n.expand?e.HEADERS_ACTION.collapse:e.HEADERS_ACTION.expand}));case e.HEADERS_ACTION.expand:return a=t.find(function(e){return e.name+""==r.payload+""}),a&&a.expand===!0?t:!a||a.expand!==!1&&void 0!==a.expand?_(t,[{name:r.payload,expand:!0}]):t.map(function(e){return e===a?F(F({},a),{expand:!0}):e});case e.HEADERS_ACTION.collapse:return s=P(r.tree,function(e){return!e.total&&e.path+""==r.payload+""}),i=_(t).filter(function(e){return!s.some(function(t){return t===e.name+""})}).map(function(e){return F(F({},e),{expand:!!e.expand})}).map(function(e){return e.name+""==r.payload+""?r.payload.length>1?void 0:{name:r.payload,expand:!1}:e}).filter(Boolean);default:return t}},e.PIVOT_CONFIGURATOR_ACTION=void 0,function(e){e.toggleSelection="PIVOT_CONFIGURATOR_ACTION_TOGGLE_SELECTION",e.addColumnAxis="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXIS",e.addColumnAxes="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXES",e.removeColumnAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXIS",e.removeColumnAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXES",e.addRowAxis="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXIS",e.addRowAxes="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXES",e.removeRowAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXIS",e.removeRowAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXES",e.addMeasureAxis="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXIS",e.addMeasureAxes="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXES",e.removeMeasureAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXIS",e.removeMeasureAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXES",e.remove="PIVOT_CONFIGURATOR_ACTION_REMOVE",e.setSort="PIVOT_CONFIGURATOR_ACTION_SET_SORT",e.setFilter="PIVOT_CONFIGURATOR_ACTION_SET_FILTER",e.addFilter="PIVOT_CONFIGURATOR_ACTION_ADD_FILTER",e.changeFilter="PIVOT_CONFIGURATOR_ACTION_CHANGE_FILTER",e.removeFilter="PIVOT_CONFIGURATOR_ACTION_REMOVE_FILTER",e.setDragItem="PIVOT_CONFIGURATOR_ACTION_SET_DRAGITEM",e.drop="PIVOT_CONFIGURATOR_ACTION_DROP",e.setDropZone="PIVOT_CONFIGURATOR_ACTION_SET_DROP_ZONE",e.setDropTarget="PIVOT_CONFIGURATOR_ACTION_SET_DROP_TARGET",e.setDropDirection="PIVOT_CONFIGURATOR_ACTION_SET_DROP_DIRECTION"}(e.PIVOT_CONFIGURATOR_ACTION||(e.PIVOT_CONFIGURATOR_ACTION={})),H=function(t,r){var n,a,s,i,o,l,u,c,h,d,p,m,f,g,v,x,A;switch(r.type){case e.PIVOT_CONFIGURATOR_ACTION.toggleSelection:if(!Array.isArray(r.payload))return d=r.payload,2===d.type||"aggregator"in d?t.measureAxes.some(function(e){return ie(e,d)})?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis})):H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis})):"kpi"===d.type?(p=D(d),p.every(function(e){return t.measureAxes.some(function(t){return ie(t,e)})})?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes,payload:p})):H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.addMeasureAxes,payload:p.filter(function(e){return!t.measureAxes.some(function(t){return ie(t,e)})})}))):r.payload.kpi?t.measureAxes.some(function(e){return ie(e,d)})?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis})):H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis})):t.columnAxes.some(function(e){return ie(e,d)})?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.removeColumnAxis})):t.rowAxes.some(function(e){return ie(e,d)})?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.removeRowAxis})):!t.columnAxes||!t.columnAxes.length||t.rowAxes&&t.rowAxes.length?H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.addColumnAxis})):H(t,F(F({},r),{type:e.PIVOT_CONFIGURATOR_ACTION.addRowAxis}));break;case e.PIVOT_CONFIGURATOR_ACTION.addColumnAxis:a=_(t.columnAxes||[],[{name:[r.payload.defaultHierarchy||r.payload.uniqueName]}]);break;case e.PIVOT_CONFIGURATOR_ACTION.addColumnAxes:break;case e.PIVOT_CONFIGURATOR_ACTION.removeColumnAxis:a=_((t.columnAxes||[]).filter(function(e){return!ie(e,r.payload)}));break;case e.PIVOT_CONFIGURATOR_ACTION.removeColumnAxes:break;case e.PIVOT_CONFIGURATOR_ACTION.addRowAxis:n=_(t.rowAxes||[],[{name:[r.payload.defaultHierarchy||r.payload.uniqueName]}]);break;case e.PIVOT_CONFIGURATOR_ACTION.addRowAxes:break;case e.PIVOT_CONFIGURATOR_ACTION.removeRowAxis:n=_((t.rowAxes||[]).filter(function(e){return!ie(e,r.payload)}));break;case e.PIVOT_CONFIGURATOR_ACTION.removeRowAxes:break;case e.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis:s=_(t.measureAxes||[],[{name:[r.payload.defaultHierarchy||r.payload.uniqueName]}]);break;case e.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis:s=_((t.measureAxes||[]).filter(function(e){return!ie(e,r.payload)}));break;case e.PIVOT_CONFIGURATOR_ACTION.addMeasureAxes:s=_(t.measureAxes||[],(r.payload||[]).map(function(e){return{name:[e.defaultHierarchy||e.uniqueName]}}));break;case e.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes:s=_((t.measureAxes||[]).filter(function(e){return!r.payload.some(function(t){return ie(e,t)})}));break;case e.PIVOT_CONFIGURATOR_ACTION.remove:t.columnAxes.some(function(e){return oe(e,r.payload)})&&(a=_(t.columnAxes.filter(function(e){return!oe(e,r.payload)}))),t.rowAxes.some(function(e){return oe(e,r.payload)})&&(n=_(t.rowAxes.filter(function(e){return!oe(e,r.payload)}))),t.measureAxes.some(function(e){return oe(e,r.payload)})&&(s=_(t.measureAxes.filter(function(e){return!oe(e,r.payload)})));break;case e.PIVOT_CONFIGURATOR_ACTION.setDragItem:l=r.payload;break;case e.PIVOT_CONFIGURATOR_ACTION.setDropZone:u=r.payload;break;case e.PIVOT_CONFIGURATOR_ACTION.setDropTarget:h=r.payload;break;case e.PIVOT_CONFIGURATOR_ACTION.setDropDirection:c=r.payload;break;case e.PIVOT_CONFIGURATOR_ACTION.drop:if(t.dragItem&&t.dropZone)switch(m=t.columnAxes.find(function(e){return oe(e,r.payload)}),f=t.rowAxes.find(function(e){return oe(e,r.payload)}),g=t.measureAxes.find(function(e){return oe(e,r.payload)}),v=void 0,m&&(v=m,a=_(t.columnAxes.filter(function(e){return!oe(e,r.payload)}))),f&&(v=f,n=_(t.rowAxes.filter(function(e){return!oe(e,r.payload)}))),g&&(v=g,s=_(t.measureAxes.filter(function(e){return!oe(e,r.payload)}))),t.dropZone){case"columnAxes":a=a||t.columnAxes.slice(),x=-1,t.dropTarget&&t.dropDirection&&(A=t.dropDirection?"before"===t.dropDirection?0:1:0,x=a.findIndex(function(e){return oe(e,t.dropTarget)})+A),x>=0?a.splice(x,0,v):a.push(v);break;case"rowAxes":n=n||t.rowAxes.slice(),x=-1,t.dropTarget&&t.dropDirection&&(A=t.dropDirection?"before"===t.dropDirection?0:1:0,x=n.findIndex(function(e){return oe(e,t.dropTarget)})+A),x>=0?n.splice(x,0,v):n.push(v);break;case"measureAxes":s=s||t.measureAxes.slice(),x=-1,t.dropTarget&&t.dropDirection&&(A=t.dropDirection?"before"===t.dropDirection?0:1:0,x=s.findIndex(function(e){return oe(e,t.dropTarget)})+A),x>=0?s.splice(x,0,v):s.push(v)}l=null,u=null,h=null;break;case e.PIVOT_CONFIGURATOR_ACTION.setSort:i=r.payload;break;case e.PIVOT_CONFIGURATOR_ACTION.setFilter:o=Array.isArray(r.payload)?r.payload:[r.payload];break;case e.PIVOT_CONFIGURATOR_ACTION.addFilter:o=(t.filter||[]).slice(),Array.isArray(r.payload)?o.push.apply(o,r.payload):o.push(r.payload);break;case e.PIVOT_CONFIGURATOR_ACTION.changeFilter:o=(t.filter||[]).map(Array.isArray(r.payload)?function(e){return r.payload.some(function(t){return t.field===e.field})?r.payload.find(function(t){return t.field===e.field}):e}:function(e){return e.field===r.payload.field?r.payload:e});break;case e.PIVOT_CONFIGURATOR_ACTION.removeFilter:o=(t.filter||[]).slice(),o=o.filter(Array.isArray(r.payload)?function(e){return!r.payload.some(function(t){return t.field===e.field&&t.operator===e.operator})}:function(e){return!(e.field===r.payload.field&&e.operator===r.payload.operator)})}return{dragItem:l,dropTarget:h,dropDirection:c,dropZone:u,columnAxes:a,rowAxes:n,measureAxes:s,filter:o,sort:i}},e.addKPI=se,e.buildKPIMeasures=D,e.compareAxes=oe,e.configuratorReducer=H,e.createAxisDescriptors=y,e.createDataState=W,e.createDiscoverBody=N,e.createRequestBody=m,e.discoverCommands=G,e.fetchData=V,e.fetchDiscover=q,e.headersReducer=k,e.parseResponse=v,e.setFilter=Y,e.setSort=z,e.toColumns=re,e.toData=ee,e.toRows=ne,e.toTree=Z,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}()},"function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(e,define){define("kendo.pivotgrid.min",["pivotgrid/common.min","kendo.dom.min","kendo.data.min"],e)}(function(){return function(e,t){function r(e){var r="string"==typeof e?[{name:e}]:e,n="[object Array]"===He.call(r)?r:r!==t?[r]:[];return Le(n,function(e){return"string"==typeof e?{name:e}:{name:e.name,type:e.type}})}function n(e){var r="string"==typeof e?[{name:[e],expand:!1}]:e,n="[object Array]"===He.call(r)?r:r!==t?[r]:[];return Le(n,function(e){return"string"==typeof e?{name:[e],expand:!1}:{name:"[object Array]"===He.call(e.name)?e.name.slice():[e.name],expand:e.expand}})}function a(e){return e.indexOf(" ")!==-1&&(e='["'+e+'"]'),e}function s(e,t,r,n){var a,i,o,l;if(r||(r=t),n||(n=0),l=r.members[n],l&&!l.measure){if(o=l.children,i=o.length,r===t?e[Te.stringify([l.name])]=!!i:i&&(e[Te.stringify(ge(r,n))]=!0),i)for(a=0;a<i;a++)s(e,t,o[a],n);s(e,t,r,n+1)}}function i(e){var t,r,n={};e.length&&s(n,e[0]),t=[];for(r in n)t.push({name:JSON.parse(r),expand:n[r]});return t}function o(e,t){var r,n,a,s,i=t.tuples||[],o=i[0];if(o&&e.length<o.members.length)for(r=o.members,n=0;n<r.length;n++)if(!r[n].measure){for(a=!1,s=0;s<e.length;s++)if(0===q(e[s]).indexOf(r[n].hierarchy)){a=!0;break}a||e.push({name:[r[n].name],expand:!1})}}function l(e){var t,r=[],n=e.members;for(t=0;t<n.length;t++)n[t].measure||r.push({name:[n[t].name],expand:n[t].children.length>0});return r}function u(e,t,r){var a,s;return e=e||{},o(t,e),r.length>1&&t.push({name:tt,measure:!0,children:n(r)}),a={members:t},e.tuples&&(s=S(e.tuples,a),s.tuple&&(t=l(s.tuple))),t}function c(e){var t=Te.getter(e.field,!0);return function(r,n){return e.aggregate(t(r.dataItem),n,r)}}function h(e){return"number"==typeof e&&!isNaN(e)}function d(e){return e&&e.getTime}function p(){var e,t=0;return document&&document.createElement&&(e=document.createElement("div"),e.style.cssText="overflow:scroll;overflow-x:hidden;zoom:1;clear:both;display:block",e.innerHTML="&nbsp;",document.body.appendChild(e),t=e.offsetWidth-e.scrollWidth,document.body.removeChild(e)),t}function m(e){var t,r=[];for(t=0;t<e.length;t++)r.push(e[t]),e[t].children&&(r=r.concat(m(e[t].children)));return r}function f(e,t,r){for(var n=0;n<t.length;n++)t[n].children&&t[n].children.length&&f(e,t[n].children,r);t[0].parentName==e&&(t=t.sort(r))}function g(t,r){var n,a,s;for(n=0;n<t.length;n++)if(a=r[t[n].name],!e.isEmptyObject(a.childrenMap)){t[n].children=[];for(s in a.childrenMap)t[n].children.push(e.extend({},{name:s,parentName:r[s].parentName}));g(t[n].children,r)}}function _(e){return e[e.length]={value:"",fmtValue:"",ordinal:e.length},e}function v(e,t,r){if(e.tuples.length<I(t.tuples,r))return t}function x(e,t,r,n,a){var s,i,o,l=e.length,u=I(t,n),c=n.length||1;for(i=0;i<r;i++)for(s=0;s<l;s++)o=N(e[s],t)*c,o+=s%c,a[i*l+s].ordinal=i*u+o}function A(e,t,r,n,a){var s,i,o,l=e.length,u=n.length||1;for(i=0;i<l;i++)for(o=N(e[i],t),o*=u,o+=i%u,s=0;s<r;s++)a[i*r+s].ordinal=o*r+s}function N(e,t){return S(t,e).index}function I(e,t){var r,n,a;if(!e.length)return 0;for(r=e.slice(),n=r.shift(),a=1;n;)n.members?[].push.apply(r,n.members):n.children&&(n.measure||(a+=n.children.length),[].push.apply(r,n.children)),n=r.shift();return t.length&&(a*=t.length),a}function w(e){return e||(e={tuples:[]}),e.tuples||(e.tuples=[]),e}function T(e,t,r){var n,a,s,i;if(!e)return 0;for(n=Math.max(r.length,1),a=e.members.slice(0,t),s=a.shift(),i=n;s;)s.name===tt?i+=n-1:s.children?[].push.apply(a,s.children):(i++,[].push.apply(a,s.members)),s=a.shift();return i}function E(e,t,r){var n,a,s,i,o,l;if(!t[0])return{parsedRoot:null,tuples:e,memberIndex:0,index:0};if(n=S(e,t[0]),!n.tuple)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};if(a=n.tuple.members,s=t[0].members,i=-1,a.length!==s.length)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};for(o=0,l=a.length;o<l;o++)!a[o].measure&&s[o].children[0]&&(i==-1&&s[o].children.length&&(i=o),a[o].children=s[o].children);return r=Math.max(r.length,1),{parsedRoot:n.tuple,index:n.index*r,memberIndex:i,tuples:e}}function b(e,t){var r,n,a=!0;for(e=e.members,t=t.members,r=0,n=e.length;r<n;r++)e[r].measure||t[r].measure||(a=a&&q(e[r])===q(t[r]));return a}function S(e,t){var r,n,a,s,i,o,l,u=0;for(r=0,n=e.length;r<n;r++){if(a=e[r],b(a,t))return{tuple:a,index:u};for(u++,i=0,o=a.members.length;i<o;i++)if(l=a.members[i],!l.measure&&(s=S(l.children,t),u+=s.index,s.tuple))return{tuple:s.tuple,index:u}}return{index:u}}function O(e,t){var r,n,a,s="";for(n=0,a=e.length;n<a;n++)r=e[n],s+=r.name,t[s]||(t[s]=r)}function C(e,t){var r,n,a,s,i=e.members,o="",l="";for(r=0,n=i.length;r<n;r++){if(a=i[r],s){if(t[o+a.name]){o+=a.name,s=t[o];continue}return t[o+a.parentName]?t[o+a.parentName]:t[l+a.parentName]?t[l+a.parentName]:t[l]}if(o+=a.name,s=t[a.parentName],!s&&(s=t[o],!s))return null;s&&(l+=s.name)}return s}function R(e,t){var r,n,a,s;if(0===t.length)return-1;for(r=t[0],n=e.members,a=0,s=n.length;a<s;a++)if(n[a].name==r.name)return a}function y(r,n){if(!(n<0)){var a={name:tt,measure:!0,children:[e.extend({members:[],dataIndex:r.dataIndex},r.members[n])]};r.members.splice(n,1,a),r.dataIndex=t}}function M(e,t){var r,n,a,s,i,o;if(e.length<1)return[];for(r=[],n={},a=R(e[0],t),s=0;s<e.length;s++)i=e[s],i.dataIndex=s,y(i,a),o=C(i,n),o?o.children.push(a<0||!o.measure?i:i.members[a].children[0]):r.push(i),O(i.members,n);return r}function D(e,t){var r,n,a,s,i,o,l,u,c;if(!e||!e.length)return t;for(r=[],n=k(e),a=n.length,s=Math.max(t.length/a,1),i=0;i<a;i++)for(l=s*i,u=s*n[i],o=0;o<s;o++)c=parseInt(u+o,10),r[parseInt(l+o,10)]=t[c]||{value:"",fmtValue:"",ordinal:c};return r}function P(e,t){var r,n,a,s,i,o,l,u;if(!e||!e.length)return t;for(r=[],n=k(e),a=n.length,s=Math.max(t.length/a,1),o=0;o<s;o++)for(l=a*o,i=0;i<a;i++)u=n[i]+l,r[l+i]=t[u]||{value:"",fmtValue:"",ordinal:u};return r}function k(e){var r,n,a,s,i,o,l;for(e=e.slice(),r=[],n=e.shift();n;){for(n.dataIndex!==t&&r.push(n.dataIndex),i=0,a=0,s=n.members.length;a<s;a++)l=n.members[a],o=l.children,l.measure?[].splice.apply(e,[0,0].concat(o)):[].splice.apply(e,[i,0].concat(o)),i+=o.length;n=e.shift()}return r}function H(e){var t=e.split(".");return t.length>2?t[0]+"."+t[1]:e}function U(e,t){var r=e.length-1,n=e[r],a=L(t,n);return a&&a.dir?n="ORDER("+n+".Children,"+a.field+".CurrentMember.MEMBER_CAPTION,"+a.dir+")":n+=".Children",e[r]=n,e}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(0===t.indexOf(e[r].field))return e[r];return null;
}function F(e){var t,r="CROSSJOIN({";return e.length>2?(t=e.pop(),r+=F(e)):(r+=e.shift(),t=e.pop()),r+="},{",r+=t,r+="})"}function G(e,t){var r=e.slice(0);return t.length>1&&r.push("{"+B(t).join(",")+"}"),F(r)}function B(e){for(var r,n=0,a=e.length,s=[];n<a;n++)r=e[n],s.push(r.name!==t?r.name:r);return s}function V(e,t){var r,n,a=-1;for(r=0,n=t.length;r<n;r++)if(q(t[r])===e){a=r;break}return a}function q(e){return e=e.name||e,"[object Array]"===He.call(e)&&(e=e[e.length-1]),e}function W(e){for(var t=e.length,r=[],n=0;n<t;n++)r.push(e[n].name[0]);return r}function z(e,t){var r,n,a,s=0,i=e.length,o=t.length;for(t=t.slice(0);s<i;s++)for(r=e[s],a=0;a<o;a++)if(n=H(t[a]),r.indexOf(n)!==-1){t[a]=r;break}return{names:t,expandedIdx:a,uniquePath:t.slice(0,a+1).join("")}}function Y(e){for(var t,r,n,a,s,i,o=[],l=[],u=[],c=0,h=e.length;c<h;c++)if(t=e[c],a=t.name,i=!1,"[object Array]"!==He.call(a)&&(t.name=a=[a]),a.length>1)l.push(t);else{for(s=H(a[0]),r=0,n=u.length;r<n;r++)if(0===u[r].name[0].indexOf(s)){i=!0;break}i||u.push(t),t.expand&&o.push(t)}return o=o.concat(l),{root:u,expanded:o}}function j(e,t,r){var n,a,s,i,o,l,u,c,h="";if(e=e||[],n=Y(e),a=n.root,s=W(a),i=[],n=n.expanded,o=n.length,l=0,c=[],s.length>1||t.length>1){for(i.push(G(s,t));l<o;l++)u=U(n[l].name,r),c=z(u,s).names,i.push(G(c,t));h+=i.join(",")}else{for(;l<o;l++)u=U(n[l].name,r),c.push(u[0]);h+=s.concat(c).join(",")}return h}function K(e){var t="",r=e.value,n=e.field,a=e.operator;return"in"==a?(t+="{",t+=r,t+="}"):(t+="neq"==a||"doesnotcontain"==a?"-":"",t+="Filter(",t+=n+".MEMBERS",t+=Te.format(Z[a],n,r),t+=")"),t}function Q(e,t){var r,n,a="",s=e.filters,i=s.length;for(n=i-1;n>=0;n--)r="SELECT (",r+=K(s[n]),r+=") ON 0",n==i-1?(r+=" FROM ["+t+"]",a=r):a=r+" FROM ( "+a+" )";return a}function X(e,t,r){var n,a,s="";if(t){s+="<"+e+">";for(a in t)n=t[a],r&&(a=a.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),s+="<"+a+">"+n+"</"+a+">";s+="</"+e+">"}else s+="<"+e+"/>";return s}function $(e){if(null==e)return[];var t=He.call(e);return"[object Array]"!==t?[e]:e}function J(e){var t,r,n,a,s={tuples:[]},i=$(Te.getter("Tuples.Tuple",!0)(e)),o=Te.getter("Caption['#text']"),l=Te.getter("UName['#text']"),u=Te.getter("LName['#text']"),c=Te.getter("LNum['#text']"),h=Te.getter("CHILDREN_CARDINALITY['#text']",!0),d=Te.getter("['@Hierarchy']"),p=Te.getter("PARENT_UNIQUE_NAME['#text']",!0);for(t=0;t<i.length;t++){for(r=[],n=$(i[t].Member),a=0;a<n.length;a++)r.push({children:[],caption:o(n[a]),name:l(n[a]),levelName:u(n[a]),levelNum:c(n[a]),hasChildren:parseInt(h(n[a]),10)>0,parentName:p(n[a]),hierarchy:d(n[a])});s.tuples.push({members:r})}return s}var Z,ee,te,re,ne,ae,se,ie,oe,le,ue,ce,he,de,pe,me,fe,ge,_e,ve,xe,Ae,Ne,Ie,we,Te=window.kendo,Ee=Te.ui,be=Te.Class,Se=Te.data.Comparer,Oe=Ee.Widget,Ce=Te.data.DataSource,Re=Te._outerWidth,ye=Te._outerHeight,Me=window.kendo.pivotgrid.common,De=Me.fetchDiscover,Pe=Te.data.Query.normalizeFilter,ke=Te.data.Query.normalizeSort,He={}.toString,Ue=function(e){return e},Le=e.map,Fe=e.extend,Ge=Te.isFunction,Be=Me.fetchData,Ve=Me.createDataState,qe=Me.toColumns,We=Me.toRows,ze=Me.toTree,Ye=Me.toData,je=Me.headersReducer,Ke="resize",Qe="read",Xe="change",$e="error",Je="requestStart",Ze="progress",et="requestEnd",tt="Measures",rt="stateReset",nt="auto",at="<div></div>",st=".kendoPivotGrid",it="__row_total__",ot="dataBinding",lt="dataBound",ut="expandMember",ct='<th data-key="#:key#" class="#:headerClass#" #if (colspan) {#colspan="#:colspan#"#}# #if (rowspan) {#rowspan="#:rowspan#"#}#>#if (expandable) {# <span class="k-icon k-i-arrow-chevron-#:iconClass# k-color-inherit" role="presentation"></span>#}#</th>',ht="collapseMember",dt="k-i-collapse",pt="k-i-expand",mt="<span>#: data.member.caption || data.member.name #</span>",ft='<span class="k-icon k-i-kpi-status-#=data.dataItem.value > 0 ? "open" : data.dataItem.value < 0 ? "deny" : "hold"#" title="#:data.dataItem.value#"></span>',gt='<span class="k-icon k-i-kpi-trend-#=data.dataItem.value > 0 ? "increase" : data.dataItem.value < 0 ? "decrease" : "equal"#" title="#:data.dataItem.value#"></span>',_t='#= data.dataItem ? kendo.htmlEncode(data.dataItem.fmtValue || data.dataItem.value) || "&nbsp;" : "&nbsp;" #',vt='<table class="k-pivot-layout"><tr><td><div class="k-pivot-rowheaders"></div></td><td><div class="k-pivot-table"></div></td></tr></table>',xt="rows",At="columns",Nt={sum:function(e,t){var r=t.accumulator;return h(r)?h(e)&&(r+=e):r=e,r},count:function(e,t){return(t.accumulator||0)+1},average:{aggregate:function(e,r){var n=r.accumulator;return r.count===t&&(r.count=0),h(n)?h(e)&&(n+=e):n=e,h(e)&&r.count++,n},result:function(e){var t=e.accumulator;return h(t)&&(t/=e.count),t}},max:function(e,t){var r=t.accumulator;return h(r)||d(r)||(r=e),r<e&&(h(e)||d(e))&&(r=e),r},min:function(e,t){var r=t.accumulator;return h(r)||d(r)||(r=e),r>e&&(h(e)||d(e))&&(r=e),r}},It=be.extend({init:function(e){this.options=Fe({},this.options,e),this.dimensions=this._normalizeDescriptors("field",this.options.dimensions),this.measures=this._normalizeDescriptors("name",this.options.measures)},_normalizeDescriptors:function(e,t){var r,n,a,s;if(t=t||{},r={},"[object Array]"===He.call(t)){for(a=0,s=t.length;a<s;a++)n=t[a],"string"==typeof n?r[n]={}:n[e]&&(r[n[e]]=n);t=r}return t},_rootTuples:function(e,r){var n,a,s,i,o=r.length||1,l=this.dimensions||[],u=0,c=e.length,h=[],d=[];if(c||r.length){for(u=0;u<o;u++){for(n={members:[]},i=0;i<c;i++)a=e[i],s=a.split("&"),n.members[n.members.length]={children:[],caption:(l[a]||{}).caption||"All",name:a,levelName:a,levelNum:"0",hasChildren:!0,parentName:s.length>1?s[0]:t,hierarchy:a};o>1&&(n.members[n.members.length]={children:[],caption:r[u].caption,name:r[u].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:!1,parentName:t,hierarchy:"MEASURES"}),h[h.length]=n}d.push(it)}return{keys:d,tuples:h}},_sortMap:function(t,r){var n,a,s,i,o=[],l=[],u=[];for(a in t)t[a].directParentName||l.push(e.extend({},{name:a,parentName:t[a].parentName}));if(!l.length)for(a in t)l.push(e.extend({},{name:a,parentName:t[a].parentName}));for(g(l,t),s=0;s<r.length;s++)f(r[s].field.split(".").pop(),l,Se.create({field:"name",dir:r[s].dir}));for(u=m(l),i=0;i<u.length;i++)n=t[u[i].name],n.index=i,o[i]=n;return o},_expandedTuples:function(r,n,a,s){var i,o,l,u,c,h,d,p,m,f,g,_=a.length||1,v=this.dimensions||[],x=[],A=[];s&&s.length&&!e.isEmptyObject(r)&&(r=this._sortMap(r,s));for(l in r){for(u=r[l],d=this._findExpandedMember(n,u.uniquePath),c=x[d.index]||[],h=A[d.index]||[],p=d.member.names,i=0;i<_;i++){for(o={members:[]},g=0;g<p.length;g++)g===d.member.expandedIdx?(o.members[o.members.length]={children:[],caption:u.value,name:u.name,hasChildren:!1,levelNum:1,levelName:u.parentName+u.name,parentName:u.parentName,hierarchy:u.parentName+u.name},0===i&&h.push(ge(o,g).join(""))):(f=p[g],m=f.split("&"),o.members[o.members.length]={children:[],caption:(v[f]||{}).caption||"All",name:f,levelName:f,levelNum:"0",hasChildren:!0,parentName:m.length>1?m[0]:t,hierarchy:f});_>1&&(o.members[o.members.length]={children:[],caption:a[i].caption,name:a[i].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:!0,parentName:t,hierarchy:"MEASURES"}),c[c.length]=o}x[d.index]=c,A[d.index]=h}return{keys:A,tuples:x}},_findExpandedMember:function(e,t){for(var r=0;r<e.length;r++)if(e[r].uniquePath===t)return{member:e[r],index:r}},_asTuples:function(e,t,r,n){var a,s;return r=r||[],a=this._rootTuples(t.root,r),s=this._expandedTuples(e,t.expanded,r,n),{keys:[].concat.apply(a.keys,s.keys),tuples:[].concat.apply(a.tuples,s.tuples)}},_measuresInfo:function(e,t){for(var r,n,a=0,s=e&&e.length,i=[],o={},l={},u=this.measures||{};a<s;a++)n=e[a].descriptor.name,r=u[n]||{},i.push(n),r.result&&(o[n]=r.result),r.format&&(l[n]=r.format);return{names:i,formats:l,resultFuncs:o,rowAxis:t}},_toDataArray:function(e,t,r,n){var a,s,i,o,l,u,c,h,d,p,m=[],f=1,g=[],_=r.length||1,v=n.length||1;for(t.rowAxis?(g=t.names,f=g.length):p=t.names,i=0;i<_;i++)for(c=e[r[i]||it],u=0;u<f;u++)for(t.rowAxis&&(p=[g[u]]),o=0;o<v;o++)for(d=n[o]||it,h=c.items[d],a=d===it?c.aggregates:h?h.aggregates:{},l=0;l<p.length;l++)s=p[l],this._addData(m,a[s],t.formats[s],t.resultFuncs[s]);return m},_addData:function(e,t,r,n){var a,s="";t&&(t=n?n(t):t.accumulator,s=r?Te.format(r,t):t),a=e.length,e[a]={ordinal:a,value:t||"",fmtValue:s}},_matchDescriptors:function(e,r,n){for(var a,s,i,o,l=r.names,u=r.expandedIdx;u>0;)if(a=l[--u].split("&"),a.length>1&&(s=a[0],i=a[1],o=n[s](e),o=o!==t&&null!==o?""+o:o,o!=i))return!1;return!0},_calculateAggregate:function(e,t,r){var n,a,s,i={};for(s=0;s<e.length;s++)a=e[s].descriptor.name,n=r.aggregates[a]||{},n.accumulator=e[s].aggregator(t,n),i[a]=n;return i},_processColumns:function(e,r,n,a,s,i,o,l){for(var u,c,h,d,p,m,f,g,_=s.dataItem,v=0;v<r.length;v++)c=r[v],this._matchDescriptors(_,c,n)&&(g=c.names.slice(0,c.expandedIdx).join(""),m=c.names[c.expandedIdx],u=n[m](_),u=u!==t&&null!==u?""+u:u,f=m,m=m+"&"+u,p=g+m,h=a[p]||{index:o.columnIndex,parentName:f,name:m,directParentName:g.indexOf("&")!==-1?g:"",uniquePath:g+f,childrenMap:{},value:u},g&&a[g]&&!a[g].childrenMap[g+f+"&"+u]&&(a[g].childrenMap[g+f+"&"+u]=!0),d=i.items[p]||{aggregates:{}},i.items[p]={index:h.index,aggregates:this._calculateAggregate(e,s,d)},l&&(a[p]||o.columnIndex++,a[p]=h))},_measureAggregators:function(e){var t,r,n,a,s,i,o=e.measures||[],l=this.measures||{},u=[];if(o.length){for(n=0,a=o.length;n<a;n++)if(t=o[n],r=l[t.name],s=null,r){if(i=r.aggregate,"string"==typeof i){if(s=Nt[i.toLowerCase()],!s)throw Error("There is no such aggregate function");r.aggregate=s.aggregate||s,r.result=s.result}u.push({descriptor:t,caption:r.caption,result:r.result,aggregator:c(r)})}}else u.push({descriptor:{name:"default"},caption:"default",aggregator:function(){return 1}});return u},_buildGetters:function(e){var t,r,n,s={};for(n=0;n<e.length;n++)r=e[n],t=r.split("&"),t.length>1?s[t[0]]=Te.getter(t[0],!0):s[r]=Te.getter(a(r),!0);return s},_parseDescriptors:function(e){var t,r=Y(e),n=W(r.root),a=r.expanded,s=[];for(t=0;t<a.length;t++)s.push(z(a[t].name,n));return{root:n,expanded:s}},_filter:function(e,t){var r,n,a;if(!t)return e;for(n=0,a=t.filters;n<a.length;n++)r=a[n],"in"===r.operator&&(a[n]=this._normalizeFilter(r));return new Te.data.Query(e).filter(t).data},_normalizeFilter:function(e){var t,r=e.value.split(","),n=[];if(!r.length)return r;for(t=0;t<r.length;t++)n.push({field:e.field,operator:"eq",value:r[t]});return{logic:"or",filters:n}},process:function(e,r){var a,s,i,o,l,u,c,h,d,p,m,f,g,_,v,x,A,N,I,w,T,E,b,S,O,C,R,y,M,D;if(e=e||[],r=r||{},e=this._filter(e,r.filter),a=r.measures||[],s="rows"===r.measuresAxis,i=r.columns||[],o=r.rows||[],!i.length&&o.length&&(!a.length||a.length&&s)&&(i=o,o=[],s=!1),i.length||o.length||(s=!1),!i.length&&a.length&&(i=n(r.measures)),i=this._parseDescriptors(i),o=this._parseDescriptors(o),l={},u={},c={},d={columnIndex:0},p=this._measureAggregators(r),m=this._buildGetters(i.root),f=this._buildGetters(o.root),g=!1,_=i.expanded,v=o.expanded,N=0!==v.length,M=e.length,D=0,i.root.length||o.root.length)for(g=!0,D=0;D<M;D++)for(x=e[D],A={dataItem:x,index:D},E=l[it]||{items:{},aggregates:{}},this._processColumns(p,_,m,u,A,E,d,!N),E.aggregates=this._calculateAggregate(p,A,E),l[it]=E,I=0;I<v.length;I++)w=v[I],this._matchDescriptors(x,w,f)?(S=w.names.slice(0,w.expandedIdx).join(""),T=w.names[w.expandedIdx],O=T,h=f[T](x),h=h!==t?""+h:h,T=T+"&"+h,b=S+T,c[b]={uniquePath:S+O,parentName:O,name:T,value:h},C=l[b]||{items:{},aggregates:{}},this._processColumns(p,_,m,u,A,C,d,!0),C.aggregates=this._calculateAggregate(p,A,C),l[b]=C):this._processColumns(p,_,m,u,A,{items:{},aggregates:{}},d,!0);return g&&M?(!(p.length>1)||r.columns&&r.columns.length||(i={root:[],expanded:[]}),R=this._asTuples(u,i,s?[]:p,r.sort?r.sort:[]),y=this._asTuples(c,o,s?p:[],r.sort?r.sort:[]),u=R.tuples,c=y.tuples,l=this._toDataArray(l,this._measuresInfo(p,s),y.keys,R.keys)):l=u=c=[],{axes:{columns:{tuples:u},rows:{tuples:c}},data:l}}}),wt=be.extend({init:function(e,t){this.transport=t,this.options=t.options||{},this.transport.discover||Ge(e.discover)&&(this.discover=e.discover)},read:function(e){return this.transport.read(e)},update:function(e){return this.transport.update(e)},create:function(e){return this.transport.create(e)},destroy:function(e){return this.transport.destroy(e)},discover:function(e){return this.transport.discover?this.transport.discover(e):(e.success({}),t)},catalog:function(r){var n,a=this.options||{};return r===t?(a.connection||{}).catalog:(n=a.connection||{},n.catalog=r,this.options.connection=n,e.extend(this.transport.options,{connection:n}),t)},cube:function(e){var r,n=this.options||{};return e===t?(n.connection||{}).cube:(r=n.connection||{},r.cube=e,this.options.connection=r,Fe(!0,this.transport.options,{connection:r}),t)}}),Tt=Ce.extend({init:function(e){var t,a;Ce.fn.init.call(this,Fe(!0,{},{},e)),t=this.options.transport||{},"xmla"===(this.options.type||"xmla").toLowerCase()&&(this._online=!0,this.transport=new ne(t)),this._columns=n(this.options.columns),this._rows=n(this.options.rows),a=this.options.measures||[],"[object Object]"===He.call(a)&&(this._measuresAxis=a.axis||"columns",a=a.values||[]),this._measures=r(a)},options:{serverSorting:!0,serverPaging:!0,serverFiltering:!0,serverGrouping:!0,serverAggregates:!0},axes:function(){return{columns:w(this.columns()),rows:w(this.rows())}},catalog:function(e){return e===t?this.transport.catalog():(this.transport.catalog(e),this._mergeState({}),this.read(),t)},cube:function(e){return e===t?this.transport.cube():(this.transport.cube(e),this._mergeState({}),this.read(),t)},measuresAxis:function(){return this._measuresAxis||"columns"},fetch:function(){"xmla"!==this.options.type.toLowerCase()||this._data!==t&&0!==this._data.length||this._query()},read:function(e){var t=this,r=t.trigger(Je,{type:Qe}),n=t._params(e);r||(t.trigger(Ze),t.transport.read({data:n,success:function(e){t._saveState(e),t.trigger(et,{response:e,type:Qe}),t.trigger(Xe),t._preventRefresh&&(t._preventRefresh=!1)},error:function(e){t.trigger($e,{error:e})}}))},_params:function(e){var t=this,r=Ce.fn._params.call(t,e);return r=Fe({connection:t.options.transport.connection,columnAxes:JSON.parse(JSON.stringify(t._columns)),rowAxes:JSON.parse(JSON.stringify(t._rows)),measuresAxis:t.measuresAxis(),measureAxes:t._measures},r),r.filter&&(r.filter=Pe(r.filter),r.filter=(r.filter||{}).filters),r.sort&&(r.sort=ke(r.sort)),r},discover:function(e){var t=this,r=t.transport;if(r.discover)return r.discover(e)},schemaMeasures:function(){var e=this;return e.discover({command:"schemaMeasures",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaKPIs:function(){var e=this;return e.discover({command:"schemaKPIs",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaDimensions:function(){var e=this;return e.discover({command:"schemaDimensions",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaHierarchies:function(e){var t=this;return t.discover({command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}},function(e){return e})},schemaLevels:function(e){var t=this;return t.discover({command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}},function(e){return e})},schemaCubes:function(){var e=this;return e.discover({command:"schemaCubes",restrictions:{catalogName:e.transport.catalog()}},function(e){return e})},schemaCatalogs:function(){var e=this;return e.discover({command:"schemaCatalogs"},function(e){return e})},schemaMembers:function(e){var t=this;return t.discover({command:"schemaMembers",restrictions:Fe({catalogName:t.transport.catalog(),cubeName:t.transport.cube()},e)},function(e){return e})},_saveState:function(e){var t=this;t._columnTuples=e.columns,t._rowTuples=e.rows,t._view=e.data},columns:function(e){return e===t?this._columns:(this._columns=n(e),this.read(),t)},rows:function(e){return e===t?this._rows:(this._rows=n(e),this.read(),t)},measures:function(e){return e===t?this._measures:(this._measures=r(e),this.read(),t)},_mergeState:function(e){return e=Ce.fn._mergeState.call(this,e)},_query:function(e){var t=this,r=Fe({},{sort:t.sort(),measuresAxis:t.measuresAxis(),filter:t.filter()},e),n=this._mergeState(r);return this.read(n)}}),Et=Ce.extend({init:function(t){var a,s=((t||{}).schema||{}).cube,i="columns",o={axes:Ue,cubes:Ue,catalogs:Ue,measures:Ue,dimensions:Ue,hierarchies:Ue,levels:Ue,members:Ue};s&&(o=e.extend(o,this._cubeSchema(s)),this.cubeBuilder=new It(s)),Ce.fn.init.call(this,Fe(!0,{},{schema:o},t)),this.transport=new wt(this.options.transport||{},this.transport),this._columns=n(this.options.columns),this._rows=n(this.options.rows),a=this.options.measures||[],"[object Object]"===He.call(a)&&(i=a.axis||"columns",a=a.values||[]),this._measures=r(a),this._measuresAxis=i,this._skipNormalize=0,this._axes={}},_cubeSchema:function(t){return{dimensions:function(){var e,r=[],n=t.dimensions;for(e in n)r.push({name:e,caption:n[e].caption||e,uniqueName:e,defaultHierarchy:e,type:1});return t.measures&&r.push({name:tt,caption:tt,uniqueName:tt,type:2}),r},hierarchies:function(){return[]},measures:function(){var e,r=[],n=t.measures;for(e in n)r.push({name:e,caption:e,uniqueName:e,aggregator:e});return r},members:e.proxy(function(e,r){var n,s,i=r.levelUniqueName||r.memberUniqueName,o=this.options.schema.data,l=Ge(o)?o:Te.getter(o,!0),u=this.options.data&&l(this.options.data)||this._rawData||[],c=[],h=0,d={};if(i&&(i=i.split(".")[0]),!r.treeOp)return c.push({caption:t.dimensions[i].caption||i,childrenCardinality:"1",dimensionUniqueName:i,hierarchyUniqueName:i,levelUniqueName:i,name:i,uniqueName:i}),c;for(n=Te.getter(a(i),!0);h<u.length;h++)s=n(u[h]),!s&&0!==s||d[s]||(d[s]=!0,c.push({caption:s,childrenCardinality:"0",dimensionUniqueName:i,hierarchyUniqueName:i,levelUniqueName:i,name:s,uniqueName:s}));return c},this)}},options:{serverSorting:!0,serverPaging:!0,serverFiltering:!0,serverGrouping:!0,serverAggregates:!0},catalog:function(e){return e===t?this.transport.catalog():(this.transport.catalog(e),this._mergeState({}),this._axes={},this.data([]),t)},cube:function(e){return e===t?this.transport.cube():(this.transport.cube(e),this._axes={},this._mergeState({}),this.data([]),t)},axes:function(){return this._axes},columns:function(e){return e===t?this._columns:(this._skipNormalize+=1,this._clearAxesData=!0,this._columns=n(e),this.query({columns:e,rows:this.rowsAxisDescriptors(),measures:this.measures(),sort:this.sort(),filter:this.filter()}),t)},rows:function(e){return e===t?this._rows:(this._skipNormalize+=1,this._clearAxesData=!0,this._rows=n(e),this.query({columns:this.columnsAxisDescriptors(),rows:e,measures:this.measures(),sort:this.sort(),filter:this.filter()}),t)},measures:function(e){return e===t?this._measures:(this._skipNormalize+=1,this._clearAxesData=!0,this.query({columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:r(e),sort:this.sort(),filter:this.filter()}),t)},measuresAxis:function(){return this._measuresAxis||"columns"},_expandPath:function(e,t){var r,a,s,i="columns"===t?"columns":"rows",o="columns"===t?"rows":"columns",l=n(e),c=q(l[l.length-1]);for(this._lastExpanded=i,l=u(this.axes()[i],l,this.measures()),r=0;r<l.length;r++)if(a=q(l[r]),a===c){if(l[r].expand)return;l[r].expand=!0}else l[r].expand=!1;s={},s[i]=l,s[o]=this._descriptorsForAxis(o),this._query(s)},_descriptorsForAxis:function(e){var t=this.axes(),r=this[e]()||[];return t&&t[e]&&t[e].tuples&&t[e].tuples[0]&&(r=i(t[e].tuples||[])),r},columnsAxisDescriptors:function(){return this._descriptorsForAxis("columns")},rowsAxisDescriptors:function(){return this._descriptorsForAxis("rows")},_process:function(e,t){this._view=e,t=t||{},t.items=t.items||this._view,this.trigger(Xe,t)},_query:function(e){var t=this;return e||(this._skipNormalize+=1,this._clearAxesData=!0),t.query(Fe({},{page:t.page(),pageSize:t.pageSize(),sort:t.sort(),filter:t.filter(),group:t.group(),aggregate:t.aggregate(),columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:this.measures()},e))},query:function(t){var r=this._mergeState(t);return this._data.length&&this.cubeBuilder?(this._params(r),this._updateLocalData(this._pristineData),e.Deferred().resolve().promise()):this.read(r)},_mergeState:function(e){return e=Ce.fn._mergeState.call(this,e),e!==t&&(this._measures=r(e.measures),e.columns?e.columns=n(e.columns):e.columns||(this._columns=[]),e.rows?e.rows=n(e.rows):e.rows||(this._rows=[])),e},filter:function(e){return e===t?this._filter:(this._skipNormalize+=1,this._clearAxesData=!0,this._query({filter:e,page:1}),t)},expandColumn:function(e){this._expandPath(e,"columns")},expandRow:function(e){this._expandPath(e,"rows")},success:function(e){var t;this.cubeBuilder&&(t=(this.reader.data(e)||[]).slice(0)),Ce.fn.success.call(this,e),t&&(this._pristineData=t)},_processResult:function(e,t){var r,n,a,s,i,o,l,u,c,h,d;return this.cubeBuilder&&(r=this.cubeBuilder.process(e,this._requestData),e=r.data,t=r.axes),u=this.columns(),c=this.rows(),h=t.columns&&t.columns.tuples,u.length||!c.length||!h||!this._rowMeasures().length&&this.measures().length||(t={columns:{},rows:t.columns}),u.length||c.length||"rows"!==this.measuresAxis()||!h||(t={columns:{},rows:t.columns}),this._axes={columns:w(this._axes.columns),rows:w(this._axes.rows)},t={columns:w(t.columns),rows:w(t.rows)},n=this._normalizeTuples(t.columns.tuples,this._axes.columns.tuples,u,this._columnMeasures()),a=this._normalizeTuples(t.rows.tuples,this._axes.rows.tuples,c,this._rowMeasures()),this._skipNormalize>0&&(this._skipNormalize-=1),this.cubeBuilder||(e=this._normalizeData({columnsLength:t.columns.tuples.length,rowsLength:t.rows.tuples.length,columnIndexes:n,rowIndexes:a,data:e})),"rows"==this._lastExpanded?(s=t.columns.tuples,o=this._columnMeasures(),i=v(t.columns,this._axes.columns,o),i&&(l="columns",t.columns=i,x(s,i.tuples,t.rows.tuples.length,o,e),this.cubeBuilder||(e=this._normalizeData({columnsLength:I(t.columns.tuples,o),rowsLength:t.rows.tuples.length,data:e})))):"columns"==this._lastExpanded&&(s=t.rows.tuples,o=this._rowMeasures(),i=v(t.rows,this._axes.rows,o),i&&(l="rows",t.rows=i,A(s,i.tuples,t.columns.tuples.length,o,e),this.cubeBuilder||(e=this._normalizeData({columnsLength:I(t.rows.tuples,o),rowsLength:t.columns.tuples.length,data:e})))),this._lastExpanded=null,d=this._mergeAxes(t,e,l),this._axes=d.axes,d.data},_readData:function(e){var t=this.reader.axes(e),r=this.reader.data(e);return this.cubeBuilder&&(this._rawData=r),this._processResult(r,t)},_createTuple:function(e,t,r){var n,a,s,i,o,l,u,c,h=e.members,d=h.length,p={members:[]},m=0;for(t&&(d-=1);m<d;m++)c=h[m],a=+c.levelNum,s=c.name,i=c.parentName,u=c.caption||s,o=c.hasChildren,l=c.hierarchy,n=c.levelName,r&&(u="All",0===a?i=c.name:a-=1,o=!0,s=l=n=i),p.members.push({name:s,children:[],caption:u,levelName:n,levelNum:""+a,hasChildren:o,hierarchy:l,parentName:r?"":i});return t&&p.members.push({name:t.name,children:[]}),p},_hasRoot:function(e,t,r){var n,a,s,i,o,l,u;if(t.length)return S(t,e).tuple;for(n=e.members,i=!0,l=0,u=n.length;l<u;l++)if(a=n[l],o=+a.levelNum||0,s=r[l],!(0===o||s&&a.name===q(s))){i=!1;break}return i},_mergeAxes:function(e,t,r){var n,a,s,i,o,l=this._columnMeasures(),u=this._rowMeasures(),c=this.axes(),h=I(c.rows.tuples,u),d=e.rows.tuples.length,p=I(c.columns.tuples,l),m=e.columns.tuples.length;return"columns"==r?(m=p,a=e.columns.tuples):(a=M(e.columns.tuples,l),t=P(a,t)),s=E(c.columns.tuples,a,l),"rows"==r?(d=I(e.rows.tuples,u),a=e.rows.tuples):(a=M(e.rows.tuples,u),t=D(a,t)),i=E(c.rows.tuples,a,u),c.columns.tuples=s.tuples,c.rows.tuples=i.tuples,p!==I(c.columns.tuples,l)?(n=s.index+T(s.parsedRoot,s.memberIndex,l),o=p+m,t=this._mergeColumnData(t,n,d,m,o)):h!==I(c.rows.tuples,u)&&(n=i.index+T(i.parsedRoot,i.memberIndex,u),t=this._mergeRowData(t,n,d,m)),0===c.columns.tuples.length&&0===c.rows.tuples.length&&(t=[]),{axes:c,data:t}},_mergeColumnData:function(e,t,r,n,a){var s,i,o,l=this.data().toJSON(),u=0,c=Math.max(this._columnMeasures().length,1);for(r=Math.max(r,1),l.length>0&&(u=c,a-=c),s=0;s<r;s++)i=t+s*a,o=e.splice(0,n),o.splice(0,u),[].splice.apply(l,[i,0].concat(o));return l},_mergeRowData:function(e,t,r,n){var a,s,i,o=this.data().toJSON(),l=Math.max(this._rowMeasures().length,1);for(n=Math.max(n,1),o.length>0&&(r-=l,e.splice(0,n*l)),a=0;a<r;a++)i=e.splice(0,n),s=t*n+a*n,[].splice.apply(o,[s,0].concat(i));return o},_columnMeasures:function(){var e=this.measures(),t=[];return"columns"===this.measuresAxis()&&(0===this.columns().length?t=e:e.length>1&&(t=e)),t},_rowMeasures:function(){var e=this.measures(),t=[];return"rows"===this.measuresAxis()&&(0===this.rows().length?t=e:e.length>1&&(t=e)),t},_updateLocalData:function(e,t){this.cubeBuilder&&(t&&(this._requestData=t),e=this._processResult(e)),this._data=this._observe(e),this._ranges=[],this._addRange(this._data),this._total=this._data.length,this._pristineTotal=this._total,this._process(this._data)},data:function(e){var r=this;return e===t?r._data:(this._pristineData=e.slice(0),this._updateLocalData(e,{columns:this.columns(),rows:this.rows(),measures:this.measures()}),t)},_normalizeTuples:function(e,t,r,n){var a,s,i,o=n.length||1,l=0,u=[],c={},h=0;if(e.length){if(this._skipNormalize<=0&&!this._hasRoot(e[0],t,r)){for(this._skipNormalize=0;l<o;l++)u.push(this._createTuple(e[0],n[l],!0)),c[l]=l;e.splice.apply(e,[0,e.length].concat(u).concat(e)),l=o}if(n.length)for(i=a=e[l],s=a.members.length-1;a;){if(h>=o&&(h=0),a.members[s].name!==n[h].name&&(e.splice(l,0,this._createTuple(a,n[h])),c[l]=l),l+=1,h+=1,a=e[l],o>h&&(!a||_e(i,s-1)!==_e(a,s-1))){for(;h<o;h++)e.splice(l,0,this._createTuple(i,n[h])),c[l]=l,l+=1;a=e[l]}i=a}return c}},_addMissingDataItems:function(e,r){for(;r.rowIndexes[parseInt(e.length/r.columnsLength,10)]!==t;)for(var n=0;n<r.columnsLength;n++)e=_(e);for(;r.columnIndexes[e.length%r.columnsLength]!==t;)e=_(e);return e},_normalizeOrdinals:function(e,t,r){var n=r.lastOrdinal;if(!t)return _(e);if(t.ordinal-n>1)for(n+=1;n<t.ordinal&&e.length<r.length;)e=this._addMissingDataItems(_(e),r),n+=1;return t.ordinal=e.length,e[e.length]=t,e},_normalizeData:function(e){var t,r,n,a=e.data,s=0,i=[];if(e.lastOrdinal=0,e.columnIndexes=e.columnIndexes||{},e.rowIndexes=e.rowIndexes||{},e.columnsLength=e.columnsLength||1,e.rowsLength=e.rowsLength||1,e.length=e.columnsLength*e.rowsLength,n=e.length,a.length===n)return a;for(;i.length<n;)t=a[s++],t&&(r=t.ordinal),i=this._normalizeOrdinals(this._addMissingDataItems(i,e),t,e),e.lastOrdinal=r;return i},discover:function(t,r){var n=this,a=n.transport;return e.Deferred(function(e){a.discover(Fe({success:function(t){t=n.reader.parse(t),n._handleCustomErrors(t)||(r&&(t=r(t)),e.resolve(t))},error:function(t,r,a){e.reject(t),n.error(t,r,a)}},t))}).promise().done(function(){n.trigger("schemaChange")})},schemaMeasures:function(){var e=this;return e.discover({data:{command:"schemaMeasures",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.measures(t)})},schemaKPIs:function(){var e=this;return e.discover({data:{command:"schemaKPIs",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.kpis(t)})},schemaDimensions:function(){var e=this;return e.discover({data:{command:"schemaDimensions",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.dimensions(t)})},schemaHierarchies:function(e){var t=this;return t.discover({data:{command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}}},function(e){return t.reader.hierarchies(e)})},schemaLevels:function(e){var t=this;return t.discover({data:{command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}}},function(e){return t.reader.levels(e)})},schemaCubes:function(){var e=this;return e.discover({data:{command:"schemaCubes",restrictions:{catalogName:e.transport.catalog()}}},function(t){return e.reader.cubes(t)})},schemaCatalogs:function(){var e=this;return e.discover({data:{command:"schemaCatalogs"}},function(t){return e.reader.catalogs(t)})},schemaMembers:function(e){var t=this,r=function(e){return function(r){return t.reader.members(r,e)}}(e);return t.discover({data:{command:"schemaMembers",restrictions:Fe({catalogName:t.transport.catalog(),cubeName:t.transport.cube()},e)}},r)},_params:function(e){this._clearAxesData&&(this._axes={},this._data=this._observe([]),this._clearAxesData=!1,this.trigger(rt));var t=Ce.fn._params.call(this,e);return t=Fe({measures:this.measures(),measuresAxis:this.measuresAxis(),columns:this.columns(),rows:this.rows()},t),this.cubeBuilder&&(this._requestData=t),t}});Tt.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},r=t.data;if(t.data=r,!(t instanceof Tt)&&t instanceof Te.data.DataSource)throw Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof Tt?t:new Tt(t)},Et.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},r=t.data;if(t.data=r,!(t instanceof Et)&&t instanceof Te.data.DataSource)throw Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof Et?t:new Et(t)},Z={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}")',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"'},ee={schemaCubes:"MDSCHEMA_CUBES",schemaCatalogs:"DBSCHEMA_CATALOGS",schemaMeasures:"MDSCHEMA_MEASURES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaLevels:"MDSCHEMA_LEVELS",schemaMembers:"MDSCHEMA_MEMBERS",schemaKPIs:"MDSCHEMA_KPIS"},te={read:function(e){var t,r,n,a,s,i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>';return i+="SELECT NON EMPTY {",t=e.columns||[],r=e.rows||[],n=e.measures||[],a="rows"===e.measuresAxis,s=e.sort||[],!t.length&&r.length&&(!n.length||n.length&&a)&&(t=r,r=[],a=!1),t.length||r.length||(a=!1),t.length?i+=j(t,a?[]:n,s):n.length&&!a&&(i+=B(n).join(",")),i+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(r.length||a&&n.length>1)&&(i+=", NON EMPTY {",i+=r.length?j(r,a?n:[],s):B(n).join(","),i+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),e.filter?(i+=" FROM ",i+="(",i+=Q(e.filter,e.connection.cube),i+=")"):i+=" FROM ["+e.connection.cube+"]",1==n.length&&t.length&&(i+=" WHERE ("+B(n).join(",")+")"),i+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>",i.replace(/\&/g,"&amp;")},discover:function(t){t=t||{};var r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';return r+="<RequestType>"+(ee[t.command]||t.command)+"</RequestType>",r+="<Restrictions>"+X("RestrictionList",t.restrictions,!0)+"</Restrictions>",t.connection&&t.connection.catalog&&(t.properties=e.extend({},{Catalog:t.connection.catalog},t.properties)),r+="<Properties>"+X("PropertyList",t.properties)+"</Properties>",r+="</Discover></Body></Envelope>"}},re=Te.data.RemoteTransport.extend({init:function(e){var t=e;e=this.options=Fe(!0,{},this.options,e),Te.data.RemoteTransport.call(this,e),Ge(t.discover)?this.discover=t.discover:"string"==typeof t.discover?this.options.discover={
url:t.discover}:t.discover||(this.options.discover=this.options.read)},setup:function(t,r){return t.data=t.data||{},e.extend(!0,t.data,{connection:this.options.connection}),Te.data.RemoteTransport.fn.setup.call(this,t,r)},options:{read:{dataType:"text",contentType:"text/xml",type:"POST"},discover:{dataType:"text",contentType:"text/xml",type:"POST"},parameterMap:function(e,t){return te[t](e,t)}},discover:function(t){return e.ajax(this.setup(t,"discover"))}}),ne=be.extend({init:function(e){e=this.options=Fe(!0,{},this.options,e)},setup:function(t){return e.extend(!0,t||{},{connection:this.options.connection})},read:function(t){var r=this,n=r.setup(t.data,Qe),a=t.success||e.noop,s=t.error||e.noop;t.parameterMap&&(n=r.parameterMap(n,Qe)),Be({url:r.options.read},n).then(Ve).then(function(e){a(e)})["catch"](function(e){s(e)})},catalog:function(r){var n,a=this.options||{};return r===t?(a.connection||{}).catalog:(n=a.connection||{},n.catalog=r,this.options.connection=n,e.extend(this.transport.options,{connection:n}),t)},cube:function(e){var r,n=this.options||{};return e===t?(n.connection||{}).cube:(r=n.connection||{},r.cube=e,this.options.connection=r,Fe(!0,this.transport.options,{connection:r}),t)},discover:function(e){return De({url:this.options.read},e)}}),ae={cubes:{name:Te.getter("CUBE_NAME['#text']",!0),caption:Te.getter("CUBE_CAPTION['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0),type:Te.getter("CUBE_TYPE['#text']",!0)},catalogs:{name:Te.getter("CATALOG_NAME['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0)},measures:{name:Te.getter("MEASURE_NAME['#text']",!0),caption:Te.getter("MEASURE_CAPTION['#text']",!0),uniqueName:Te.getter("MEASURE_UNIQUE_NAME['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0),aggregator:Te.getter("MEASURE_AGGREGATOR['#text']",!0),groupName:Te.getter("MEASUREGROUP_NAME['#text']",!0),displayFolder:Te.getter("MEASURE_DISPLAY_FOLDER['#text']",!0),defaultFormat:Te.getter("DEFAULT_FORMAT_STRING['#text']",!0)},kpis:{name:Te.getter("KPI_NAME['#text']",!0),caption:Te.getter("KPI_CAPTION['#text']",!0),value:Te.getter("KPI_VALUE['#text']",!0),goal:Te.getter("KPI_GOAL['#text']",!0),status:Te.getter("KPI_STATUS['#text']",!0),trend:Te.getter("KPI_TREND['#text']",!0),statusGraphic:Te.getter("KPI_STATUS_GRAPHIC['#text']",!0),trendGraphic:Te.getter("KPI_TREND_GRAPHIC['#text']",!0),description:Te.getter("KPI_DESCRIPTION['#text']",!0),groupName:Te.getter("MEASUREGROUP_NAME['#text']",!0)},dimensions:{name:Te.getter("DIMENSION_NAME['#text']",!0),caption:Te.getter("DIMENSION_CAPTION['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0),uniqueName:Te.getter("DIMENSION_UNIQUE_NAME['#text']",!0),defaultHierarchy:Te.getter("DEFAULT_HIERARCHY['#text']",!0),type:Te.getter("DIMENSION_TYPE['#text']",!0)},hierarchies:{name:Te.getter("HIERARCHY_NAME['#text']",!0),caption:Te.getter("HIERARCHY_CAPTION['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0),uniqueName:Te.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),dimensionUniqueName:Te.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:Te.getter("HIERARCHY_DISPLAY_FOLDER['#text']",!0),origin:Te.getter("HIERARCHY_ORIGIN['#text']",!0),defaultMember:Te.getter("DEFAULT_MEMBER['#text']",!0)},levels:{name:Te.getter("LEVEL_NAME['#text']",!0),caption:Te.getter("LEVEL_CAPTION['#text']",!0),description:Te.getter("DESCRIPTION['#text']",!0),uniqueName:Te.getter("LEVEL_UNIQUE_NAME['#text']",!0),dimensionUniqueName:Te.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:Te.getter("LEVEL_DISPLAY_FOLDER['#text']",!0),orderingProperty:Te.getter("LEVEL_ORDERING_PROPERTY['#text']",!0),origin:Te.getter("LEVEL_ORIGIN['#text']",!0),hierarchyUniqueName:Te.getter("HIERARCHY_UNIQUE_NAME['#text']",!0)},members:{name:Te.getter("MEMBER_NAME['#text']",!0),caption:Te.getter("MEMBER_CAPTION['#text']",!0),uniqueName:Te.getter("MEMBER_UNIQUE_NAME['#text']",!0),dimensionUniqueName:Te.getter("DIMENSION_UNIQUE_NAME['#text']",!0),hierarchyUniqueName:Te.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),levelUniqueName:Te.getter("LEVEL_UNIQUE_NAME['#text']",!0),childrenCardinality:Te.getter("CHILDREN_CARDINALITY['#text']",!0)}},se=["axes","catalogs","cubes","dimensions","hierarchies","levels","measures"],ie=Te.data.XmlDataReader.extend({init:function(e){Te.data.XmlDataReader.call(this,e),this._extend(e)},_extend:function(e){for(var t,r,n=0,a=se.length;n<a;n++)t=se[n],r=e[t],r&&r!==Ue&&(this[t]=r)},parse:function(e){var t=Te.data.XmlDataReader.fn.parse(e.replace(/<(\/?)(\w|-)+:/g,"<$1"));return Te.getter("['Envelope']['Body']",!0)(t)},errors:function(e){var t=Te.getter("['Fault']",!0)(e);return t?[{faultstring:Te.getter("faultstring['#text']",!0)(t),faultcode:Te.getter("faultcode['#text']",!0)(t)}]:null},axes:function(e){var t,r,n,a;for(e=Te.getter('ExecuteResponse["return"].root',!0)(e),t=$(Te.getter("Axes.Axis",!0)(e)),n={columns:{},rows:{}},a=0;a<t.length;a++)r=t[a],"sliceraxis"!==r["@name"].toLowerCase()&&(n.columns.tuples?n.rows=J(r):n.columns=J(r));return n},data:function(e){var t,r,n,a,s,i;for(e=Te.getter('ExecuteResponse["return"].root',!0)(e),t=$(Te.getter("CellData.Cell",!0)(e)),r=[],n=Te.getter("['@CellOrdinal']"),a=Te.getter("Value['#text']"),s=Te.getter("FmtValue['#text']"),i=0;i<t.length;i++)r.push({value:a(t[i]),fmtValue:s(t[i]),ordinal:parseInt(n(t[i]),10)});return r},_mapSchema:function(e,t){var r,n,a,s,i;for(e=Te.getter('DiscoverResponse["return"].root',!0)(e),r=$(Te.getter("row",!0)(e)),n=[],a=0;a<r.length;a++){s={};for(i in t)s[i]=t[i](r[a]);n.push(s)}return n},measures:function(e){return this._mapSchema(e,ae.measures)},kpis:function(e){return this._mapSchema(e,ae.kpis)},hierarchies:function(e){return this._mapSchema(e,ae.hierarchies)},levels:function(e){return this._mapSchema(e,ae.levels)},dimensions:function(e){return this._mapSchema(e,ae.dimensions)},cubes:function(e){return this._mapSchema(e,ae.cubes)},catalogs:function(e){return this._mapSchema(e,ae.catalogs)},members:function(e){return this._mapSchema(e,ae.members)}}),Fe(!0,Te.data,{PivotDataSource:Et,PivotDataSourceV2:Tt,XmlaTransport:re,XmlaDataReader:ie,PivotCubeBuilder:It,transports:{xmla:re},readers:{xmla:ie}}),oe=function(e,t){if(!e)return null;for(var r=0,n=e.length;r<n;r++)if(e[r].field===t)return e[r];return null},le=function(e,t){var r,n,a=[];for(r=0,n=e.length;r<n;r++)e[r].field!==t&&a.push(e[r]);return a},Te.ui.PivotSettingTarget=Oe.extend({init:function(r,n){var a,s=this;Oe.fn.init.call(s,r,n),s.element.addClass("k-pivot-setting"),s.dataSource=Te.data.PivotDataSource.create(n.dataSource),s._refreshHandler=e.proxy(s.refresh,s),s.dataSource.first(Xe,s._refreshHandler),n.template||(a="",s.options.enabled&&(a='<span class="k-setting-delete k-chip-action"><span class="k-icon k-i-close"></span></span>'),s.options.template='<span class="k-chip k-chip-md k-rounded-full k-chip-solid k-chip-solid-base" data-'+Te.ns+'name="${data.name || data}"><span class="k-chip-content"><span class="k-chip-text">${data.name || data}</span></span><span class="k-chip-actions">'+a+"</span></span>"),s.template=Te.template(s.options.template),s.emptyTemplate=Te.template(s.options.emptyTemplate),s._sortable(),s.element.on("click"+st,".k-chip, .k-button",function(r){var n,a=e(r.target),i=a.closest(".k-chip-action"),o=a.closest("["+Te.attr("name")+"]").attr(Te.attr("name"));if(o)return i.hasClass("k-setting-delete")?(s.remove(o),t):(a.closest(".k-chip-actions").length>0||s.options.sortable&&(n=e(r.currentTarget).find(".k-i-sort-asc-sm").length?"desc":"asc",s.sort({field:o,dir:n})),t)}),(n.filterable||n.sortable)&&(s.fieldMenu=new Ee.PivotFieldMenu(s.element,{messages:s.options.messages.fieldMenu,filter:".k-setting-fieldmenu",filterable:n.filterable,sortable:n.sortable,dataSource:s.dataSource})),s.refresh()},options:{name:"PivotSettingTarget",template:null,filterable:!1,sortable:!1,emptyTemplate:"<div class='k-empty'>${data}</div>",setting:"columns",enabled:!0,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(Xe,this._refreshHandler),this.dataSource=this.options.dataSource=e,this.fieldMenu&&this.fieldMenu.setDataSource(e),e.first(Xe,this._refreshHandler),this.refresh()},_sortable:function(){var e=this;e.options.enabled&&(this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,hint:e.options.hint,filter:">*:not(.k-empty)",cursor:"move",start:function(e){e.item.trigger("focus").trigger("blur")},change:function(t){var r=t.item.attr(Te.attr("name"));"receive"==t.action?e.add(r):"remove"==t.action?e.remove(r):"sort"==t.action&&e.move(r,t.newIndex)}}).data("kendoSortable"))},_isKPI:function(e){return"kpi"===e.type||e.measure},validate:function(e){var t,r,n=2==e.type||"aggregator"in e||this._isKPI(e);return n?"measures"===this.options.setting:"measures"===this.options.setting?n:(t=this.dataSource[this.options.setting](),r=e.defaultHierarchy||e.uniqueName,!(V(r,t)>-1)&&(t=this.dataSource["columns"===this.options.setting?"rows":"columns"](),!(V(r,t)>-1)))},add:function(e){var t,r,n=this.dataSource[this.options.setting]();for(e=Array.isArray(e)?e.slice(0):[e],t=0,r=e.length;t<r;t++)V(e[t],n)!==-1&&(e.splice(t,1),t-=1,r-=1);e.length&&(n=n.concat(e),this.dataSource[this.options.setting](n))},move:function(e,t){var r=this.dataSource[this.options.setting](),n=V(e,r);n>-1&&(e=r.splice(n,1)[0],r.splice(t,0,e),this.dataSource[this.options.setting](r))},remove:function(e){var t=this.dataSource[this.options.setting](),r=V(e,t),n=this.dataSource.sort(),a=this.dataSource.filter();r>-1&&(a&&(a.filters=le(a.filters,e),this.dataSource._filter.filters=a.filters,a.filters.length||(this.dataSource._filter=null)),n&&(n=le(n,e),this.dataSource._sort=n),t.splice(r,1),this.dataSource[this.options.setting](t))},sort:function(e){var t=this.options.sortable,r=t===!0||t.allowUnsort,n=r&&"asc"===e.dir,a=this.dataSource.sort()||[],s=le(a,e.field);n&&a.length!==s.length&&(e=null),e&&s.push(e),this.dataSource.sort(s)},refresh:function(){var e,r="",n=this.dataSource[this.options.setting](),a=n.length,s=0;if(a)for(;s<a;s++)e=n[s],e=e.name===t?{name:e}:e,r+=this.template(Fe({sortIcon:this._sortIcon(e.name)},e));else r=this.emptyTemplate(this.options.messages.empty);this.element.html(r)},destroy:function(){Oe.fn.destroy.call(this),this.dataSource.unbind(Xe,this._refreshHandler),this.element.off(st),this.sortable&&this.sortable.destroy(),this.fieldMenu&&this.fieldMenu.destroy(),this.element=null,this._refreshHandler=null},_sortIcon:function(e){var t=this.dataSource.sort(),r=oe(t,q(e)),n="";return r&&(n="k-i-sort-"+r.dir),n}}),Te.ui.PivotSettingTargetV2=Oe.extend({init:function(t,r){var n=this;Oe.fn.init.call(n,t,r),n.dataSource=Te.data.PivotDataSourceV2.create(r.dataSource),n._refreshHandler=e.proxy(n.refresh,n),n.dataSource.first(Xe,n._refreshHandler),n.template=Te.template(n.options.template),n._sortable(),n.element.on("click"+st,".k-i-close-circle",function(t){var r=e(t.target),a=r.closest(".k-chip"),s=a.find(".k-chip-label").text();s&&(n.remove(s),a.remove(),n.trigger("remove",{name:s}))}),(r.filterable||r.sortable)&&(n.fieldMenu=new Ee.PivotFieldMenuV2(n.element,{messages:n.options.messages.fieldMenu,filterable:r.filterable,filter:".k-i-more-vertical",sortable:r.sortable,dataSource:n.dataSource})),n.refresh()},events:["remove"],options:{name:"PivotSettingTargetV2",template:null,filterable:!1,sortable:!1,setting:"columns",enabled:!0,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(Xe,this._refreshHandler),this.dataSource=this.options.dataSource=e,this.fieldMenu&&this.fieldMenu.setDataSource(e),e.first(Xe,this._refreshHandler),this.refresh()},_applyState:function(){this._sortState!==t&&(this.dataSource._sort=this._sortState,this._sortState=t),this._stateFilter!==t&&(this.dataSource._filter=this._stateFilter,this._stateFilter=t),this.dataSource["_"+this.options.setting]="measures"===this.options.setting?r(this._savedState):n(this._savedState)},_cancelChanges:function(){this._sortState=t,this._stateFilter=t,this._savedState=Te.deepExtend([],this._initialState),this._redraw()},_state:function(e,r){var n=this;return e?(n._savedState&&!r||(n._initialState=Te.deepExtend([],e)),n._savedState=Te.deepExtend([],e),t):n._savedState||[]},_sortable:function(){var e=this;this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,hint:e.options.hint,filter:">*:not(.k-empty)",cursor:"move",start:function(e){e.item.focus().blur()},change:function(t){var r=t.item.find(".k-chip-label").text();"receive"==t.action?e.add(r):"remove"==t.action?e.remove(r):"sort"==t.action&&e.move(r,t.newIndex)}}).data("kendoSortable")},add:function(t){var r,n,a=this._state();for(t=e.isArray(t)?t.slice(0):[t],r=0,n=t.length;r<n;r++)V(t[r],a)!==-1&&(t.splice(r,1),r-=1,n-=1);t.length&&(a=a.concat(t),this._state(a),this._redraw())},move:function(e,t){var r=this._state(),n=V(e,r);n>-1&&(e=r.splice(n,1)[0],r.splice(t,0,e),this._state(r),this._redraw())},remove:function(e){var t=this._state(),r=V(e,t),n=this.dataSource.sort(),a=this.dataSource.filter();r>-1&&(a&&(a.filters=le(a.filters,e),this._savedFilter=this.dataSource._filter,this._savedFilter.filters=a.filters,a.filters.length||(this._savedFilter=null)),n&&(n=le(n,e),this._sortState=n),t.splice(r,1),this._state(t),this._redraw())},_emptyState:function(e){var t=this;e?t.element.html(this.options.messages.empty).addClass("k-settings-description").removeClass("k-chip-list"):t.element.removeClass("k-settings-description").addClass("k-chip-list")},_redraw:function(){var e=this._state()||[];this._emptyState(!e.length),e.length&&this.element.html(this._targetsHTML(e))},_targetsHTML:function(e){var r,n="",a=0,s=this.options,i=!1;if("measures"!=this.options.setting&&(i=s.filterable||s.sortable),e.length)for(;a<e.length;a++)r=e[a],r=r.name===t?{name:r}:r,n+=this.template({name:r.name,menuenabled:i});return n},refresh:function(){if(!this.dataSource._preventRefresh){var e=this.dataSource[this.options.setting]();this._emptyState(!this._state().length),this._state(e,!0),e.length&&this.element.html(this._targetsHTML(e))}},destroy:function(){Oe.fn.destroy.call(this),this.dataSource.unbind(Xe,this._refreshHandler),this.element.off(st),this.sortable&&this.sortable.destroy(),this.fieldMenu&&this.fieldMenu.destroy(),this.element=null,this._refreshHandler=null}}),ue=Oe.extend({init:function(t,r){var n=this;Oe.fn.init.call(n,t,r),n.element=e(t),n._element(),n._attachEvents()},options:{name:"PivotConfiguratorButton",text:"Change settings",configurator:""},destroy:function(){this.element.off(st)},setOptions:function(e){var t=this;Te.deepExtend(t.options,e),this.init(this.element,this.options)},toggle:function(){var t,r=Te.attr("role"),n=this.element.closest("["+r+"=pivotcontainer]").find("["+r+"=pivotgridv2]");e("#"+this.options.configurator).toggleClass("k-hidden"),n.length&&(t=n.getKendoPivotGridV2(),t._setContentWidth(),t._updateDimensions())},_attachEvents:function(){this.element.on("click"+st,e.proxy(this.toggle,this))},_element:function(){var e=this.options;this.element.addClass("k-pivotgrid-configurator-button"),this.element.html(Te.format("<span>{0}<span class='k-icon k-i-gear k-color-inherit'></span></span>",e.text))}}),ce=Oe.extend({init:function(t,r){var n=this;Oe.fn.init.call(n,t,r),n.element=e(t),n.options=r,n._addClasses()},options:{name:"PivotContainer",configuratorPosition:"left"},setOptions:function(e){var t=this;Te.deepExtend(t.options,e),this.init(this.element,this.options)},_addClasses:function(){var e,t=this.options;switch(this.element.removeClass("k-flex-row k-flex-row-reverse k-flex-column k-flex-column-reverse"),t.configuratorPosition){case"right":e="k-flex-row";break;case"left":e="k-flex-row-reverse";break;case"bottom":e="k-flex-column";break;case"top":e="k-flex-column-reverse";break;default:e="k-flex-row"}this.element.addClass("k-d-flex k-pos-relative").addClass(e)}}),he=Oe.extend({init:function(t,r){var n=this;Oe.fn.init.call(n,t,r),n._dataSource(),n._bindConfigurator(),n._wrapper(),n._columnHeadersWrapper=e('<div class="k-pivotgrid-column-headers"></div>'),n._rowHeadersWrapper=e('<div class="k-pivotgrid-row-headers"></div>'),n._contentWrapper=e('<div class="k-pivotgrid-values"></div>'),n.wrapper.append(n._columnHeadersWrapper),n.wrapper.append(n._rowHeadersWrapper),n.wrapper.append(n._contentWrapper),n._columnBuilder=new xe({template:this.options.columnHeaderTemplate,axes:"columns"}),n._rowBuilder=new xe({template:this.options.rowHeaderTemplate,axes:"rows"}),n._contentBuilder=new ve({template:this.options.dataCellTemplate||_t}),n._scrollable(),n._rowHeadersWrapper.add(n._columnHeadersWrapper).on("click","span.k-icon",function(){var t,r,a,s=e(this),i=s.parent().attr(Te.attr("key")),o=s.hasClass("k-i-arrow-chevron-up"),l=0!==s.closest(".k-pivotgrid-row-headers").length,u=i.split(","),c=o?ht:ut;n.trigger(c,{path:u,axis:l?"rows":"columns"})||(t={type:"HEADERS_ACTION_TOGGLE",payload:u,tree:l?n._rowBuilder.getTree():n._columnBuilder.getTree()},r=l?n.dataSource._rows:n.dataSource._columns,a=je(r,t),n.dataSource._preventRefresh=!0,l?n.dataSource.rows(a):n.dataSource.columns(a))}),n.options.autoBind&&n.dataSource.fetch(),Te.notify(n)},events:[ot,lt,ut,ht],options:{name:"PivotGridV2",autoBind:!0,height:null,columnWidth:null,configurator:"",columnHeaderTemplate:null,rowHeaderTemplate:null,dataCellTemplate:null},destroy:function(){var t=this;Oe.fn.destroy.call(t),t._windowResizeHandler&&(e(window).off(Ke+st,t._windowResizeHandler),t._windowResizeHandler=null)},_dataSource:function(){var t=this,r=t.options.dataSource;r=e.isArray(r)?{data:r}:r,t.dataSource&&this._refreshHandler?t.dataSource.unbind(Xe,t._refreshHandler).unbind(Ze,t._progressHandler).unbind($e,t._errorHandler):(t._refreshHandler=e.proxy(t.refresh,t),t._progressHandler=e.proxy(t._requestStart,t),t._errorHandler=e.proxy(t._error,t)),t.dataSource=Te.data.PivotDataSourceV2.create(r).bind(Xe,t._refreshHandler).bind(Ze,t._progressHandler).bind($e,t._errorHandler)},_resize:function(){var e=this;e.wrapper[0].style.setProperty("--kendo-scrollbar-width",Te.format("{0}px",p()))},_scrollable:function(){var t=this,r=t._columnHeadersWrapper,n=t._rowHeadersWrapper;t._resize(),t._windowResizeHandler=e.proxy(t._resize,t),t._contentWrapper.scroll(function(){Te.scrollLeft(r,this.scrollLeft),n.scrollTop(this.scrollTop)}),n.bind("DOMMouseScroll"+st+" mousewheel"+st,e.proxy(t._wheelScroll,t)),e(window).on(Ke+st,t._windowResizeHandler)},_wheelScroll:function(t){var r,n;t.ctrlKey||(r=Te.wheelDeltaY(t),n=this._contentWrapper.scrollTop(),r&&(t.preventDefault(),e(t.currentTarget).one("wheel"+st,!1),this._rowHeadersWrapper.scrollTop(n+-r),this._contentWrapper.scrollTop(n+-r)))},_wrapper:function(){var e=this.options.height;this.wrapper=this.element.addClass("k-widget k-pivotgrid"),this.wrapper.append('<span class="k-pivotgrid-empty-cell" />'),e&&this.wrapper.css("height",e)},_progress:function(e){Te.ui.progress(this.wrapper,e)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_updateDimensions:function(){var e=this;e.wrapper.css({"grid-template-columns":Te.format("{0}px 1fr",e._rowHeadersWrapper.find(".k-pivotgrid-table")[0].offsetWidth),"grid-template-rows":Te.format("{0}px 1fr",e._columnHeadersWrapper.find(".k-pivotgrid-table")[0].offsetHeight)})},_setContentWidth:function(){var e,t,r,n,a;this.options.columnWidth&&(e=this._contentWrapper.find("table"),t=this._columnHeadersWrapper.children("table"),r=e.children("colgroup").children().length,n=r*this.options.columnWidth,a=Math.ceil(n/this._contentWrapper.width()*100),a<100&&(a=100),e.add(t).css("width",a+"%"))},_bindConfigurator:function(){var t=this.options.configurator;t&&e(t).kendoPivotConfiguratorV2("setDataSource",this.dataSource)},cellInfoByElement:function(t){return t=e(t),this.cellInfo(t.index(),t.parent("tr").index())},cellInfo:function(e,t){var r,n,a=this._contentBuilder;return e>=a.columnsCount||e<0||t>=a.rowsCount||t<0?null:(r=t*a.columnsCount+e,n=a.hash[r<0?0:r],{columnTuple:n.columnTuple,rowTuple:n.rowTuple,dataItem:n.data})},refresh:function(){var e=this,t=e.dataSource;e.trigger(ot,{action:"rebind"})||(e._columnBuilder.setTuples(t._columnTuples),e._columnHeadersWrapper.html(e._columnBuilder.build()),e._rowBuilder.setTuples(t._rowTuples),e._rowHeadersWrapper.html(e._rowBuilder.build()),e._contentBuilder.setRowColumnInfo({columnHeaderLeafs:e._columnBuilder.getHeaderLeafs(),rowHeaderLeafs:e._rowBuilder.getHeaderLeafs(),columnHeaderBreadth:e._columnBuilder.getBreadth(),rowHeaderDepth:e._rowBuilder.getBreadth(),data:t._view}),e._contentWrapper.html(e._contentBuilder.build()),e._setContentWidth(),e._updateDimensions(),e._progress(!1),e.trigger(lt))}}),Ee.plugin(ue),Ee.plugin(ce),Ee.plugin(he),de=Oe.extend({init:function(r,n){var a,s,i=this;Oe.fn.init.call(i,r,n),i._dataSource(),i._bindConfigurator(),i._wrapper(),i._createLayout(),i._columnBuilder=a=new Ae,i._rowBuilder=s=new Ne,i._contentBuilder=new Ie,i._templates(),i.columnsHeader.add(i.rowsHeader).on("click","span.k-icon",function(){var r,n,o,l,u=e(this),c=a,h="expandColumn",d=u.attr(Te.attr("path")),p={axis:"columns",path:e.parseJSON(d)};u.parent().is("td")&&(c=s,h="expandRow",p.axis="rows"),n=u.hasClass(dt),o=c.metadata[d],l=o.expanded===t,r=n?ht:ut,p.childrenLoaded=o.maxChildren>o.children,i.trigger(r,p)||(c.metadata[d].expanded=!n,u.toggleClass(dt,!n).toggleClass(pt,n),!n&&l?i.dataSource[h](p.path):i.refresh())}),i._scrollable(),i.options.autoBind&&i.dataSource.fetch(),Te.notify(i)},events:[ot,lt,ut,ht],options:{name:"PivotGrid",autoBind:!0,reorderable:!0,filterable:!1,sortable:!1,height:null,columnWidth:100,configurator:"",columnHeaderTemplate:null,rowHeaderTemplate:null,dataCellTemplate:null,kpiStatusTemplate:null,kpiTrendTemplate:null,messages:{measureFields:"Drop Data Fields Here",columnFields:"Drop Column Fields Here",rowFields:"Drop Rows Fields Here"}},_templates:function(){var e=this.options.columnHeaderTemplate,t=this.options.rowHeaderTemplate,r=this.options.dataCellTemplate,n=this.options.kpiStatusTemplate,a=this.options.kpiTrendTemplate;this._columnBuilder.template=Te.template(e||mt,{useWithBlock:!!e}),this._contentBuilder.dataTemplate=Te.template(r||_t,{useWithBlock:!!r}),this._contentBuilder.kpiStatusTemplate=Te.template(n||ft,{useWithBlock:!!n}),this._contentBuilder.kpiTrendTemplate=Te.template(a||gt,{useWithBlock:!!a}),this._rowBuilder.template=Te.template(t||mt,{useWithBlock:!!t})},_bindConfigurator:function(){var t=this.options.configurator;t&&e(t).kendoPivotConfigurator("setDataSource",this.dataSource)},cellInfoByElement:function(t){return t=e(t),this.cellInfo(t.index(),t.parent("tr").index())},cellInfo:function(e,t){var r,n=this._contentBuilder,a=n.columnIndexes[e||0],s=n.rowIndexes[t||0];return a&&s?(r=s.index*n.rowLength+a.index,{columnTuple:a.tuple,rowTuple:s.tuple,measure:a.measure||s.measure,dataItem:this.dataSource.view()[r]}):null},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.measuresTarget&&this.measuresTarget.setDataSource(e),this.rowsTarget&&this.rowsTarget.setDataSource(e),this.columnsTarget&&this.columnsTarget.setDataSource(e),this._bindConfigurator(),this.options.autoBind&&e.fetch()},setOptions:function(e){Oe.fn.setOptions.call(this,e),this._templates()},destroy:function(){Oe.fn.destroy.call(this),clearTimeout(this._headerReflowTimeout)},_dataSource:function(){var t=this,r=t.options.dataSource;r=Array.isArray(r)?{data:r}:r,t.dataSource&&this._refreshHandler?t.dataSource.unbind(Xe,t._refreshHandler).unbind(rt,t._stateResetHandler).unbind(Ze,t._progressHandler).unbind($e,t._errorHandler):(t._refreshHandler=e.proxy(t.refresh,t),t._progressHandler=e.proxy(t._requestStart,t),t._stateResetHandler=e.proxy(t._stateReset,t),t._errorHandler=e.proxy(t._error,t)),t.dataSource=Te.data.PivotDataSource.create(r).bind(Xe,t._refreshHandler).bind(Ze,t._progressHandler).bind(rt,t._stateResetHandler).bind($e,t._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_stateReset:function(){this._columnBuilder.reset(),this._rowBuilder.reset()},_wrapper:function(){var e=this.options.height;this.wrapper=this.element.addClass("k-widget k-pivot"),e&&this.wrapper.css("height",e)},_measureFields:function(){this.measureFields=e(at).addClass("k-pivot-toolbar k-toolbar k-settings-measures"),this.measuresTarget=this._createSettingTarget(this.measureFields,{setting:"measures",messages:{empty:this.options.messages.measureFields}})},_createSettingTarget:function(t,r){var n,a=r.sortable,s="";return a&&(s+="#if (data.sortIcon) {#",s+='<span class="k-chip-action"><span class="k-icon ${data.sortIcon}-sm"></span></span>',s+="#}#"),(r.filterable||a)&&(s+='<span class="k-setting-fieldmenu k-chip-action"><span class="k-icon k-i-more-vertical"></span></span>'),this.options.reorderable&&(s+='<span class="k-setting-delete k-chip-action"><span class="k-icon k-i-close"></span></span>'),n='<span class="k-chip k-chip-md k-rounded-full k-chip-solid k-chip-solid-base" tabindex="0" data-'+Te.ns+'name="${data.name}"><span class="k-chip-content"><span class="k-chip-text">${data.name}</span></span><span class="k-chip-actions k-field-actions">'+s+"</span></span>",new Te.ui.PivotSettingTarget(t,e.extend({dataSource:this.dataSource,template:n,emptyTemplate:'<span class="k-empty">${data}</span>',enabled:this.options.reorderable},r))},_initSettingTargets:function(){this.columnsTarget=this._createSettingTarget(this.columnFields,{connectWith:this.rowFields,setting:"columns",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.columnFields,fieldMenu:this.options.messages.fieldMenu}}),this.rowsTarget=this._createSettingTarget(this.rowFields,{connectWith:this.columnFields,setting:"rows",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.rowFields,fieldMenu:this.options.messages.fieldMenu}})},_createLayout:function(){var t=this,r=e(vt),n=r.find(".k-pivot-rowheaders"),a=r.find(".k-pivot-table"),s=e(at).addClass("k-grid k-widget");t._measureFields(),t.columnFields=e(at).addClass("k-pivot-toolbar k-toolbar k-settings-columns"),t.rowFields=e(at).addClass("k-pivot-toolbar k-toolbar k-settings-rows"),t.columnsHeader=e('<div class="k-grid-header-wrap" />').wrap('<div class="k-grid-header" />'),t.columnsHeader.parent().css("padding-right",Te.support.scrollbar()),t.rowsHeader=e('<div class="k-grid k-widget k-alt"/>'),t.content=e('<div class="k-grid-content" />'),n.append(t.measureFields),n.append(t.rowFields),n.append(t.rowsHeader),s.append(t.columnsHeader.parent()),s.append(t.content),a.append(t.columnFields),a.append(s),t.wrapper.append(r),t.columnsHeaderTree=new Te.dom.Tree(t.columnsHeader[0]),t.rowsHeaderTree=new Te.dom.Tree(t.rowsHeader[0]),t.contentTree=new Te.dom.Tree(t.content[0]),t._initSettingTargets()},_progress:function(e){Te.ui.progress(this.wrapper,e)},_resize:function(){this.content[0].firstChild&&(this._setSectionsWidth(),this._setSectionsHeight(),this._setContentWidth(),this._setContentHeight(),this._columnHeaderReflow())},_columnHeaderReflow:function(){var e=this.columnsHeader.children("table");Te.support.browser.mozilla&&(clearTimeout(this._headerReflowTimeout),e.css("table-layout","auto"),this._headerReflowTimeout=setTimeout(function(){e.css("table-layout","")}))},_setSectionsWidth:function(){var e=this.rowsHeader,t=e.parent(".k-pivot-rowheaders").width(nt),r=Math.max(Re(this.measureFields),Re(this.rowFields));r=Math.max(e.children("table").width(),r),t.width(r)},_setSectionsHeight:function(){var e=this.measureFields.height(nt).height(),t=this.columnFields.height(nt).height(),r=this.rowFields.height(nt).innerHeight(),n=this.columnsHeader.height(nt).innerHeight(),a=r-this.rowFields.height(),s=t>e?t:e,i=n>r?n:r;this.measureFields.height(s),this.columnFields.height(s),this.rowFields.height(i-a),this.columnsHeader.height(i)},_setContentWidth:function(){var e=this.content.find("table"),t=this.columnsHeader.children("table"),r=e.children("colgroup").children().length,n=r*this.options.columnWidth,a=Math.ceil(n/this.content.width()*100);a<100&&(a=100),e.add(t).css("width",a+"%"),this._resetColspan(t)},_setContentHeight:function(){var e=this,r=e.content,n=e.rowsHeader,a=e.wrapper.innerHeight(),s=Te.support.scrollbar(),i=r[0].offsetHeight===r[0].clientHeight,o=e.options.height;if(e.wrapper.is(":visible")){if(!a||!o)return i&&(s=0),r.height("auto"),n.height(r.height()-s),t;a-=ye(e.columnFields),a-=ye(e.columnsHeader.parent()),a<=2*s&&(a=2*s+1,i||(a+=s)),r.height(a),i&&(s=0),n.height(a-s)}},_resetColspan:function(e){var r=this,n=e.children("tbody").children().first().children().first();r._colspan===t&&(r._colspan=n.attr("colspan")),n.attr("colspan",1),clearTimeout(r._layoutTimeout),r._layoutTimeout=setTimeout(function(){n.attr("colspan",r._colspan),r._colspan=t})},_axisMeasures:function(e){var t=[],r=this.dataSource,n=r.measures(),a=n.length>1||n[0]&&n[0].type;return r.measuresAxis()===e&&(0===r[e]().length||a)&&(t=n),t},items:function(){return[]},refresh:function(){var e,t=this,r=t.dataSource,n=r.axes(),a=(n.columns||{}).tuples||[],s=(n.rows||{}).tuples||[],i=t._columnBuilder,o=t._rowBuilder,l={},u={};t.trigger(ot,{action:"rebind"})||(i.measures=t._axisMeasures(At),o.measures=t._axisMeasures(xt),t.columnsHeaderTree.render(i.build(a)),t.rowsHeaderTree.render(o.build(s)),l={indexes:i._indexes,measures:i.measures,metadata:i.metadata},u={indexes:o._indexes,measures:o.measures,metadata:o.metadata},t.contentTree.render(t._contentBuilder.build(r.view(),l,u)),t._resize(),t.touchScroller?t.touchScroller.contentResized():(e=Te.touchScroller(t.content),e&&e.movable&&(t.touchScroller=e,e.movable.bind("change",function(e){Te.scrollLeft(t.columnsHeader,-e.sender.x),t.rowsHeader.scrollTop(-e.sender.y)}))),t._progress(!1),t.trigger(lt))},_scrollable:function(){var t=this,r=t.columnsHeader,n=t.rowsHeader;t.content.on("scroll",function(){Te.scrollLeft(r,this.scrollLeft),n.scrollTop(this.scrollTop)}),n.on("DOMMouseScroll"+st+" mousewheel"+st,e.proxy(t._wheelScroll,t))},_wheelScroll:function(t){var r,n;t.ctrlKey||(r=Te.wheelDeltaY(t),n=this.content.scrollTop(),r&&(t.preventDefault(),e(t.currentTarget).one("wheel"+st,!1),this.rowsHeader.scrollTop(n+-r),this.content.scrollTop(n+-r)))}}),pe=Te.dom.element,me=Te.dom.html,fe=function(e,t){return{maxChildren:0,children:0,maxMembers:0,members:0,measures:1,levelNum:e,parentMember:0!==t}},ge=function(e,t){for(var r=[],n=0;n<=t;n++)r.push(e.members[n].name);return r},_e=function(e,t){for(var r="",n=0;n<=t;n++)r+=e.members[n].name;return r},ve=be.extend({init:function(e){this.template=Te.template(e.template),this.hash=[]},setRowColumnInfo:function(e){this.data=e.data,this.columnHeaderLeafs=e.columnHeaderLeafs,this.rowHeaderLeafs=e.rowHeaderLeafs,this.columnHeaderBreadth=e.columnHeaderBreadth,this.rowHeaderDepth=e.rowHeaderDepth,this.hash.length=0},addColElements:function(e){var t,r="";for(t=0;t<e;t++)r+="<col>";this.table.find("colgroup").append(r)},addRowElements:function(t){var r,n,a=this,s=a.table.find("tbody");for(n=0;n<t.length;n++)r=e('<tr class="k-pivotgrid-row"></tr>'),s.append(r),a.addColumCell(r,t[n],n);this.rowsCount=t.length},addColumCell:function(t,r,n){var a,s,i,o=this;for(a=0;a<r.cells.length;a++)s=r.cells[a],s&&(i=e('<td class="k-pivotgrid-cell"></td>'),(this.rowHeaderLeafs[n].total||this.columnHeaderLeafs[a].total)&&i.addClass("k-pivotgrid-header-total"),i.append(o.template({dataItem:s.data,rowTuple:s.rowTuple,columnTuple:s.columnTuple})),this.hash.push(s),t.append(i))},build:function(){var t=Ye((this.data||[]).slice(),this.columnHeaderLeafs,this.rowHeaderLeafs,this.columnHeaderBreadth,this.rowHeaderDepth),r=this,n=e("<table class='k-pivotgrid-table'><colgroup></colgroup><tbody class='k-pivotgrid-tbody'></tbody></table>");return r.table=n,r.addColElements(this.columnHeaderLeafs.length),r.addRowElements(t),this.rowsCount=t.length,this.columnsCount=this.columnHeaderLeafs.length,r.table}}),xe=be.extend({init:function(e){this.tuples=e.tuples,
this.axes=e.axes,this.headerTemplate=Te.template(ct),e.template&&(this.template=Te.template(e.template))},setTuples:function(e){this.tuples=e},addColElements:function(e){var t,r="";for(t=0;t<e;t++)r+="<col>";this.table.find("colgroup").append(r)},addRowElements:function(t){var r,n,a=this,s=a.table.find("tbody");for(n=0;n<t.length;n++)r=e('<tr class="k-pivotgrid-row"></tr>'),s.append(r),a.addColumCell(r,t[n])},addColumCell:function(t,r){var n,a,s,i=this;for(s=0;s<r.cells.length;s++)a=r.cells[s],a&&(n=e(i.headerTemplate({rowspan:a.rowSpan,colspan:a.colSpan,key:a.path.join(",")+(a.total?"|[TOTAL]":""),iconClass:a.children&&a.children.length?"up":"down",expandable:a.hasChildren&&!a.total,headerClass:Te.format("k-pivotgrid-cell{0}{1}",a.total?" k-pivotgrid-header-total":"",0===a.levelNum?" k-pivotgrid-header-root":"")})),n.append(i.template?i.template({member:a}):a.caption),t.append(n))},build:function(){var t,r=ze((this.tuples||[]).slice()),n="columns"==this.axes?qe(r):We(r),a=n[0],s=n[1],i=n[2],o=n[3],l=this;return l._tree=r,l._breadth=i,l._headerLeafs=s,t=e("<table class='k-pivotgrid-table'><colgroup></colgroup><tbody class='k-pivotgrid-tbody'></tbody></table>"),l.table=t,l.addColElements("columns"==this.axes?s.length:o),l.addRowElements(a),l.table},getTree:function(){return this._tree},getBreadth:function(){return this._breadth},getHeaderLeafs:function(){return this._headerLeafs}}),Ae=be.extend({init:function(){this.measures=1,this.metadata={}},build:function(e){var t=this._tbody(e),r=this._colGroup();return[pe("table",null,[r,t])]},reset:function(){this.metadata={}},_colGroup:function(){for(var e=this._rowLength(),t=[],r=0;r<e;r++)t.push(pe("col",null));return pe("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.map={},this.rows=[],this.rootTuple=t,this._indexes=[],t?(this._buildRows(t,0),this._normalize()):this.rows.push(pe("tr",null,[pe("th",null,[me("&nbsp;")])])),pe("tbody",null,this.rows)},_normalize:function(){for(var e,t,r,n,a,s=this.rows,i=s.length,o=0;o<i;o++)if(e=s[o],1!==e.rowSpan)for(n=e.children,r=0,t=n.length;r<t;r++)a=n[r],a.tupleAll&&(a.attr.rowSpan=e.rowSpan)},_rowIndex:function(e){for(var t=this.rows,r=t.length,n=0;n<r&&t[n]!==e;n++);return n},_rowLength:function(){var e=this.rows[0]?this.rows[0].children:[],t=e.length,r=0,n=0;if(t)for(;n<t;n++)r+=e[n].attr.colSpan||1;return r||(r=this.measures),r},_row:function(e,t,r){var n,a,s=this.rootTuple.members[t].name,i=e.members[t].levelNum,o=s+i,l=this.map,u=l[o];return u?(u.notFirst=!1,u.parentMember&&u.parentMember===r||(u.parentMember=r,u.collapsed=0,u.colSpan=0)):(u=pe("tr",null,[]),u.parentMember=r,u.collapsed=0,u.colSpan=0,u.rowSpan=1,l[o]=u,n=l[s+(+i-1)],n&&(a=n.children,u.notFirst=!(!a[1]||a[1].attr.className.indexOf("k-alt")!==-1)||n.notFirst),this.rows.splice(this._rowIndex(n)+1,0,u)),u},_measures:function(e,t,r){var n,a,s,i=this.map,o=i.measureRow;for(o||(o=pe("tr",null,[]),i.measureRow=o,this.rows.push(o)),a=0,s=e.length;a<s;a++)n=e[a],o.children.push(this._cell(r||"",[this._content(n,t)],n));return s},_content:function(e,t){return me(this.template({member:e,tuple:t}))},_cell:function(e,t,r){var n=pe("th",{className:"k-header"+e},t);return n.value=r.caption||r.name,n},_buildRows:function(e,r,n){var a,s,i,o,l,u,c,h,d,p,m=e.members,f=m[r],g=m[r+1],_=[],v=0,x=0,A=0;if(f.measure)return this._measures(f.children,e),t;if(h=Te.stringify(ge(e,r)),a=this._row(e,r,n),i=f.children,o=i.length,d=this.metadata[h],d||(this.metadata[h]=d=fe(+f.levelNum,r),d.rootLevelNum=+this.rootTuple.members[r].levelNum),this._indexes.push({path:h,tuple:e}),f.hasChildren&&(d.expanded===!1&&(x=d.maxChildren,a.collapsed+=x,d.children=0,o=0),c={className:"k-icon "+(o?dt:pt)},c[Te.attr("path")]=h,_.push(pe("span",c))),_.push(this._content(f,e)),l=this._cell(a.notFirst?" k-first":"",_,f),a.children.push(l),a.colSpan+=1,o){for(u=this._cell(" k-alt",[this._content(f,e)],f),a.children.push(u);v<o;v++)s=this._buildRows(i[v],r,f);p=s.colSpan,x=s.collapsed,l.attr.colSpan=p,d.children=p,d.members=1,a.colSpan+=p,a.collapsed+=x,a.rowSpan=s.rowSpan+1,g&&(g.measure?p=this._measures(g.children,e," k-alt"):(s=this._buildRows(e,r+1),p=s.colSpan,a.collapsed+=s.collapsed,A=s.collapsed),u.attr.colSpan=p,p-=1,d.members+=p,a.colSpan+=p)}else g&&(g.measure?p=this._measures(g.children,e):(s=this._buildRows(e,r+1),p=s.colSpan,a.collapsed+=s.collapsed,A=s.collapsed),d.members=p,p>1&&(l.attr.colSpan=p,a.colSpan+=p-1));return d.maxMembers<d.members+A&&(d.maxMembers=d.members+A),i=d.children+x,d.maxChildren<i&&(d.maxChildren=i),(u||l).tupleAll=!0,a}}),Ne=be.extend({init:function(){this.metadata={}},build:function(e){var t=this._tbody(e),r=this._colGroup();return[pe("table",null,[r,t])]},reset:function(){this.metadata={}},_rowLength:function(){for(var e=this.rows[0].children,t=0,r=0,n=e[r];n;)t+=n.attr.colSpan||1,n=e[++r];return t},_colGroup:function(){for(var e=this._rowLength(),t=[],r=0;r<e;r++)t.push(pe("col",null));return pe("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.rootTuple=t,this.rows=[],this.map={},this._indexes=[],t?(this._buildRows(t,0),this._normalize()):this.rows.push(pe("tr",null,[pe("td",null,[me("&nbsp;")])])),pe("tbody",null,this.rows)},_normalize:function(){for(var e,t,r,n,a=this.rows,s=a.length,i=0,o=this.rootTuple.members,l=o[0].name,u=o.length,c=0,h=this.map;i<s;i++)for(e=a[i],c=0;c<u;c++)r=this[o[c].name],t=e.colSpan["dim"+c],t&&t.colSpan<r&&(t.attr.colSpan=r-t.colSpan+1);e=h[l],n=h[l+"all"],e&&(e.children[0].attr.className="k-first"),n&&(n.children[0].attr.className+=" k-first")},_row:function(e){var t=pe("tr",null,e);return t.rowSpan=1,t.colSpan={},this.rows.push(t),t},_content:function(e,t){return me(this.template({member:e,tuple:t}))},_cell:function(e,t,r){var n=pe("td",{className:e},t);return n.value=r.caption||r.name,n},_buildRows:function(e,t){var r,n,a,s,i,o,l,u,c,h=this.map,d=e.members,p=d[t],m=d[t+1],f=p.children,g=f.length,_=+p.levelNum,v=this.rootTuple.members[t].name,x=ge(e,t-1).join(""),A=+this.rootTuple.members[t].levelNum,N=x+(A===_?"":p.parentName||""),I=h[N+"all"]||h[N],w=_+1,T=[];if(!I||I.hasChild?I=this._row():I.hasChild=!0,p.measure){for(l=I.allCell?"k-grid-footer":"",I.children.push(this._cell(l,[this._content(f[0],e)],f[0])),I.rowSpan=g,c=1;c<g;c++)this._row([this._cell(l,[this._content(f[c],e)],f[c])]);return I}if(h[x+p.name]=I,r=Te.stringify(ge(e,t)),o=this.metadata[r],o||(this.metadata[r]=o=fe(_,t),o.rootLevelNum=A),this._indexes.push({path:r,tuple:e}),p.hasChildren&&(o.expanded===!1&&(g=0,o.children=0),u={className:"k-icon "+(g?dt:pt)},u[Te.attr("path")]=r,T.push(pe("span",u))),T.push(this._content(p,e)),l=I.allCell&&!g?"k-grid-footer":"",n=this._cell(l,T,p),n.colSpan=w,I.children.push(n),I.colSpan["dim"+t]=n,(!this[v]||this[v]<w)&&(this[v]=w),g){for(I.allCell=!1,I.hasChild=!1,c=0;c<g;c++)s=this._buildRows(f[c],t),I!==s&&(I.rowSpan+=s.rowSpan);I.rowSpan>1&&(n.attr.rowSpan=I.rowSpan),o.children=I.rowSpan,a=this._cell("k-grid-footer",[this._content(p,e)],p),a.colSpan=w,i=this._row([a]),i.colSpan["dim"+t]=a,i.allCell=!0,h[x+p.name+"all"]=i,m&&(s=this._buildRows(e,t+1),a.attr.rowSpan=s.rowSpan),I.rowSpan+=i.rowSpan,o.members=i.rowSpan}else m&&(I.hasChild=!1,this._buildRows(e,t+1),(a||n).attr.rowSpan=I.rowSpan,o.members=I.rowSpan);return o.maxChildren<o.children&&(o.maxChildren=o.children),o.maxMembers<o.members&&(o.maxMembers=o.members),I}}),Ie=be.extend({init:function(){this.columnAxis={},this.rowAxis={}},build:function(e,r,n){var a,s,i=r.indexes[0],o=r.metadata[i?i.path:t];return this.columnAxis=r,this.rowAxis=n,this.data=e,this.rowLength=o?o.maxChildren+o.maxMembers:r.measures.length||1,this.rowLength||(this.rowLength=1),a=this._tbody(),s=this._colGroup(),[pe("table",null,[s,a])]},_colGroup:function(){var e=this.columnAxis.measures.length||1,t=[],r=0;for(this.rows[0]&&(e=this.rows[0].children.length);r<e;r++)t.push(pe("col",null));return pe("colgroup",null,t)},_tbody:function(){return this.rows=[],this.data[0]?(this.columnIndexes=this._indexes(this.columnAxis,this.rowLength),this.rowIndexes=this._indexes(this.rowAxis,Math.ceil(this.data.length/this.rowLength)),this._buildRows()):this.rows.push(pe("tr",null,[pe("td",null,[me("&nbsp;")])])),pe("tbody",null,this.rows)},_indexes:function(e,r){var n,a,s,i,o,l,u=[],c=e.indexes,h=e.metadata,d=e.measures,p=d.length||1,m=0,f=0,g=0,_=c.length;if(!_){for(s=0;s<p;s++)u[s]={index:s,measure:d[s],tuple:null};return u}for(;g<_;g++){if(n=c[g],a=h[n.path],o=a.children+a.members,l=0,o&&(o-=p),a.expanded===!1&&a.children!==a.maxChildren&&(l=a.maxChildren),a.parentMember&&a.levelNum===a.rootLevelNum&&(o=-1),o>-1){for(s=0;s<p;s++)i=o+s,a.children||(i+=f),u[o+f+s]={children:o,index:m,measure:d[s],tuple:n.tuple},m+=1;for(;u[f]!==t;)f+=1}if(f===r)break;m+=l}return u},_buildRows:function(){for(var e,t=this.rowIndexes,r=t.length,n=0;n<r;n++)e=t[n],e&&this.rows.push(this._buildRow(e))},_buildRow:function(e){for(var r,n,a,s,i,o,l,u=e.index*this.rowLength,c=this.columnIndexes,h=c.length,d=[],p=0;p<h;p++)r=c[p],r!==t&&(i={},r.children&&(i.className="k-alt"),s="",o=this.data[u+r.index],l=r.measure||e.measure,n={columnTuple:r.tuple,rowTuple:e.tuple,measure:l,dataItem:o},""!==o.value&&l&&l.type&&("status"===l.type?s=this.kpiStatusTemplate(n):"trend"===l.type&&(s=this.kpiTrendTemplate(n))),s||(s=this.dataTemplate(n)),a=pe("td",i,[me(s)]),a.value=o.value,d.push(a));return i={},e.children&&(i.className="k-grid-footer"),pe("tr",i,d)}}),Ee.plugin(de),Te.PivotExcelExporter=Te.Class.extend({init:function(e){this.options=e,this.widget=e.widget,this.dataSource=this.widget.dataSource},_columns:function(){var e,t=this.widget.columnsHeaderTree.children[0],r=this.widget.rowsHeaderTree.children[0],n=t.children[0].children.length,a=r.children[0].children.length,s=this.widget.options.columnWidth,i=[];if(a&&this.dataSource.data()[0])for(e=0;e<a;e++)i.push({autoWidth:!0});for(e=0;e<n;e++)i.push({autoWidth:!1,width:s});return i},_cells:function(e,t,r){for(var n,a,s,i,o,l=[],u=0,c=e.length;u<c;u++){for(a=[],s=e[u].children,n=s.length,i=0;i<n;i++)o=s[i],a.push({background:"#7a7a7a",color:"#fff",value:o.value,colSpan:o.attr.colSpan||1,rowSpan:o.attr.rowSpan||1});r&&r(a,u),l.push({cells:a,type:t})}return l},_rows:function(){var e,t,r=this.widget.columnsHeaderTree.children[0],n=this.widget.rowsHeaderTree.children[0],a=r.children[0].children.length,s=n.children[0].children.length,i=r.children[1].children,o=n.children[1].children,l=this.widget.contentTree.children[0].children[1].children,u=this._cells(i,"header");return s&&u[0].cells.splice(0,0,{background:"#7a7a7a",color:"#fff",value:"",colSpan:s,rowSpan:i.length}),e=function(e,t){for(var r,n,s=0,i=l[t].children;s<a;s++)r=i[s],n=+r.value,isNaN(n)&&(n=r.value),e.push({background:"#dfdfdf",color:"#333",value:n,colSpan:1,rowSpan:1})},t=this._cells(o,"data",e),u.concat(t)},_freezePane:function(){var e=this.widget.columnsHeaderTree.children[0],t=this.widget.rowsHeaderTree.children[0],r=t.children[0].children.length,n=e.children[1].children;return{colSplit:r,rowSplit:n.length}},workbook:function(){var t;return this.dataSource.view()[0]?(t=e.Deferred(),t.resolve()):t=this.dataSource.fetch(),t.then(e.proxy(function(){return{sheets:[{columns:this._columns(),rows:this._rows(),freezePane:this._freezePane(),filter:null}]}},this))}}),we={extend:function(t){t.events.push("excelExport"),t.options.excel=e.extend(t.options.excel,this.options),t.saveAsExcel=this.saveAsExcel},options:{proxyURL:"",filterable:!1,fileName:"Export.xlsx"},saveAsExcel:function(){var t=this.options.excel||{},r=new Te.PivotExcelExporter({widget:this});r.workbook().then(e.proxy(function(e){if(!this.trigger("excelExport",{workbook:e})){var r=new Te.ooxml.Workbook(e);r.toDataURLAsync().then(function(r){Te.saveAs({dataURI:r,fileName:e.fileName||t.fileName,proxyURL:t.proxyURL,forceProxy:t.forceProxy})})}},this))}},Te.PivotExcelMixin=we,Te.ooxml&&Te.ooxml.Workbook&&we.extend(de.prototype),Te.PDFMixin&&(Te.PDFMixin.extend(de.prototype),de.fn._drawPDF=function(){return this._drawPDFShadow({width:this.wrapper.width()},{avoidLinks:this.options.pdf.avoidLinks})}),Te.PDFMixin&&(Te.PDFMixin.extend(he.prototype),he.fn._drawPDF=function(){return this._drawPDFShadow({width:this.wrapper.width()},{avoidLinks:this.options.pdf.avoidLinks})})}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()});
//# sourceMappingURL=kendo.pivotgrid.min.js.map
