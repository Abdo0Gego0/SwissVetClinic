{"version":3,"sources":["kendo.imageeditor.js"],"names":["f","define","$","undefined","kendo","window","ui","extend","proxy","ToolBar","Item","toolbar","CLICK","DROPDOWNCHANGE","ACTION","ImageEditorToolBar","init","element","options","that","this","_extendOptions","fn","call","_attachEvents","toggleTools","events","concat","defaultTools","open","type","icon","name","command","showText","save","toggleCondition","separator","undo","redo","separator1","crop","resize","zoomIn","zoomOut","zoomDropdown","text","items","bind","_dropDownChange","_click","tools","Object","keys","_extendToolsOptions","messages","length","map","tool","toolOptions","isBuiltInTool","isPlainObject","deepExtend","id","guid","attributes","aria-label","title","data-command","data-options","data-toggle","overflow","ev","target","data","action","args","trigger","conditions","find","each","index","elm","widget","condition","toToggle","is","widgetInstance","enable","destroy","ImageEditorZoomDropDown","input","attr","template","dropDown","DropDownList","optionLabel","dataTextField","dataSource","change","_change","append","wrapper","list","hide","sender","dataItem","registerComponent","imageeditor","ZoomDropDown","jQuery","amd","a1","a2","a3","Class","NS","paneStyles","form","button","confirmButton","cropOverlay","resizeHandle","resizeHandlePrefix","round","Math","Pane","currentPaneTool","addClass","commonMessages","common","paneWrapper","formWidget","Form","formSettings","buttonsTemplate","format","cancel","confirm","bindButtonEvents","show","buttons","_clickHandler","on","closest","console","error","refresh","off","html","CropPane","buildCropModel","canvasUI","model","_model","toJSON","executeCommand","key","cropMessages","panes","aspectRatioItems","aspectRatioDS","push","value","formData","onChange","label","layout","grid","cols","gutter","aspectRatio","field","editor","editorOptions","dataValueField","colSpan","orientation","_orientationEditor","width","style","max","min","height","lockAspectRatio","container","_orientationWidget","appendTo","kendoButtonGroup","portrait","data-value","selected","landscape","select","set","canvas","getCanvasElement","top","left","i","handleElm","borderWidth","canvasContainer","cropElement","handle","handles","zoomLevel","getZoomLevel","_initResizeHandle","_canvasUI","parseInt","css","backgroundImage","_image","src","backgroundSize","backgroundClip","backgroundPosition","kendoDraggable","ignore","drag","_adjustTopLeft","offsetTop","y","delta","offsetLeft","x","newModel","$target","oldModel","adjustments","correctedLeft","correctedTop","indexOf","offsetWidth","offsetHeight","compare","compareModel","tempModel","newSize","force","size","maxWidth","maxHeight","originalRatio","gcd","_gcd","_calcSize","wRatio","hRatio","expectedRatio","realRatio","sizeByRatio","isPortrait","ratios","split","a","b","remove","ResizePane","buildResizeModel","originalWidth","originalHeight","measure","resizeMessages","encoded","pixels","percents","measureW","measureH","ratio","aspectRatioLocked","resetNumericsTo","_preventChange","widthNumeric","heightNumeric","isPercent","setOptions","ImageEditorPane","imageeditorNS","Command","OpenPaneImageEditorCommand","exec","pane","ZoomImageEditorCommand","zoomStep","spacing","imgHeight","currentZoom","newHeight","isNaN","_processStringValue","parseFloat","_canvas","_zoomLevel","initialZoom","expectedHeight","canvasWrapper","CropImageEditorCommand","ctx","getCurrent2dContext","croppedImage","getImageData","clearRect","putImageData","drawImage","toDataURL","done","image","drawCanvas","fail","ResizeImageEditorCommand","getCurrentImage","UndoImageEditorCommand","undoStack","pop","redoStack","RedoImageEditorCommand","SaveImageEditorCommand","saveAs","dataURI","OpenImageEditorCommand","upload","_upload","kendoUpload","onSelect","onError","multiple","validation","allowedExtensions","getKendoUpload","click","file","files","rawFile","reader","FileReader","addEventListener","result","_initUndoRedoStack","_toggleTools","readAsDataURL","ImageEditorCommand","commands","Widget","outerHeight","_outerHeight","ERROR","IMAGELOADED","IMAGERENDERED","EXECUTE","imageEditorStyles","header","contentWrapper","ImageEditor","_wrapper","_renderHeader","_contentWrapper","_keyHandler","imageUrl","_drawCanvas","notify","fileName","zoomActualSize","zoomFitToScreen","1:1","4:5","5:7","2:3","16:9","_resizeHandler","onResize","_initToolbar","toolbarElement","toolbarOptions","toolbarHeight","prevent","ctrlKey","keyCode","preventDefault","canRedo","canUndo","hasImage","canExport","deferred","Deferred","Image","onload","progress","resolve","onerror","reject","arguments","promise","getContext","_ctx","commandName","commandOptions","plugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;CAwBC,SAAUA,EAAGC,QACVA,OAAO,uBACH,gBACA,sBACDD,IACL,WAqOE,MApOC,UAAUE,EAAGC,GAAb,GACOC,GAAQC,OAAOD,MAAOE,EAAKF,EAAME,GAAIC,EAASL,EAAEK,OAAQC,EAAQN,EAAEM,MAAOC,EAAUL,EAAME,GAAGG,QAASC,EAAON,EAAMO,QAAQD,KAAME,EAAQ,QAASC,EAAiB,iBAAkBC,EAAS,SAC7LC,EAAqBN,EAAQF,QAC7BS,KAAM,SAAUC,EAASC,GACrB,GAAIC,GAAOC,IACXD,GAAKE,eAAeH,GACpBT,EAAQa,GAAGN,KAAKO,KAAKJ,EAAMF,EAASC,GACpCC,EAAKK,gBACLL,EAAKM,eAETC,OAAQjB,EAAQa,GAAGI,OAAOC,QACtBd,EACAC,IAEJc,cACIC,MACIC,KAAM,SACNC,KAAM,SACNC,KAAM,OACNC,QAAS,yBACTC,SAAU,YAEdC,MACIL,KAAM,SACNC,KAAM,WACNC,KAAM,OACNC,QAAS,yBACTC,SAAU,WACVE,gBAAiB,aAErBC,WAAaP,KAAM,aACnBQ,MACIR,KAAM,SACNC,KAAM,OACNC,KAAM,OACNC,QAAS,yBACTC,SAAU,WACVE,gBAAiB,QAErBG,MACIT,KAAM,SACNC,KAAM,OACNC,KAAM,OACNC,QAAS,yBACTC,SAAU,WACVE,gBAAiB,QAErBI,YAAcV,KAAM,aACpBW,MACIX,KAAM,SACNC,KAAM,OACNC,KAAM,OACNC,QAAS,6BACTf,QAAS,OACTgB,SAAU,WACVE,gBAAiB,aAErBM,QACIZ,KAAM,SACNC,KAAM,eACNC,KAAM,SACNC,QAAS,6BACTf,QAAS,SACTgB,SAAU,WACVE,gBAAiB,aAErBO,QACIb,KAAM,SACNC,KAAM,UACNC,KAAM,SACNC,QAAS,yBACTC,SAAU,WACVhB,QAAS,SACTkB,gBAAiB,UAErBQ,SACId,KAAM,SACNC,KAAM,WACNC,KAAM,UACNC,QAAS,yBACTC,SAAU,WACVhB,QAAS,UACTkB,gBAAiB,UAErBS,cACIf,KAAM,0BACNE,KAAM,eACNC,QAAS,yBACTa,KAAM,eACNV,gBAAiB,SACjBW,QAEQf,KAAM,iBACND,KAAM,mBACNe,KAAM,mBACN5B,QAAS,eAGTc,KAAM,kBACND,KAAM,gBACNe,KAAM,gBACN5B,QAAS,kBAKzBM,cAAe,WACX,GAAIL,GAAOC,IACXD,GAAK6B,KAAKnC,EAAgBL,EAAMW,EAAK8B,gBAAiB9B,IACtDA,EAAK6B,KAAKpC,EAAOJ,EAAMW,EAAK+B,OAAQ/B,KAExCE,eAAgB,SAAUH,GACtB,GAAIC,GAAOC,KAAM+B,EAAQjC,EAAQ6B,MAAQ7B,EAAQ6B,MAAQK,OAAOC,KAAKlC,EAAKS,aAC1ET,GAAKD,QAAUA,EACfC,EAAKD,QAAQ6B,MAAQ5B,EAAKmC,oBAAoBH,IAElDG,oBAAqB,SAAUH,GAC3B,GAAIhC,GAAOC,KAAMmC,EAAWpC,EAAKD,QAAQqC,QACzC,IAAKJ,EAAMK,OAGX,MAAOL,GAAMM,IAAI,SAAUC,GACvB,GAA0FC,GAAab,EAAnGc,EAAgB1D,EAAE2D,cAAcH,IAAsC,IAA7BN,OAAOC,KAAKK,GAAMF,QAAgBE,EAAK1B,IAoBpF,OAnBA0B,GAAOE,EAAgBF,EAAK1B,KAAO0B,EACnCC,EAAczD,EAAE2D,cAAcH,GAAQA,EAAOnD,KAAWY,EAAKS,aAAa8B,IAC1EZ,EAAOS,EAASI,EAAY3B,OAAS2B,EAAYb,KACjD1C,EAAM0D,WAAWH,GACbI,GAAIJ,EAAY3B,KAAO,IAAM5B,EAAM4D,OACnChC,KAAM2B,EAAY3B,KAClBc,KAAMA,EACNmB,YACIC,aAAcpB,EACdqB,MAASrB,EACTsB,eAAgBT,EAAY1B,QAC5BoC,eAAgBV,EAAYzC,QAC5BoD,cAAeX,EAAYvB,iBAE/BmC,SAAUZ,EAAYY,WAED,4BAArBZ,EAAY7B,OACZ6B,EAAYZ,MAAQ5B,EAAKmC,oBAAoBK,EAAYZ,QAEtDY,GACRxC,IAEP+B,OAAQ,SAAUsB,GACd,GAAIvC,GAAU/B,EAAEsE,EAAGC,QAAQC,KAAK,WAAYxD,EAAUhB,EAAEsE,EAAGC,QAAQC,KAAK,UACnEzC,IAGLb,KAAKuD,QACD1C,QAASA,EACTf,QAASA,KAGjB+B,gBAAiB,SAAUuB,GAClBA,EAAGvC,SAGRb,KAAKuD,QACD1C,QAASuC,EAAGvC,QACZf,QAASsD,EAAGtD,WAGpByD,OAAQ,SAAUC,GACdxD,KAAKyD,QAAQ/D,EAAQ8D,IAEzBnD,YAAa,SAAUqD,GACnB,GAAI3D,GAAOC,KAAM+B,EAAQhC,EAAKF,QAAQ8D,KAAK,gBAC3C5B,GAAM6B,KAAK,SAAUC,EAAOC,GACxB,GAAIxB,GAAOxD,EAAEgF,GAAMC,EAAS,KAAMC,EAAY1B,EAAKgB,KAAK,UAAWW,EAAWP,GAAcA,EAAWM,EACnG1B,GAAK4B,GAAG,iBACRH,EAAS/E,EAAMmF,eAAe7B,IAE9ByB,GAAUA,EAAOK,OACjBL,EAAOK,OAAOH,IAAY,GAE1BlE,EAAKqE,OAAO9B,EAAM2B,MAI9BI,QAAS,WACL,GAAItE,GAAOC,IACPD,GAAK0B,cACL1B,EAAK0B,aAAa4C,UAEtBhF,EAAQa,GAAGmE,QAAQlE,KAAKH,SAG5BsE,EAA0BhF,EAAKH,QAC/BS,KAAM,SAAUE,EAASP,GACrB,GAAIQ,GAAOC,KAAMH,EAAUf,EAAE,eAAgByF,EAAQzF,EAAE,aAAa0F,KAAK1E,EAAQ+C,YAAa4B,EAAW,kDACzG1E,GAAKF,QAAUA,EACfE,EAAKwE,MAAQA,EACbxE,EAAKR,QAAUA,EACfQ,EAAK2E,SAAW,GAAIxF,GAAGyF,aAAa5E,EAAKwE,OACrCK,aACIlD,KAAM5B,EAAQ4B,KACdf,KAAM,IAEVkE,cAAe,OACfC,WAAYhF,EAAQ6B,MACpB8C,SAAUA,EACVM,OAAQ3F,EAAMW,EAAKiF,QAASjF,KAEhCA,EAAKF,QAAQoF,OAAOlF,EAAK2E,SAASQ,SAClCnF,EAAK2E,SAASS,KAAKxB,KAAK,uBAAuByB,OAC/CrF,EAAKR,QAAQkC,aAAe1B,GAEhCiF,QAAS,SAAU5B,GACf,GAAIrD,GAAOC,IACXD,GAAKR,QAAQkE,QAAQhE,GACjBoB,QAASuC,EAAGiC,OAAOxF,QAAQyD,KAAK,WAChCxD,QAASsD,EAAGiC,OAAOC,WAAWxF,WAGtCuE,QAAS,WACLrE,KAAK0E,SAASL,YAGtBrF,GAAMO,QAAQgG,kBAAkB,0BAA2BjB,GAC3DnF,EAAOH,EAAME,IACTsG,aACInG,QAASM,EACT8F,aAAcnB,MAGxBrF,OAAOD,MAAM0G,QACRzG,OAAOD,OACE,kBAAVH,SAAwBA,OAAO8G,IAAM9G,OAAS,SAAU+G,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAUjH,EAAGC,QACVA,OAAO,oBACH,aACA,aACA,oBACA,qBACDD,IACL,WAuhBE,MAthBC,UAAUE,EAAGC,GAAb,GACOC,GAAQC,OAAOD,MAAOG,EAASL,EAAEK,OAAQC,EAAQN,EAAEM,MAAO2G,EAAQ/G,EAAM+G,MAAOC,EAAK,sBAAuBxG,EAAQ,QACnHyG,GACAC,KAAM,0BACNC,OAAQ,4BACRC,cAAe,oCACfC,YAAa,6BACbhF,KAAM,qBACNiF,aAAc,kBACdC,mBAAoB,aAEpBC,EAAQ,SAAU5H,GAClB,MAAO6H,MAAKD,MAAU,IAAJ5H,GAAY,KAE9B8H,EAAOX,EAAM5G,QACbS,KAAM,SAAU4F,GACZ,GAAIzF,GAAOC,IACXD,GAAKyF,YAAcA,EACfzF,EAAKyF,YAAYmB,iBACjB5G,EAAKyF,YAAYmB,gBAAgBtC,UAErCtE,EAAKF,QAAUf,EAAE,eAAe8H,SAASX,EAAWC,OAExDzF,KAAM,WACF,GAAIV,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAaqB,EAAiBrB,EAAY1F,QAAQqC,SAAS2E,MAC/FtB,GAAYuB,YAAY9B,OAAOlF,EAAKF,SACpCE,EAAKiH,WAAa,GAAIhI,GAAME,GAAG+H,KAAKlH,EAAKF,QAASV,EAAOY,EAAKmH,gBAAkBC,gBAAiBnI,EAAMoI,OAAO,qUAAuVnB,EAAWE,OAAQF,EAAWG,cAAeS,EAAeQ,OAAQR,EAAeS,YACxhBvH,EAAKwH,mBACL/B,EAAYuB,YAAYS,OACxBhC,EAAYmB,gBAAkB5G,GAElCwH,iBAAkB,WACd,GAAIxH,GAAOC,KAAMgH,EAAajH,EAAKiH,WAAYS,EAAUT,EAAWnH,QAAQ8D,KAAK,IAAMsC,EAAWE,OAClGpG,GAAK2H,cAAgBtI,EAAMW,EAAK+B,OAAQ/B,GACxC0H,EAAQE,GAAGnI,EAAQwG,EAAIjG,EAAK2H,gBAEhC5F,OAAQ,SAAUsB,GACd,GAAIrD,GAAOC,KAAMqD,EAASvE,EAAEsE,EAAGC,QAAQuE,QAAQ,IAAM3B,EAAWE,QAAS5C,EAASF,EAAOC,KAAK,SAC1FvD,GAAKwD,IACLxD,EAAKwD,MAGb8D,OAAQ,WACJrH,KAAKqE,WAETiD,QAAS,WACLrI,OAAO4I,QAAQC,MAAM,6CACrB9H,KAAKqE,WAET0D,QAAS,aAET1D,QAAS,WACL,GAAItE,GAAOC,KAAMwF,EAAczF,EAAKyF,WACpCzF,GAAKiH,WAAWnH,QAAQ8D,KAAK,IAAMsC,EAAWE,QAAQ6B,IAAIhC,GAC1DjG,EAAKiH,WAAW3C,UAChBmB,EAAYuB,YAAYkB,KAAK,IAC7BzC,EAAYuB,YAAY3B,aACjBI,GAAYmB,mBAGvBuB,EAAWxB,EAAKvH,QAChBS,KAAM,SAAU4F,GACZ,GAAIzF,GAAOC,IACX0G,GAAKxG,GAAGN,KAAKO,KAAKJ,EAAMyF,GACxBzF,EAAKoI,iBACLpI,EAAKqI,YAETd,QAAS,WACL,GAAIvH,GAAOC,KAAMqI,EAAQtI,EAAKiH,WAAWsB,OAAOC,QAChDxI,GAAKsE,UACLtE,EAAKyF,YAAYgD,gBACb3H,QAAS,yBACTf,QAASuI,KAGjBnB,aAAc,WAAA,GAGGuB,GAFT1I,EAAOC,KAAM0I,EAAe3I,EAAKyF,YAAY1F,QAAQqC,SAASwG,MAAMtH,KAAMwF,EAAiB9G,EAAKyF,YAAY1F,QAAQqC,SAAS2E,OAAQ8B,EAAmBF,EAAaE,iBAAkBC,IAC3L,IAAID,EACA,IAASH,IAAOG,GACZC,EAAcC,MACVC,MAAON,EACP/G,KAAMkH,EAAiBH,SAI/BI,KAEQE,MAAO,gBACPrH,KAAM,mBAGNqH,MAAO,MACPrH,KAAM,iBAGNqH,MAAO,MACPrH,KAAM,eAGNqH,MAAO,MACPrH,KAAM,QAGNqH,MAAO,MACPrH,KAAM,cAGNqH,MAAO,OACPrH,KAAM,QAIlB,QACIsH,SAAUjJ,EAAKuI,OACfvD,OAAQ3F,EAAMW,EAAKkJ,SAAUlJ,GAC7B4B,QACQjB,KAAM,QACNwI,MAAOR,EAAa3F,OAAS,aAC7BoG,OAAQ,OACRC,MACIC,KAAM,EACNC,OAAQ,SAEZ3H,QAEQuH,MAAOR,EAAaa,aAAe,gBACnCC,MAAO,cACPC,OAAQ,eACRC,eACIC,eAAgB,QAChB9E,cAAe,OACfC,WAAY+D,GAEhBe,QAAS,IAGTV,MAAOR,EAAamB,YACpBL,MAAO,cACPC,OAAQ3K,EAAEM,MAAMW,EAAK+J,mBAAoB/J,GACzC6J,QAAS,IAGTV,MAAOrC,EAAekD,OAAS,SAC/BP,MAAO,QACP3G,YAAcmH,MAAO,qBACrBP,OAAQ,iBACRC,eACItC,OAAQ,KACR6C,IAAKlK,EAAKuI,OAAOyB,MACjBG,IAAK,GAETN,QAAS,IAGTV,MAAOrC,EAAesD,QAAU,UAChCX,MAAO,SACP3G,YAAcmH,MAAO,qBACrBP,OAAQ,iBACRC,eACItC,OAAQ,KACR6C,IAAKlK,EAAKuI,OAAO6B,OACjBD,IAAK,GAETN,QAAS,IAGTV,MAAOrC,EAAeuD,iBAAmB,oBACzCZ,MAAO,kBACPI,QAAS,QAMjCE,mBAAoB,SAAUO,EAAWvK,GACrC,GAAIC,GAAOC,KAAM0I,EAAe3I,EAAKyF,YAAY1F,QAAQqC,SAASwG,MAAMtH,KAAM0H,EAAQjJ,EAAQuI,MAAMvI,EAAQ0J,MAC5GzJ,GAAKuK,mBAAqBxL,EAAE,cAAiBgB,EAAQ0J,MAAQ,YAAae,SAASF,GAAWG,kBAC1F7I,QAEQD,KAAMgH,EAAa+B,UAAY,WAC/B5H,YAAc6H,aAAc,YAC5BC,SAAoB,aAAV5B,IAGVrH,KAAMgH,EAAakC,WAAa,YAChC/H,YAAc6H,aAAc,aAC5BC,SAAoB,cAAV5B,IAGlB8B,OAAQ,SAAUzH,GACd,GAAI2F,GAAQ3F,EAAGiC,OAAOH,QAAQvB,KAAK,eAAeL,KAAK,QACvDxD,GAAQuI,MAAMyC,IAAIhL,EAAQ0J,MAAOT,MAEtCzF,KAAK,qBAEZ6E,eAAgB,WACZ,GAAIpI,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBjB,EAAQgB,EAAOhB,MAAOI,EAASY,EAAOZ,MAChIpK,GAAKuI,QACD2C,IAAK,EACLC,KAAM,EACN3B,YAAa,gBACbQ,MAAOA,EACPI,OAAQA,EACRN,YAAaE,EAAQI,EAAS,EAAI,WAAa,YAC/CC,iBAAiB,IAGzBhC,SAAU,WAAA,GAWG+C,GACDC,EAMJrB,EACAI,EACAkB,EAnBAtL,EAAOC,KAAMwF,EAAczF,EAAKyF,YAAa8F,EAAkBvL,EAAKyF,YAAY8F,gBAAiBjF,EAAcvH,EAAE,eAAe8H,SAASX,EAAWI,aAAckF,EAAczM,EAAE,eAAe8H,SAASX,EAAW5E,MAAOmK,EAAS,gBAAmBvF,EAAWK,aAAe,YAAcmF,GAC5R,KACA,IACA,KACA,IACA,IACA,KACA,IACA,MACDC,EAAYlG,EAAYmG,cAC/B,KAASR,EAAI,EAAGA,EAAIM,EAAQrJ,OAAQ+I,IAC5BC,EAAYtM,EAAE0M,GAAQ5E,SAASX,EAAWM,mBAAqBkF,EAAQN,IAAI3G,KAAK,mBAAoBiH,EAAQN,IAChHpL,EAAK6L,kBAAkBR,GACvBG,EAAYtG,OAAOmG,EAEvBrL,GAAKwL,YAAcA,EACnBxL,EAAK8L,UAAYxF,EAAYpB,OAAOsG,GAAahB,SAASe,GACtDvB,EAAQtD,KAAKD,MAAMzG,EAAKuI,OAAOyB,MAAQ2B,GACvCvB,EAAS1D,KAAKD,MAAMzG,EAAKuI,OAAO6B,OAASuB,GACzCL,EAAcS,SAAS/L,EAAKwL,YAAYQ,IAAI,oBAAqB,IACrEhM,EAAKwL,YAAYQ,KACbhC,MAAOA,EACPI,OAAQA,EACR6B,gBAAiB,QAAWxG,EAAYyG,OAAOC,IAAM,KACrDC,eAAgBnN,EAAMoI,OAAO,cAAe2C,EAAOI,GACnDiC,eAAgB,cAChBC,mBAAoBrN,EAAMoI,OAAO,gBAAiBiE,KAEtDtL,EAAKwL,YAAYe,gBACbC,OAAQ,IAAMtG,EAAWK,aACzBkG,KAAM,SAAUpJ,GACZrD,EAAK0M,eAAerJ,EAAGC,OAAOqJ,UAAYtJ,EAAGuJ,EAAEC,MAAOxJ,EAAGC,OAAOwJ,WAAazJ,EAAG0J,EAAEF,WAI9F7E,QAAS,WACL,GAAIhI,GAAOC,KAAM+M,EAAWhN,EAAKiH,WAAWsB,OAAQoD,EAAY3L,EAAKyF,YAAYmG,eAAgB5B,EAAQtD,KAAKD,MAAMuG,EAAShD,MAAQ2B,GAAYvB,EAAS1D,KAAKD,MAAMuG,EAAS5C,OAASuB,GAAYT,EAAMxE,KAAKD,MAAMuG,EAAS9B,IAAMS,GAAYR,EAAOzE,KAAKD,MAAMuG,EAAS7B,KAAOQ,GAAYL,EAAcS,SAAS/L,EAAKwL,YAAYQ,IAAI,oBAAqB,GAC9VhM,GAAKwL,YAAYQ,KACbd,IAAKA,EACLC,KAAMA,EACNnB,MAAOA,EACPI,OAAQA,EACRgC,eAAgBnN,EAAMoI,OAAO,cAAerH,EAAKuI,OAAOyB,MAAQ2B,EAAW3L,EAAKuI,OAAO6B,OAASuB,GAChGW,mBAAoBrN,EAAMoI,OAAO,gBAAiB8D,EAAOG,EAAaJ,EAAMI,MAGpFO,kBAAmB,SAAUJ,GACzB,GAAIzL,GAAOC,IACXwL,GAAOc,gBACHE,KAAM,SAAUpJ,GACZ,GAAI4J,GAAUlO,EAAEsE,EAAGiC,OAAOxF,SAAUkN,EAAWhN,EAAKiH,WAAWsB,OAAQ2E,EAAWlN,EAAKuI,OAAQuB,EAAcmD,EAAQ1J,KAAK,eAAgB4J,KAAkBxB,EAAY3L,EAAKyF,YAAYmG,eAAgBwB,EAAgBJ,EAAS7B,KAAOQ,EAAW0B,EAAeL,EAAS9B,IAAMS,CAC9Q7B,GAAYwD,QAAQ,MAAQ,GAC5BH,EAAYhC,KAAOnL,EAAKwL,YAAY,GAAGsB,WAAazJ,EAAG0J,EAAEF,MACzDM,EAAYnD,MAAQhK,EAAKwL,YAAY,GAAG+B,YAAclK,EAAG0J,EAAEF,OACpD/C,EAAYwD,QAAQ,MAAQ,IACnCH,EAAYnD,MAAQhK,EAAKwL,YAAY,GAAG+B,YAAclK,EAAG0J,EAAEF,OAE3D/C,EAAYwD,QAAQ,MAAQ,GAC5BH,EAAYjC,IAAMlL,EAAKwL,YAAY,GAAGmB,UAAYtJ,EAAGuJ,EAAEC,MACvDM,EAAY/C,OAASpK,EAAKwL,YAAY,GAAGgC,aAAenK,EAAGuJ,EAAEC,OACtD/C,EAAYwD,QAAQ,MAAQ,IACnCH,EAAY/C,OAASpK,EAAKwL,YAAY,GAAGgC,aAAenK,EAAGuJ,EAAEC,OAE7DM,EAAYnD,QAAUmD,EAAYhC,MAAQiC,GAAiBD,EAAYnD,OAASkD,EAASlD,MAAQ2B,GACjGqB,EAASjC,IAAI,QAASrE,KAAKD,MAAM0G,EAAYnD,MAAQ2B,IAErDwB,EAAY/C,SAAW+C,EAAYjC,KAAOmC,GAAgBF,EAAY/C,QAAU8C,EAAS9C,OAASuB,GAClGqB,EAASjC,IAAI,SAAUrE,KAAKD,MAAM0G,EAAY/C,OAASuB,KAEvDwB,EAAYjC,KAAOiC,EAAYhC,OAC/BnL,EAAK0M,eAAeS,EAAYjC,IAAKiC,EAAYhC,UAKjEuB,eAAgB,SAAUxB,EAAKC,EAAMsC,GACjC,GAAIzN,GAAOC,KAAMyN,EAAeD,GAAWzN,EAAKiH,WAAWsB,OAAQyE,EAAWhN,EAAKiH,WAAWsB,OAAQ2E,EAAWlN,EAAKuI,OAAQoD,EAAY3L,EAAKyF,YAAYmG,cACvJV,IAAO,GAAKA,EAAMS,EAAY+B,EAAatD,QAAU8C,EAAS9C,QAC9D4C,EAASjC,IAAI,MAAOrE,KAAKD,MAAMyE,EAAMS,IAErCR,GAAQ,GAAKA,EAAOQ,EAAY+B,EAAa1D,OAASkD,EAASlD,OAC/DgD,EAASjC,IAAI,OAAQrE,KAAKD,MAAM0E,EAAOQ,KAG/CzC,SAAU,SAAU7F,GAAV,GAUEsK,GAIAC,EAKAC,EACAC,EAIJ9D,EACAI,EACAc,EACAC,EACAG,EA3BAtL,EAAOC,KAAM0L,EAAY3L,EAAKyF,YAAYmG,eAAgBoB,EAAW3J,EAAGiC,OAAOiD,OAAQ2E,EAAWlN,EAAKuI,OAAQwF,EAAWb,EAASlD,MAAOgE,EAAYd,EAAS9C,OAAQ6D,EAAgBf,EAASlD,MAAQ,IAAMkD,EAAS9C,OAAQ8D,EAAMlO,EAAKmO,KAAKjB,EAASlD,MAAOkD,EAAS9C,OAC5Q6D,GAAgBf,EAASlD,MAAQkE,EAAM,IAAMhB,EAAS9C,OAAS8D,EAC9C,gBAAb7K,EAAGoG,OAAwC,kBAAbpG,EAAG2F,OACjCgE,EAASjC,IAAI,MAAO,GACpBiC,EAASjC,IAAI,OAAQ,GACrBiC,EAASjC,IAAI,cAAemC,EAASpD,aACrCkD,EAASjC,IAAI,QAASmC,EAASlD,OAC/BgD,EAASjC,IAAI,SAAUmC,EAAS9C,SACZ,gBAAb/G,EAAGoG,OACNkE,EAAYvO,KAAW4N,GACvBhD,MAAOgD,EAAS5C,OAChBA,OAAQ4C,EAAShD,QAEjB4D,EAAU5N,EAAKoO,UAAUT,EAAWM,EAAeF,EAAUC,GACjEhB,EAASjC,IAAI,QAAS6C,EAAQ5D,OAC9BgD,EAASjC,IAAI,SAAU6C,EAAQxD,QAC/BpK,EAAKuK,mBAAmBO,OAAoB,aAAbzH,EAAG2F,MAAuB,EAAI,IACtDgE,EAAS3C,kBACZwD,EAAQxK,EAAGoG,MACXqE,EAAO9N,EAAKoO,UAAUpB,EAAUiB,EAAeF,EAAUC,EAAWH,GACxEb,EAASjC,IAAI,QAAS+C,EAAK9D,OAC3BgD,EAASjC,IAAI,SAAU+C,EAAK1D,SAE5BJ,EAAQtD,KAAKD,MAAMuG,EAAShD,MAAQ2B,GACpCvB,EAAS1D,KAAKD,MAAMuG,EAAS5C,OAASuB,GACtCT,EAAMxE,KAAKD,MAAMuG,EAAS9B,IAAMS,GAChCR,EAAOzE,KAAKD,MAAMuG,EAAS7B,KAAOQ,GAClCL,EAAcS,SAAS/L,EAAKwL,YAAYQ,IAAI,oBAAqB,IACrEhM,EAAKwL,YAAYQ,KACbd,IAAKA,EACLC,KAAMA,EACNnB,MAAOA,EACPI,OAAQA,EACRkC,mBAAoBrN,EAAMoI,OAAO,gBAAiB8D,EAAOG,EAAaJ,EAAMI,MAGpF8C,UAAW,SAAU9F,EAAO2F,EAAeF,EAAUC,EAAWH,GAArD,GAQHQ,GACAC,EACAC,EACAC,EACAC,EAXAzE,EAAQtD,KAAKyD,IAAI7B,EAAM0B,MAAO+D,GAAW3D,EAAS1D,KAAKyD,IAAI7B,EAAM8B,OAAQ4D,GAAYU,EAAmC,aAAtBpG,EAAMwB,YAA4B6E,EAASrG,EAAMkB,WAevJ,OAdImF,GAAOrB,QAAQ,KAAO,IACtBqB,EAASV,GAEbU,EAASA,EAAOC,MAAM,KAAKtM,IAAI,SAAU0G,GACrC,MAAO+C,UAAS/C,EAAO,MAEvBqF,EAASK,EAAahI,KAAKyD,IAAIwE,EAAO,GAAIA,EAAO,IAAMjI,KAAKwD,IAAIyE,EAAO,GAAIA,EAAO,IAClFL,EAAUI,EAA8ChI,KAAKwD,IAAIyE,EAAO,GAAIA,EAAO,IAA5DjI,KAAKyD,IAAIwE,EAAO,GAAIA,EAAO,IAClDJ,EAAgB9H,EAAM4H,EAASC,GAC/BE,EAAY/H,EAAMuD,EAAQI,GAC1BqE,GACAzE,MAAOtD,KAAKD,MAAM2D,EAASmE,GAC3BnE,OAAQ1D,KAAKD,MAAMuD,EAAQuE,IAEjB,UAAVV,GAEI7D,MAAOA,EACPI,OAAQqE,EAAYrE,QAGd,WAAVyD,GAEI7D,MAAOyE,EAAYzE,MACnBI,OAAQA,IAGZoE,EAAYD,EACZvE,EAAQyE,EAAYzE,MACbwE,EAAYD,IACnBnE,EAASqE,EAAYrE,SAGrBJ,MAAOA,EACPI,OAAQA,KAGhB+D,KAAM,SAAUU,EAAGC,GACf,MAAa,KAANA,EAAUD,EAAI5O,KAAKkO,KAAKW,EAAGD,EAAIC,IAE1CxK,QAAS,WACLrF,EAAMqF,QAAQrE,KAAK6L,WACnB7L,KAAK6L,UAAUiD,SACfpI,EAAKxG,GAAGmE,QAAQlE,KAAKH,SAGzB+O,EAAarI,EAAKvH,QAClBS,KAAM,SAAU4F,GACZkB,EAAKxG,GAAGN,KAAKO,KAAKH,KAAMwF,GACxBxF,KAAKgP,oBAET1H,QAAS,WACL,GAAIvH,GAAOC,KAAMiP,EAAgBlP,EAAKuI,OAAOyB,MAAOmF,EAAiBnP,EAAKuI,OAAO6B,OAAQ9B,EAAQtI,EAAKiH,WAAWsB,OAAOC,QAClG,cAAlBF,EAAM8G,UACN9G,EAAM0B,MAAQkF,GAAiB5G,EAAM0B,MAAQ,KAC7C1B,EAAM8B,OAAS+E,GAAkB7G,EAAM8B,OAAS,MAEpDpK,EAAKyF,YAAYgD,gBACb3H,QAAS,2BACTf,QAASuI,IAEbtI,EAAKsE,WAET6C,aAAc,WACV,GAAInH,GAAOC,KAAMoP,EAAiBrP,EAAKyF,YAAY1F,QAAQqC,SAASwG,MAAMrH,OAAQuF,EAAiB9G,EAAKyF,YAAY1F,QAAQqC,SAAS2E,MACrI,QACIkC,SAAUjJ,EAAKuI,OACfvD,OAAQ3F,EAAMW,EAAKkJ,SAAUlJ,GAC7B4B,QACQjB,KAAM,QACNwI,MAAOkG,EAAerM,OAAS,eAC/BoG,OAAQ,OACRC,MACIC,KAAM,EACNC,OAAQ,SAEZ3H,QAEQuH,MAAOrC,EAAekD,OAAS,SAC/BP,MAAO,QACP3G,YAAcmH,MAAO,qBACrBP,OAAQ,iBACRC,eACItC,OAAQ,KACR8C,IAAK,GAETN,QAAS,IAGTJ,MAAO,WACPC,OAAQ,eACR5G,YAAcmH,MAAO,qBACrBd,OACIxH,KAAM,SACN2N,SAAS,GAEb3F,eACI7E,cAAe,OACf8E,eAAgB,QAChB7E,aAEQpD,KAAM0N,EAAeE,QAAU,SAC/BvG,MAAO,WAGPrH,KAAM0N,EAAeG,UAAY,WACjCxG,MAAO,cAInBa,QAAS,IAGTV,MAAOrC,EAAesD,QAAU,UAChCX,MAAO,SACP3G,YAAcmH,MAAO,qBACrBP,OAAQ,iBACRC,eACItC,OAAQ,KACR8C,IAAK,GAETN,QAAS,IAGTJ,MAAO,WACPN,OACIxH,KAAM,SACN2N,SAAS,GAEbxM,YAAcmH,MAAO,qBACrBP,OAAQ,eACRC,eACI7E,cAAe,OACf8E,eAAgB,QAChB7E,aAEQpD,KAAM0N,EAAeE,QAAU,SAC/BvG,MAAO,WAGPrH,KAAM0N,EAAeG,UAAY,WACjCxG,MAAO,cAInBa,QAAS,IAGTV,MAAOrC,EAAeuD,iBAAmB,oBACzCZ,MAAO,kBACPI,QAAS,QAMjCoF,iBAAkB,WACd,GAAIjP,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBjB,EAAQgB,EAAOhB,MAAOI,EAASY,EAAOZ,MAChIpK,GAAKuI,QACDyB,MAAOA,EACPI,OAAQA,EACRgF,QAAS,SACTK,SAAU,SACVC,SAAU,SACVrF,iBAAiB,EACjBsF,MAAOlJ,EAAMuD,EAAQI,KAG7BlB,SAAU,SAAU7F,GAChB,GAAIrD,GAAOC,KAAM+M,EAAW3J,EAAGiC,OAAOiD,OAAQqH,EAAoB5C,EAAS3C,eAC1D,cAAbhH,EAAGoG,OAAqC,aAAbpG,EAAGoG,OAC9BuD,EAASjC,IAAI,WAAY1H,EAAG2F,OAC5BgE,EAASjC,IAAI,WAAY1H,EAAG2F,OAC5BgE,EAASjC,IAAI,UAAW1H,EAAG2F,QACP,YAAb3F,EAAGoG,MACVzJ,EAAK6P,gBAAgBxM,EAAG2F,OACJ,UAAb3F,EAAGoG,OAAqBmG,IAAsB5P,EAAK8P,eAC1D9C,EAASjC,IAAI,SAAUiC,EAAShD,MAAQgD,EAAS2C,OAC7B,WAAbtM,EAAGoG,OAAsBmG,IAAsB5P,EAAK8P,gBAC3D9C,EAASjC,IAAI,QAASiC,EAAS5C,OAAS4C,EAAS2C,OAErD3C,EAASjC,IAAI,QAAStE,EAAMuG,EAAShD,MAAQgD,EAAS5C,UAE1DyF,gBAAiB,SAAUlP,GACvB,GAAIX,GAAOC,KAAMiP,EAAgBlP,EAAKuI,OAAOyB,MAAOmF,EAAiBnP,EAAKuI,OAAO6B,OAAQnD,EAAajH,EAAKiH,WAAYqB,EAAQrB,EAAWsB,OAAQwH,EAAe9I,EAAWnH,QAAQ8D,KAAK,gBAAgBL,KAAK,uBAAwByM,EAAgB/I,EAAWnH,QAAQ8D,KAAK,iBAAiBL,KAAK,uBAAwB0M,EAAqB,aAATtP,EAAqBZ,GACrVyP,UAAYnI,OAAQ,QACpBkI,QAAUlI,OAAQ,MAE1B0I,GAAaG,WAAWnQ,EAAQY,IAChCqP,EAAcE,WAAWnQ,EAAQY,IACjCX,EAAK8P,gBAAiB,EACtBxH,EAAMyC,IAAI,QAASkF,EAAYf,EAAgBa,EAAa/G,QAAU,IAAMkG,GAAiBa,EAAa/G,QAAU,MACpHV,EAAMyC,IAAI,SAAUkF,EAAYd,EAAiBa,EAAchH,QAAU,IAAMmG,GAAkBa,EAAchH,QAAU,MACzHhJ,EAAK8P,gBAAiB,IAG9B1Q,GAAOH,EAAME,GAAGsG,aACZ0K,gBAAiBxJ,EACjBiC,OACItH,KAAM6G,EACN5G,OAAQyN,MAGlB9P,OAAOD,MAAM0G,QACRzG,OAAOD,OACE,kBAAVH,SAAwBA,OAAO8G,IAAM9G,OAAS,SAAU+G,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAUjH,EAAGC,QACVA,OAAO,wBACH,mBACA,gBACDD,IACL,WAiME,MAhMC,UAAUE,EAAGC,GAAb,GACOC,GAAQC,OAAOD,MAAOmR,EAAgBnR,EAAME,GAAGsG,YAAarG,EAASL,EAAEK,OAAQC,EAAQN,EAAEM,MAAO2G,EAAQ/G,EAAM+G,MAC9GqK,EAAUrK,EAAM5G,QAChBS,KAAM,SAAUE,GACZE,KAAKF,QAAUX,KAAWW,EAASE,KAAKF,SACxCE,KAAKwF,YAAc1F,EAAQ0F,eAG/B6K,EAA6BD,EAAQjR,QACrCS,KAAM,SAAUE,GACZsQ,EAAQlQ,GAAGN,KAAKO,KAAKH,KAAMF,IAE/BwQ,KAAM,WACF,GAAIvQ,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAa+K,EAAO,GAAIJ,GAAcxH,MAAM5I,EAAKD,QAAQiJ,OAAOvD,EACpG+K,GAAK9P,UAGT+P,EAAyBJ,EAAQjR,QACjCW,SACI2Q,SAAU,IACVC,QAAS,IAEb9Q,KAAM,SAAUE,GACZsQ,EAAQlQ,GAAGN,KAAKO,KAAKH,KAAMF,IAE/BwQ,KAAM,WACF,GAAIvQ,GAAOC,KAAMF,EAAUC,EAAKD,QAASiJ,EAAQjJ,EAAQiJ,MAAOvD,EAAczF,EAAKyF,YAAamL,EAAYnL,EAAYyG,OAAO9B,OAAQyG,EAAcpL,EAAYmG,eAAgBkF,EAAYF,CACxLG,OAAM/H,GAEiB,gBAAVA,KACdA,EAAQhJ,EAAKgR,oBAAoBhI,EAAO6H,IAFxC7H,EAAQiI,WAAWjI,GAIvB8H,EAAYpK,KAAKD,MAAMmK,EAAY5H,GAC/B8H,EAAY,IACZ/R,EAAE0G,EAAYyL,SAASlF,IAAI,SAAU8E,GACrCrL,EAAY0L,WAAanI,GAEzBvD,EAAYmB,iBACZnB,EAAYmB,gBAAgBoB,WAGpCgJ,oBAAqB,SAAUhI,EAAOoI,GAClC,GAAIpR,GAAOC,KAAMF,EAAUC,EAAKD,QAAS0F,EAAczF,EAAKyF,YAAamL,EAAYnL,EAAYyG,OAAO9B,OAAQiH,EAAiB5L,EAAY6L,cAAclH,SAAWrK,EAAQ4Q,QAASD,EAAW3Q,EAAQ2Q,QAC1M,QAAQ1H,GACR,IAAK,SACD,MAAOoI,GAAcV,CACzB,KAAK,UACD,MAAOU,GAAcV,CACzB,KAAK,cACD,MAAOhK,MAAKD,MAAM4K,EAAiBT,EAAY,KAAO,GAC1D,SACI,MAAO,OAIfW,EAAyBlB,EAAQjR,QACjCS,KAAM,SAAUE,GACZsQ,EAAQlQ,GAAGN,KAAKO,KAAKH,KAAMF,IAE/BwQ,KAAM,WACF,GAAIvQ,GAAOC,KAAMF,EAAUC,EAAKD,QAAS0F,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBuG,EAAM/L,EAAYgM,sBAAuBC,EAAeF,EAAIG,aAAa5R,EAAQoL,KAAMpL,EAAQmL,IAAKnL,EAAQiK,MAAOjK,EAAQqK,OAC7OoH,GAAII,UAAU,EAAG,EAAG5G,EAAOhB,MAAOgB,EAAOZ,QACzCY,EAAOhB,MAAQjK,EAAQiK,MACvBgB,EAAOZ,OAASrK,EAAQqK,OACxBoH,EAAIK,aAAaH,EAAc,EAAG,GAClCjM,EAAYqM,UAAU9G,EAAO+G,aAAaC,KAAK,SAAUC,GACrDxM,EAAYyM,WAAWD,KACxBE,KAAK,SAAU9O,GACdoC,EAAY/B,QAAQ,QAASL,QAIrC+O,EAA2B/B,EAAQjR,QACnCS,KAAM,SAAUE,GACZsQ,EAAQlQ,GAAGN,KAAKO,KAAKH,KAAMF,IAE/BwQ,KAAM,WACF,GAAIvQ,GAAOC,KAAMF,EAAUC,EAAKD,QAAS0F,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBuG,EAAM/L,EAAYgM,sBAAuBQ,EAAQxM,EAAY4M,iBAC/Kb,GAAII,UAAU,EAAG,EAAG5G,EAAOhB,MAAOgB,EAAOZ,QACzCY,EAAOhB,MAAQjK,EAAQiK,MACvBgB,EAAOZ,OAASrK,EAAQqK,OACxBoH,EAAIM,UAAUG,EAAO,EAAG,EAAGlS,EAAQiK,MAAOjK,EAAQqK,QAClD3E,EAAYqM,UAAU9G,EAAO+G,aAAaC,KAAK,SAAUC,GACrDxM,EAAYyM,WAAWD,KACxBE,KAAK,SAAU9O,GACdoC,EAAY/B,QAAQ,QAASL,QAIrCiP,EAAyBjC,EAAQjR,QACjCmR,KAAM,WACF,GAAIvQ,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBuG,EAAM/L,EAAYgM,sBAAuBQ,EAAQxM,EAAY8M,UAAUC,KAC7JP,KACAxM,EAAYgN,UAAU1J,KAAKtD,EAAY4M,yBAChC5M,GAAYyG,OACnBsF,EAAII,UAAU,EAAG,EAAG5G,EAAOhB,MAAOgB,EAAOZ,QACzCY,EAAOhB,MAAQiI,EAAMjI,MACrBgB,EAAOZ,OAAS6H,EAAM7H,OACtBoH,EAAIM,UAAUG,EAAO,EAAG,EAAGA,EAAMjI,MAAOiI,EAAM7H,QAC9C3E,EAAYqM,UAAU9G,EAAO+G,aAAaC,KAAK,SAAUC,GACrDxM,EAAYyM,WAAWD,KACxBE,KAAK,SAAU9O,GACdoC,EAAY/B,QAAQ,QAASL,SAKzCqP,EAAyBrC,EAAQjR,QACjCmR,KAAM,WACF,GAAIvQ,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,mBAAoBuG,EAAM/L,EAAYgM,sBAAuBQ,EAAQxM,EAAYgN,UAAUD,KAC7JP,KACAxM,EAAY8M,UAAUxJ,KAAKtD,EAAY4M,yBAChC5M,GAAYyG,OACnBsF,EAAII,UAAU,EAAG,EAAG5G,EAAOhB,MAAOgB,EAAOZ,QACzCY,EAAOhB,MAAQiI,EAAMjI,MACrBgB,EAAOZ,OAAS6H,EAAM7H,OACtBoH,EAAIM,UAAUG,EAAO,EAAG,EAAGA,EAAMjI,MAAOiI,EAAM7H,QAC9C3E,EAAYqM,UAAU9G,EAAO+G,aAAaC,KAAK,SAAUC,GACrDxM,EAAYyM,WAAWD,KACxBE,KAAK,SAAU9O,GACdoC,EAAY/B,QAAQ,QAASL,SAKzCsP,EAAyBtC,EAAQjR,QACjCmR,KAAM,WACF,GAAIvQ,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAauF,EAASvF,EAAYwF,kBACtEhM,GAAM2T,OAAOxT,KAAWqG,EAAY1F,QAAQ6S,QAAUC,QAAS7H,EAAO+G,kBAG1Ee,EAAyBzC,EAAQjR,QACjCmR,KAAM,WAAA,GAGM/L,GAFJxE,EAAOC,KAAMwF,EAAczF,EAAKyF,YAAasN,EAAStN,EAAYuN,OACjED,KACGvO,EAAQzF,EAAE,yBACdyF,EAAMyO,aACFnI,OAAQzL,EAAMW,EAAKkT,SAAUlT,GAC7B+H,MAAO1I,EAAMW,EAAKmT,QAASnT,GAC3BoT,UAAU,EACVC,YACIC,mBACI,OACA,QACA,OACA,OACA,OACA,QACA,YAIZ7N,EAAYuN,QAAUD,EAASvO,EAAM+O,kBAEzCR,EAAOjT,QAAQ0T,SAEnBN,SAAU,SAAU7P,GAChB,GAAIrD,GAAOC,KAAMwF,EAAczF,EAAKyF,YAAagO,EAAOpQ,EAAGqQ,MAAM,GAAGC,QAASC,EAAS,GAAIC,WAC1FD,GAAOE,iBAAiB,OAAQ,WAC5BrO,EAAYqM,UAAU8B,EAAOG,QAAQ/B,KAAK,SAAUC,GAC3CxM,EAAY/B,QAAQ,eAAiBuO,MAAOA,MAC7CxM,EAAYyM,WAAWD,GACvBxM,EAAYuO,qBACZvO,EAAYwO,kBAEjB9B,KAAK,SAAU9O,GACdoC,EAAY/B,QAAQ,QAASL,OAElC,GACCoQ,GACAG,EAAOM,cAAcT,IAG7BN,QAAS,SAAU9P,GACf,GAAIrD,GAAOC,KAAMwF,EAAczF,EAAKyF,WACpCA,GAAY/B,QAAQ,QAASL,KAGrCjE,GAAOH,EAAME,GAAGsG,aACZ0O,mBAAoB9D,EACpB+D,UACI9D,2BAA4BA,EAC5BG,uBAAwBA,EACxBc,uBAAwBA,EACxBa,yBAA0BA,EAC1BE,uBAAwBA,EACxBI,uBAAwBA,EACxBC,uBAAwBA,EACxBG,uBAAwBA,MAGlC5T,OAAOD,MAAM0G,QACRzG,OAAOD,OACE,kBAAVH,SAAwBA,OAAO8G,IAAM9G,OAAS,SAAU+G,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAUjH,EAAGC,QACVA,OAAO,qBACH,sBACA,wBACDD,IACL,WA+RE,MAxRC,UAAUE,EAAGC,GAAb,GACOC,GAAQC,OAAOD,MAAOG,EAASL,EAAEK,OAAQsD,EAAgB3D,EAAE2D,cAAe2R,EAASpV,EAAME,GAAGkV,OAAQlV,EAAKF,EAAME,GAAI8G,EAAK,oBAAqBqO,EAAcrV,EAAMsV,aAAcC,EAAQ,QAASC,EAAc,cAAeC,EAAgB,gBAAiBC,EAAU,UACxQC,GACAzP,QAAS,yBACT0P,OAAQ,uBACRrV,QAAS,wBACTwH,YAAa,4BACb8N,eAAgB,wBAChBxD,cAAe,iCACf/F,gBAAiB,wBAEjBwJ,EAAcV,EAAOjV,QACrBS,KAAM,SAAUC,EAASC,GACrB,GAAIC,GAAOC,IACXoU,GAAOlU,GAAGN,KAAKO,KAAKJ,EAAMF,EAASC,GACnCA,EAAUhB,EAAEK,QAAO,KAAUW,GAC7BC,EAAKgV,WACLhV,EAAKiV,gBACLjV,EAAKkV,kBACLlV,EAAKmV,cACDpV,EAAQqV,UACRpV,EAAKqV,cAETrV,EAAKgU,qBACLhU,EAAKiU,eACLhV,EAAMqW,OAAOtV,IAEjBD,SACIc,KAAM,cACNmJ,MAAO,OACPI,OAAQ,IACRgL,SAAU,GACV5V,WACAoT,QAAU2C,SAAU,aACpBnT,UACI5C,SACIkB,KAAM,aACNM,KAAM,aACNG,KAAM,OACNC,KAAM,OACNE,KAAM,OACNC,OAAQ,SACRC,OAAQ,UACRC,QAAS,WACTC,aAAc,eACd8T,eAAgB,mBAChBC,gBAAiB,iBAErB7M,OACItH,MACI0B,MAAO,aACPwG,YAAa,gBACbX,kBACIoF,cAAiB,iBACjByH,MAAO,eACPC,MAAO,aACPC,MAAO,MACPC,MAAO,YACPC,OAAQ,QAEZhM,YAAa,eACbY,SAAU,WACVG,UAAW,aAEftJ,QACIyB,MAAO,eACPuM,OAAQ,SACRC,SAAU,aAGlBzI,QACIiD,MAAO,SACPI,OAAQ,UACR9C,OAAQ,SACRC,QAAS,UACT8C,gBAAiB,uBAI7B9J,QACIiU,EACAC,EACAC,EACAC,GAEJK,SAAU,WACN,GAAIhV,GAAOC,KAAMF,EAAUC,EAAKD,QAASiK,EAAQjK,EAAQiK,MAAOI,EAASrK,EAAQqK,MACjFpK,GAAKmF,QAAUnF,EAAKF,QAAQ+G,SAAS+N,EAAkBzP,SACnD6E,GACAhK,EAAKmF,QAAQ6E,MAAMA,GAEnBI,GACApK,EAAKmF,QAAQiF,OAAOA,GAExBpK,EAAK+V,eAAiB9W,EAAM+W,SAAS,WACjChW,EAAKuB,QAAO,MAGpB0T,cAAe,WACX,GAAIjV,GAAOC,KAAMF,EAAUC,EAAKD,OAChCC,GAAK6U,OAAS9V,EAAE,WAAW8H,SAAS+N,EAAkBC,QAClD9U,EAAQP,SACRQ,EAAK6U,OAAO3P,OAAOlF,EAAKiW,eAAenW,SAE3CE,EAAKmF,QAAQD,OAAOlF,EAAK6U,SAE7BoB,aAAc,WACV,GAAIjW,GAAOC,KAAMF,EAAUC,EAAKD,QAASmW,EAAiBnX,EAAE,eAAe8H,SAAS+N,EAAkBpV,SAAU2W,EAAiB/W,KAAWW,EAAQP,SAC5I4C,SAAUrC,EAAQqC,SAAS5C,QAC3BgE,OAAQxD,EAAKyI,eAAe5G,KAAK7B,IAGzC,OADAA,GAAKR,QAAU,GAAIL,GAAGsG,YAAYnG,QAAQ4W,EAAgBC,IAG9DjB,gBAAiB,WACb,GAAIlV,GAAOC,KAAM6U,EAAiB/V,EAAE,eAAe8H,SAAS+N,EAAkBE,gBAAiBxD,EAAgBvS,EAAE,eAAe8H,SAAS+N,EAAkBtD,eAAgB/F,EAAkBxM,EAAE,eAAe8H,SAAS+N,EAAkBrJ,iBAAkBvE,EAAcjI,EAAE,eAAe8H,SAAS+N,EAAkB5N,aAAa3B,OAAQ+Q,EAAgB9B,EAAYtU,EAAK6U,OAC3W7U,GAAKsR,cAAgBA,EACrBtR,EAAKuL,gBAAkBA,EACvBvL,EAAKgH,YAAcA,EACnBsK,EAAcpM,OAAOqG,GACrBuJ,EAAe1K,OAAOkK,EAAYtU,EAAKmF,SAAWiR,GAClDtB,EAAe5P,OAAOoM,GAAepM,OAAO8B,GAC5ChH,EAAKmF,QAAQD,OAAO4P,IAExBK,YAAa,WACT,GAAInV,GAAOC,KAAMoW,GAAU,CAC3BrW,GAAKmF,QAAQyC,GAAG,UAAY3B,EAAI,SAAU5C,GACtC,GAAIA,EAAGiT,QAAS,CACZ,OAAQjT,EAAGkT,SACX,IAAK,IACDvW,EAAKyI,gBACD3H,QAAS,yBACTf,QAAS,gBAEbsW,GAAU,CACV,MACJ,KAAK,KACDrW,EAAKyI,gBACD3H,QAAS,yBACTf,QAAS,YAEbsW,GAAU,CACV,MACJ,KAAK,KACDrW,EAAKyI,gBACD3H,QAAS,yBACTf,QAAS,WAEbsW,GAAU,CACV,MACJ,KAAK,IACDrW,EAAKyI,gBAAiB3H,QAAS,2BAC/BuV,GAAU,CACV,MACJ,KAAK,IACDrW,EAAKyI,gBAAiB3H,QAAS,2BAC/BuV,GAAU,EAGVA,GACAhT,EAAGmT,qBAKnBnB,YAAa,WAAA,GACLrV,GAAOC,KACPmV,EAAWpV,EAAKD,QAAQqV,QAC5BpV,GAAK8R,UAAUsD,GAAUpD,KAAK,SAAUC,GAC/BjS,EAAK0D,QAAQ+Q,GAAexC,MAAOA,KACpCjS,EAAKkS,WAAWD,KAErBE,KAAK,SAAU9O,GACdrD,EAAK0D,QAAQ8Q,EAAOnR,MAG5B2Q,mBAAoB,WAChB,GAAIhU,GAAOC,IACXD,GAAKuS,aACLvS,EAAKyS,cAETwB,aAAc,WACV,GAAIjU,GAAOC,KAAMwW,EAAUzW,EAAKyS,UAAUpQ,OAAS,EAAGqU,EAAU1W,EAAKuS,UAAUlQ,OAAS,EAAGsU,IAAa3W,EAAKkM,OAAQ0K,GAAY,CACjI,KACI5W,EAAKkR,QAAQa,YACf,MAAOhK,GACL6O,GAAY,EAEhB5W,EAAKR,QAAQc,aACTc,KAAMqV,EACNtV,KAAMuV,EACNrS,OAAQsS,EACRC,UAAWA,KAGnB9E,UAAW,SAAUsD,GACjB,GAAIpV,GAAOC,KAAM4W,EAAW,GAAI9X,GAAE+X,SAAY7E,EAAQ,GAAI8E,MAW1D,OAVA9E,GAAM+E,OAAS,WACX/X,EAAME,GAAG8X,SAASjX,EAAKuL,iBAAiB,GACxCsL,EAASK,QAAQjF,IAErBA,EAAMkF,QAAU,WACZlY,EAAME,GAAG8X,SAASjX,EAAKuL,iBAAiB,GACxCsL,EAASO,OAAOC,YAEpBpY,EAAME,GAAG8X,SAASjX,EAAKuL,iBAAiB,GACxC0G,EAAM9F,IAAMiJ,EACLyB,EAASS,WAEpBpF,WAAY,SAAUD,GAAV,GACJjS,GAAOC,KACP+K,EAASjM,EAAE,mCAAmC,GAC9CyS,EAAMxG,EAAOuM,WAAW,KACxBvX,GAAKkR,SACLnS,EAAEiB,EAAKkR,SAASnC,SAEhB/O,EAAKkM,QACLlM,EAAKuS,UAAUxJ,KAAK/I,EAAKkM,QAE7BlM,EAAKkR,QAAUlG,EACfhL,EAAKwX,KAAOhG,EACZxR,EAAKkM,OAAS+F,EACdjH,EAAOhB,MAAQiI,EAAMjI,MACrBgB,EAAOZ,OAAS6H,EAAM7H,OACtBoH,EAAIM,UAAUG,EAAO,EAAG,GACxBjS,EAAKuL,gBAAgBrG,OAAO8F,GAExBhL,EAAKyI,eADLwJ,EAAM7H,OAASpK,EAAKsR,cAAclH,UAE9BtJ,QAAS,yBACTf,QAAS,gBAITe,QAAS,yBACTf,QAASC,EAAK4L,iBAGtB5L,EAAK0D,QAAQgR,GACT1J,OAAQA,EACRwG,IAAKA,EACLS,MAAOA,IAEXjS,EAAKiU,gBAEThJ,iBAAkB,WACd,MAAOhL,MAAKiR,SAEhBO,oBAAqB,WACjB,MAAOxR,MAAKuX,MAEhBnF,gBAAiB,WACb,MAAOpS,MAAKiM,QAEhBzD,eAAgB,SAAUhF,GACtB,GAAIgU,GAAchU,EAAK3C,QAAS4W,EAAiBtY,GAASqG,YAAaxF,MAAQyC,EAAce,EAAK1D,SAAW0D,EAAK1D,SAAYiJ,MAAOvF,EAAK1D,UAAYe,EAAU,GAAI3B,GAAGsG,YAAY2O,SAASqD,GAAaC,EACzM,KAAKzX,KAAKyD,QAAQiR,EAASlR,GAEvB,MADAxD,MAAKgU,eACEnT,EAAQyP,QAGvB3E,aAAc,WACV,MAAO3L,MAAKkR,YAAc,GAE9B7M,QAAS,WACL,GAAItE,GAAOC,IACXD,GAAKF,QAAQmI,IAAIhC,GACbjG,EAAK4G,iBACL5G,EAAK4G,gBAAgBtC,UAErBtE,EAAKR,SACLQ,EAAKR,QAAQ8E,UAEbtE,EAAKgT,SACLhT,EAAKgT,QAAQ1O,UAEjB+P,EAAOlU,GAAGmE,QAAQlE,KAAKJ,KAG/Bb,GAAGwY,OAAO5C,IACZ7V,OAAOD,MAAM0G,QACRzG,OAAOD,OACE,kBAAVH,SAAwBA,OAAO8G,IAAM9G,OAAS,SAAU+G,EAAIC,EAAIC,IACrEA,GAAMD","file":"kendo.imageeditor.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('imageeditor/toolbar', [\n        'kendo.toolbar',\n        'kendo.dropdownlist'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, ui = kendo.ui, extend = $.extend, proxy = $.proxy, ToolBar = kendo.ui.ToolBar, Item = kendo.toolbar.Item, CLICK = 'click', DROPDOWNCHANGE = 'dropDownChange', ACTION = 'action';\n        var ImageEditorToolBar = ToolBar.extend({\n            init: function (element, options) {\n                var that = this;\n                that._extendOptions(options);\n                ToolBar.fn.init.call(that, element, options);\n                that._attachEvents();\n                that.toggleTools();\n            },\n            events: ToolBar.fn.events.concat([\n                DROPDOWNCHANGE,\n                ACTION\n            ]),\n            defaultTools: {\n                open: {\n                    type: 'button',\n                    icon: 'upload',\n                    name: 'open',\n                    command: 'OpenImageEditorCommand',\n                    showText: 'overflow'\n                },\n                save: {\n                    type: 'button',\n                    icon: 'download',\n                    name: 'save',\n                    command: 'SaveImageEditorCommand',\n                    showText: 'overflow',\n                    toggleCondition: 'canExport'\n                },\n                separator: { type: 'separator' },\n                undo: {\n                    type: 'button',\n                    icon: 'undo',\n                    name: 'undo',\n                    command: 'UndoImageEditorCommand',\n                    showText: 'overflow',\n                    toggleCondition: 'undo'\n                },\n                redo: {\n                    type: 'button',\n                    icon: 'redo',\n                    name: 'redo',\n                    command: 'RedoImageEditorCommand',\n                    showText: 'overflow',\n                    toggleCondition: 'redo'\n                },\n                separator1: { type: 'separator' },\n                crop: {\n                    type: 'button',\n                    icon: 'crop',\n                    name: 'crop',\n                    command: 'OpenPaneImageEditorCommand',\n                    options: 'crop',\n                    showText: 'overflow',\n                    toggleCondition: 'canExport'\n                },\n                resize: {\n                    type: 'button',\n                    icon: 'image-resize',\n                    name: 'resize',\n                    command: 'OpenPaneImageEditorCommand',\n                    options: 'resize',\n                    showText: 'overflow',\n                    toggleCondition: 'canExport'\n                },\n                zoomIn: {\n                    type: 'button',\n                    icon: 'zoom-in',\n                    name: 'zoomIn',\n                    command: 'ZoomImageEditorCommand',\n                    showText: 'overflow',\n                    options: 'zoomIn',\n                    toggleCondition: 'enable'\n                },\n                zoomOut: {\n                    type: 'button',\n                    icon: 'zoom-out',\n                    name: 'zoomOut',\n                    command: 'ZoomImageEditorCommand',\n                    showText: 'overflow',\n                    options: 'zoomOut',\n                    toggleCondition: 'enable'\n                },\n                zoomDropdown: {\n                    type: 'imageEditorZoomDropDown',\n                    name: 'zoomDropdown',\n                    command: 'ZoomImageEditorCommand',\n                    text: 'Zoom options',\n                    toggleCondition: 'enable',\n                    items: [\n                        {\n                            name: 'zoomActualSize',\n                            icon: 'zoom-actual-size',\n                            text: 'Show actual size',\n                            options: 'actualSize'\n                        },\n                        {\n                            name: 'zoomFitToScreen',\n                            icon: 'zoom-best-fit',\n                            text: 'Fit to screen',\n                            options: 'fitToScreen'\n                        }\n                    ]\n                }\n            },\n            _attachEvents: function () {\n                var that = this;\n                that.bind(DROPDOWNCHANGE, proxy(that._dropDownChange, that));\n                that.bind(CLICK, proxy(that._click, that));\n            },\n            _extendOptions: function (options) {\n                var that = this, tools = options.items ? options.items : Object.keys(that.defaultTools);\n                that.options = options;\n                that.options.items = that._extendToolsOptions(tools);\n            },\n            _extendToolsOptions: function (tools) {\n                var that = this, messages = that.options.messages;\n                if (!tools.length) {\n                    return;\n                }\n                return tools.map(function (tool) {\n                    var isBuiltInTool = $.isPlainObject(tool) && Object.keys(tool).length === 1 && tool.name, toolOptions, text;\n                    tool = isBuiltInTool ? tool.name : tool;\n                    toolOptions = $.isPlainObject(tool) ? tool : extend({}, that.defaultTools[tool]);\n                    text = messages[toolOptions.name] || toolOptions.text;\n                    kendo.deepExtend(toolOptions, {\n                        id: toolOptions.name + '-' + kendo.guid(),\n                        name: toolOptions.name,\n                        text: text,\n                        attributes: {\n                            'aria-label': text,\n                            'title': text,\n                            'data-command': toolOptions.command,\n                            'data-options': toolOptions.options,\n                            'data-toggle': toolOptions.toggleCondition\n                        },\n                        overflow: toolOptions.overflow\n                    });\n                    if (toolOptions.type === 'imageEditorZoomDropDown') {\n                        toolOptions.items = that._extendToolsOptions(toolOptions.items);\n                    }\n                    return toolOptions;\n                }, that);\n            },\n            _click: function (ev) {\n                var command = $(ev.target).data('command'), options = $(ev.target).data('options');\n                if (!command) {\n                    return;\n                }\n                this.action({\n                    command: command,\n                    options: options\n                });\n            },\n            _dropDownChange: function (ev) {\n                if (!ev.command) {\n                    return;\n                }\n                this.action({\n                    command: ev.command,\n                    options: ev.options\n                });\n            },\n            action: function (args) {\n                this.trigger(ACTION, args);\n            },\n            toggleTools: function (conditions) {\n                var that = this, tools = that.element.find('[data-toggle]');\n                tools.each(function (index, elm) {\n                    var tool = $(elm), widget = null, condition = tool.data('toggle'), toToggle = conditions && conditions[condition];\n                    if (tool.is('[data-role]')) {\n                        widget = kendo.widgetInstance(tool);\n                    }\n                    if (widget && widget.enable) {\n                        widget.enable(toToggle || false);\n                    } else {\n                        that.enable(tool, toToggle);\n                    }\n                });\n            },\n            destroy: function () {\n                var that = this;\n                if (that.zoomDropdown) {\n                    that.zoomDropdown.destroy();\n                }\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        var ImageEditorZoomDropDown = Item.extend({\n            init: function (options, toolbar) {\n                var that = this, element = $('<div></div>'), input = $('<input />').attr(options.attributes), template = '<span class=\"k-icon k-i-#:icon#\"></span> #:text#';\n                that.element = element;\n                that.input = input;\n                that.toolbar = toolbar;\n                that.dropDown = new ui.DropDownList(that.input, {\n                    optionLabel: {\n                        text: options.text,\n                        icon: ''\n                    },\n                    dataTextField: 'text',\n                    dataSource: options.items,\n                    template: template,\n                    change: proxy(that._change, that)\n                });\n                that.element.append(that.dropDown.wrapper);\n                that.dropDown.list.find('.k-list-optionlabel').hide();\n                that.toolbar.zoomDropdown = that;\n            },\n            _change: function (ev) {\n                var that = this;\n                that.toolbar.trigger(DROPDOWNCHANGE, {\n                    command: ev.sender.element.data('command'),\n                    options: ev.sender.dataItem().options\n                });\n            },\n            destroy: function () {\n                this.dropDown.destroy();\n            }\n        });\n        kendo.toolbar.registerComponent('imageEditorZoomDropDown', ImageEditorZoomDropDown);\n        extend(kendo.ui, {\n            imageeditor: {\n                ToolBar: ImageEditorToolBar,\n                ZoomDropDown: ImageEditorZoomDropDown\n            }\n        });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('imageeditor/pane', [\n        'kendo.core',\n        'kendo.form',\n        'kendo.buttongroup',\n        'kendo.draganddrop'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, extend = $.extend, proxy = $.proxy, Class = kendo.Class, NS = '.k-imageeditor-pane', CLICK = 'click';\n        var paneStyles = {\n            form: 'k-imageeditor-pane-form',\n            button: 'k-imageeditor-pane-button',\n            confirmButton: 'k-imageeditor-pane-confirm-button',\n            cropOverlay: 'k-imageeditor-crop-overlay',\n            crop: 'k-imageeditor-crop',\n            resizeHandle: 'k-resize-handle',\n            resizeHandlePrefix: 'k-resize-'\n        };\n        var round = function (f) {\n            return Math.round(f * 1000) / 1000;\n        };\n        var Pane = Class.extend({\n            init: function (imageeditor) {\n                var that = this;\n                that.imageeditor = imageeditor;\n                if (that.imageeditor.currentPaneTool) {\n                    that.imageeditor.currentPaneTool.destroy();\n                }\n                that.element = $('<div></div>').addClass(paneStyles.form);\n            },\n            open: function () {\n                var that = this, imageeditor = that.imageeditor, commonMessages = imageeditor.options.messages.common;\n                imageeditor.paneWrapper.append(that.element);\n                that.formWidget = new kendo.ui.Form(that.element, extend(that.formSettings(), { buttonsTemplate: kendo.format('<button class=\\'{0} k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-action=\\'cancel\\'><span class=\\'k-button-text\\'>{2}</span></button>' + '<button class=\\'{0} {1} k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-action=\\'confirm\\'><span class=\\'k-button-text\\'>{3}</span></button>', paneStyles.button, paneStyles.confirmButton, commonMessages.cancel, commonMessages.confirm) }));\n                that.bindButtonEvents();\n                imageeditor.paneWrapper.show();\n                imageeditor.currentPaneTool = that;\n            },\n            bindButtonEvents: function () {\n                var that = this, formWidget = that.formWidget, buttons = formWidget.element.find('.' + paneStyles.button);\n                that._clickHandler = proxy(that._click, that);\n                buttons.on(CLICK + NS, that._clickHandler);\n            },\n            _click: function (ev) {\n                var that = this, target = $(ev.target).closest('.' + paneStyles.button), action = target.data('action');\n                if (that[action]) {\n                    that[action]();\n                }\n            },\n            cancel: function () {\n                this.destroy();\n            },\n            confirm: function () {\n                window.console.error('Pane\\'s confirm method is not implemented!');\n                this.destroy();\n            },\n            refresh: function () {\n            },\n            destroy: function () {\n                var that = this, imageeditor = that.imageeditor;\n                that.formWidget.element.find('.' + paneStyles.button).off(NS);\n                that.formWidget.destroy();\n                imageeditor.paneWrapper.html('');\n                imageeditor.paneWrapper.hide();\n                delete imageeditor.currentPaneTool;\n            }\n        });\n        var CropPane = Pane.extend({\n            init: function (imageeditor) {\n                var that = this;\n                Pane.fn.init.call(that, imageeditor);\n                that.buildCropModel();\n                that.canvasUI();\n            },\n            confirm: function () {\n                var that = this, model = that.formWidget._model.toJSON();\n                that.destroy();\n                that.imageeditor.executeCommand({\n                    command: 'CropImageEditorCommand',\n                    options: model\n                });\n            },\n            formSettings: function () {\n                var that = this, cropMessages = that.imageeditor.options.messages.panes.crop, commonMessages = that.imageeditor.options.messages.common, aspectRatioItems = cropMessages.aspectRatioItems, aspectRatioDS = [];\n                if (aspectRatioItems) {\n                    for (var key in aspectRatioItems) {\n                        aspectRatioDS.push({\n                            value: key,\n                            text: aspectRatioItems[key]\n                        });\n                    }\n                } else {\n                    aspectRatioDS = [\n                        {\n                            value: 'originalRatio',\n                            text: 'Original ratio'\n                        },\n                        {\n                            value: '1:1',\n                            text: '1:1 (Square)'\n                        },\n                        {\n                            value: '4:5',\n                            text: '4:5 (8:10)'\n                        },\n                        {\n                            value: '5:7',\n                            text: '5:7'\n                        },\n                        {\n                            value: '2:3',\n                            text: '2:3 (4:6)'\n                        },\n                        {\n                            value: '16:9',\n                            text: '16:9'\n                        }\n                    ];\n                }\n                return {\n                    formData: that._model,\n                    change: proxy(that.onChange, that),\n                    items: [{\n                            type: 'group',\n                            label: cropMessages.title || 'Crop Image',\n                            layout: 'grid',\n                            grid: {\n                                cols: 2,\n                                gutter: '0 8px'\n                            },\n                            items: [\n                                {\n                                    label: cropMessages.aspectRatio || 'Aspect ratio:',\n                                    field: 'aspectRatio',\n                                    editor: 'DropDownList',\n                                    editorOptions: {\n                                        dataValueField: 'value',\n                                        dataTextField: 'text',\n                                        dataSource: aspectRatioDS\n                                    },\n                                    colSpan: 2\n                                },\n                                {\n                                    label: cropMessages.orientation,\n                                    field: 'orientation',\n                                    editor: $.proxy(that._orientationEditor, that),\n                                    colSpan: 2\n                                },\n                                {\n                                    label: commonMessages.width || 'Width:',\n                                    field: 'width',\n                                    attributes: { style: 'max-width: 100px;' },\n                                    editor: 'NumericTextBox',\n                                    editorOptions: {\n                                        format: 'n0',\n                                        max: that._model.width,\n                                        min: 0\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    label: commonMessages.height || 'Height:',\n                                    field: 'height',\n                                    attributes: { style: 'max-width: 100px;' },\n                                    editor: 'NumericTextBox',\n                                    editorOptions: {\n                                        format: 'n0',\n                                        max: that._model.height,\n                                        min: 0\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    label: commonMessages.lockAspectRatio || 'Lock aspect ratio',\n                                    field: 'lockAspectRatio',\n                                    colSpan: 2\n                                }\n                            ]\n                        }]\n                };\n            },\n            _orientationEditor: function (container, options) {\n                var that = this, cropMessages = that.imageeditor.options.messages.panes.crop, value = options.model[options.field];\n                that._orientationWidget = $('<div name=\\'' + options.field + '\\'></div>').appendTo(container).kendoButtonGroup({\n                    items: [\n                        {\n                            text: cropMessages.portrait || 'Portrait',\n                            attributes: { 'data-value': 'portrait' },\n                            selected: value === 'portrait'\n                        },\n                        {\n                            text: cropMessages.landscape || 'Landscape',\n                            attributes: { 'data-value': 'landscape' },\n                            selected: value === 'landscape'\n                        }\n                    ],\n                    select: function (ev) {\n                        var value = ev.sender.wrapper.find('.k-selected').data('value');\n                        options.model.set(options.field, value);\n                    }\n                }).data('kendoButtonGroup');\n            },\n            buildCropModel: function () {\n                var that = this, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), width = canvas.width, height = canvas.height;\n                that._model = {\n                    top: 0,\n                    left: 0,\n                    aspectRatio: 'originalRatio',\n                    width: width,\n                    height: height,\n                    orientation: width - height < 0 ? 'portrait' : 'landscape',\n                    lockAspectRatio: true\n                };\n            },\n            canvasUI: function () {\n                var that = this, imageeditor = that.imageeditor, canvasContainer = that.imageeditor.canvasContainer, cropOverlay = $('<div></div>').addClass(paneStyles.cropOverlay), cropElement = $('<div></div>').addClass(paneStyles.crop), handle = '<span class=\\'' + paneStyles.resizeHandle + '\\'></span>', handles = [\n                        'nw',\n                        'n',\n                        'ne',\n                        'w',\n                        'e',\n                        'sw',\n                        's',\n                        'se'\n                    ], zoomLevel = imageeditor.getZoomLevel();\n                for (var i = 0; i < handles.length; i++) {\n                    var handleElm = $(handle).addClass(paneStyles.resizeHandlePrefix + handles[i]).attr('data-orientation', handles[i]);\n                    that._initResizeHandle(handleElm);\n                    cropElement.append(handleElm);\n                }\n                that.cropElement = cropElement;\n                that._canvasUI = cropOverlay.append(cropElement).appendTo(canvasContainer);\n                var width = Math.round(that._model.width * zoomLevel);\n                var height = Math.round(that._model.height * zoomLevel);\n                var borderWidth = parseInt(that.cropElement.css('border-top-width'), 10);\n                that.cropElement.css({\n                    width: width,\n                    height: height,\n                    backgroundImage: 'url(\\'' + imageeditor._image.src + '\\')',\n                    backgroundSize: kendo.format('{0}px {1}px', width, height),\n                    backgroundClip: 'content-box',\n                    backgroundPosition: kendo.format('-{0}px -{0}px', borderWidth)\n                });\n                that.cropElement.kendoDraggable({\n                    ignore: '.' + paneStyles.resizeHandle,\n                    drag: function (ev) {\n                        that._adjustTopLeft(ev.target.offsetTop + ev.y.delta, ev.target.offsetLeft + ev.x.delta);\n                    }\n                });\n            },\n            refresh: function () {\n                var that = this, newModel = that.formWidget._model, zoomLevel = that.imageeditor.getZoomLevel(), width = Math.round(newModel.width * zoomLevel), height = Math.round(newModel.height * zoomLevel), top = Math.round(newModel.top * zoomLevel), left = Math.round(newModel.left * zoomLevel), borderWidth = parseInt(that.cropElement.css('border-top-width'), 10);\n                that.cropElement.css({\n                    top: top,\n                    left: left,\n                    width: width,\n                    height: height,\n                    backgroundSize: kendo.format('{0}px {1}px', that._model.width * zoomLevel, that._model.height * zoomLevel),\n                    backgroundPosition: kendo.format('-{0}px -{1}px', left + borderWidth, top + borderWidth)\n                });\n            },\n            _initResizeHandle: function (handle) {\n                var that = this;\n                handle.kendoDraggable({\n                    drag: function (ev) {\n                        var $target = $(ev.sender.element), newModel = that.formWidget._model, oldModel = that._model, orientation = $target.data('orientation'), adjustments = {}, zoomLevel = that.imageeditor.getZoomLevel(), correctedLeft = newModel.left * zoomLevel, correctedTop = newModel.top * zoomLevel;\n                        if (orientation.indexOf('w') >= 0) {\n                            adjustments.left = that.cropElement[0].offsetLeft + ev.x.delta;\n                            adjustments.width = that.cropElement[0].offsetWidth - ev.x.delta;\n                        } else if (orientation.indexOf('e') >= 0) {\n                            adjustments.width = that.cropElement[0].offsetWidth + ev.x.delta;\n                        }\n                        if (orientation.indexOf('n') >= 0) {\n                            adjustments.top = that.cropElement[0].offsetTop + ev.y.delta;\n                            adjustments.height = that.cropElement[0].offsetHeight - ev.y.delta;\n                        } else if (orientation.indexOf('s') >= 0) {\n                            adjustments.height = that.cropElement[0].offsetHeight + ev.y.delta;\n                        }\n                        if (adjustments.width && (adjustments.left || correctedLeft) + adjustments.width <= oldModel.width * zoomLevel) {\n                            newModel.set('width', Math.round(adjustments.width / zoomLevel));\n                        }\n                        if (adjustments.height && (adjustments.top || correctedTop) + adjustments.height <= oldModel.height * zoomLevel) {\n                            newModel.set('height', Math.round(adjustments.height / zoomLevel));\n                        }\n                        if (adjustments.top || adjustments.left) {\n                            that._adjustTopLeft(adjustments.top, adjustments.left);\n                        }\n                    }\n                });\n            },\n            _adjustTopLeft: function (top, left, compare) {\n                var that = this, compareModel = compare || that.formWidget._model, newModel = that.formWidget._model, oldModel = that._model, zoomLevel = that.imageeditor.getZoomLevel();\n                if (top >= 0 && top / zoomLevel + compareModel.height <= oldModel.height) {\n                    newModel.set('top', Math.round(top / zoomLevel));\n                }\n                if (left >= 0 && left / zoomLevel + compareModel.width <= oldModel.width) {\n                    newModel.set('left', Math.round(left / zoomLevel));\n                }\n            },\n            onChange: function (ev) {\n                var that = this, zoomLevel = that.imageeditor.getZoomLevel(), newModel = ev.sender._model, oldModel = that._model, maxWidth = oldModel.width, maxHeight = oldModel.height, originalRatio = oldModel.width + ':' + oldModel.height, gcd = that._gcd(oldModel.width, oldModel.height);\n                originalRatio = oldModel.width / gcd + ':' + oldModel.height / gcd;\n                if (ev.field === 'aspectRatio' && ev.value === 'originalRatio') {\n                    newModel.set('top', 0);\n                    newModel.set('left', 0);\n                    newModel.set('orientation', oldModel.orientation);\n                    newModel.set('width', oldModel.width);\n                    newModel.set('height', oldModel.height);\n                } else if (ev.field === 'orientation') {\n                    var tempModel = extend({}, newModel, {\n                        width: newModel.height,\n                        height: newModel.width\n                    });\n                    var newSize = that._calcSize(tempModel, originalRatio, maxWidth, maxHeight);\n                    newModel.set('width', newSize.width);\n                    newModel.set('height', newSize.height);\n                    that._orientationWidget.select(ev.value === 'portrait' ? 0 : 1);\n                } else if (newModel.lockAspectRatio) {\n                    var force = ev.field;\n                    var size = that._calcSize(newModel, originalRatio, maxWidth, maxHeight, force);\n                    newModel.set('width', size.width);\n                    newModel.set('height', size.height);\n                }\n                var width = Math.round(newModel.width * zoomLevel);\n                var height = Math.round(newModel.height * zoomLevel);\n                var top = Math.round(newModel.top * zoomLevel);\n                var left = Math.round(newModel.left * zoomLevel);\n                var borderWidth = parseInt(that.cropElement.css('border-top-width'), 10);\n                that.cropElement.css({\n                    top: top,\n                    left: left,\n                    width: width,\n                    height: height,\n                    backgroundPosition: kendo.format('-{0}px -{1}px', left + borderWidth, top + borderWidth)\n                });\n            },\n            _calcSize: function (model, originalRatio, maxWidth, maxHeight, force) {\n                var width = Math.min(model.width, maxWidth), height = Math.min(model.height, maxHeight), isPortrait = model.orientation === 'portrait', ratios = model.aspectRatio;\n                if (ratios.indexOf(':') < 0) {\n                    ratios = originalRatio;\n                }\n                ratios = ratios.split(':').map(function (value) {\n                    return parseInt(value, 10);\n                });\n                var wRatio = isPortrait ? Math.min(ratios[0], ratios[1]) : Math.max(ratios[0], ratios[1]);\n                var hRatio = !isPortrait ? Math.min(ratios[0], ratios[1]) : Math.max(ratios[0], ratios[1]);\n                var expectedRatio = round(wRatio / hRatio);\n                var realRatio = round(width / height);\n                var sizeByRatio = {\n                    width: Math.round(height * expectedRatio),\n                    height: Math.round(width / expectedRatio)\n                };\n                if (force === 'width') {\n                    return {\n                        width: width,\n                        height: sizeByRatio.height\n                    };\n                }\n                if (force === 'height') {\n                    return {\n                        width: sizeByRatio.width,\n                        height: height\n                    };\n                }\n                if (realRatio > expectedRatio) {\n                    width = sizeByRatio.width;\n                } else if (realRatio < expectedRatio) {\n                    height = sizeByRatio.height;\n                }\n                return {\n                    width: width,\n                    height: height\n                };\n            },\n            _gcd: function (a, b) {\n                return b === 0 ? a : this._gcd(b, a % b);\n            },\n            destroy: function () {\n                kendo.destroy(this._canvasUI);\n                this._canvasUI.remove();\n                Pane.fn.destroy.call(this);\n            }\n        });\n        var ResizePane = Pane.extend({\n            init: function (imageeditor) {\n                Pane.fn.init.call(this, imageeditor);\n                this.buildResizeModel();\n            },\n            confirm: function () {\n                var that = this, originalWidth = that._model.width, originalHeight = that._model.height, model = that.formWidget._model.toJSON();\n                if (model.measure === 'percents') {\n                    model.width = originalWidth * (model.width / 100);\n                    model.height = originalHeight * (model.height / 100);\n                }\n                that.imageeditor.executeCommand({\n                    command: 'ResizeImageEditorCommand',\n                    options: model\n                });\n                that.destroy();\n            },\n            formSettings: function () {\n                var that = this, resizeMessages = that.imageeditor.options.messages.panes.resize, commonMessages = that.imageeditor.options.messages.common;\n                return {\n                    formData: that._model,\n                    change: proxy(that.onChange, that),\n                    items: [{\n                            type: 'group',\n                            label: resizeMessages.title || 'Resize image',\n                            layout: 'grid',\n                            grid: {\n                                cols: 2,\n                                gutter: '0 8px'\n                            },\n                            items: [\n                                {\n                                    label: commonMessages.width || 'Width:',\n                                    field: 'width',\n                                    attributes: { style: 'max-width: 100px;' },\n                                    editor: 'NumericTextBox',\n                                    editorOptions: {\n                                        format: 'n0',\n                                        min: 0\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    field: 'measureW',\n                                    editor: 'DropDownList',\n                                    attributes: { style: 'max-width: 100px;' },\n                                    label: {\n                                        text: '&nbsp;',\n                                        encoded: false\n                                    },\n                                    editorOptions: {\n                                        dataTextField: 'text',\n                                        dataValueField: 'value',\n                                        dataSource: [\n                                            {\n                                                text: resizeMessages.pixels || 'Pixels',\n                                                value: 'pixels'\n                                            },\n                                            {\n                                                text: resizeMessages.percents || 'Percents',\n                                                value: 'percents'\n                                            }\n                                        ]\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    label: commonMessages.height || 'Height:',\n                                    field: 'height',\n                                    attributes: { style: 'max-width: 100px;' },\n                                    editor: 'NumericTextBox',\n                                    editorOptions: {\n                                        format: 'n0',\n                                        min: 0\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    field: 'measureH',\n                                    label: {\n                                        text: '&nbsp;',\n                                        encoded: false\n                                    },\n                                    attributes: { style: 'max-width: 100px;' },\n                                    editor: 'DropDownList',\n                                    editorOptions: {\n                                        dataTextField: 'text',\n                                        dataValueField: 'value',\n                                        dataSource: [\n                                            {\n                                                text: resizeMessages.pixels || 'Pixels',\n                                                value: 'pixels'\n                                            },\n                                            {\n                                                text: resizeMessages.percents || 'Percents',\n                                                value: 'percents'\n                                            }\n                                        ]\n                                    },\n                                    colSpan: 1\n                                },\n                                {\n                                    label: commonMessages.lockAspectRatio || 'Lock aspect ratio',\n                                    field: 'lockAspectRatio',\n                                    colSpan: 2\n                                }\n                            ]\n                        }]\n                };\n            },\n            buildResizeModel: function () {\n                var that = this, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), width = canvas.width, height = canvas.height;\n                that._model = {\n                    width: width,\n                    height: height,\n                    measure: 'pixels',\n                    measureW: 'pixels',\n                    measureH: 'pixels',\n                    lockAspectRatio: true,\n                    ratio: round(width / height)\n                };\n            },\n            onChange: function (ev) {\n                var that = this, newModel = ev.sender._model, aspectRatioLocked = newModel.lockAspectRatio;\n                if (ev.field === 'measureW' || ev.field === 'measureH') {\n                    newModel.set('measureW', ev.value);\n                    newModel.set('measureH', ev.value);\n                    newModel.set('measure', ev.value);\n                } else if (ev.field === 'measure') {\n                    that.resetNumericsTo(ev.value);\n                } else if (ev.field === 'width' && aspectRatioLocked && !that._preventChange) {\n                    newModel.set('height', newModel.width / newModel.ratio);\n                } else if (ev.field === 'height' && aspectRatioLocked && !that._preventChange) {\n                    newModel.set('width', newModel.height * newModel.ratio);\n                }\n                newModel.set('ratio', round(newModel.width / newModel.height));\n            },\n            resetNumericsTo: function (type) {\n                var that = this, originalWidth = that._model.width, originalHeight = that._model.height, formWidget = that.formWidget, model = formWidget._model, widthNumeric = formWidget.element.find('[name=width]').data('kendoNumericTextBox'), heightNumeric = formWidget.element.find('[name=height]').data('kendoNumericTextBox'), isPercent = type === 'percents', options = {\n                        percents: { format: '#\\\\%' },\n                        pixels: { format: 'n0' }\n                    };\n                widthNumeric.setOptions(options[type]);\n                heightNumeric.setOptions(options[type]);\n                that._preventChange = true;\n                model.set('width', isPercent ? originalWidth / widthNumeric.value() * 100 : originalWidth * (widthNumeric.value() / 100));\n                model.set('height', isPercent ? originalHeight / heightNumeric.value() * 100 : originalHeight * (heightNumeric.value() / 100));\n                that._preventChange = false;\n            }\n        });\n        extend(kendo.ui.imageeditor, {\n            ImageEditorPane: Pane,\n            panes: {\n                crop: CropPane,\n                resize: ResizePane\n            }\n        });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('imageeditor/commands', [\n        'imageeditor/pane',\n        'kendo.upload'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, imageeditorNS = kendo.ui.imageeditor, extend = $.extend, proxy = $.proxy, Class = kendo.Class;\n        var Command = Class.extend({\n            init: function (options) {\n                this.options = extend({}, options, this.options);\n                this.imageeditor = options.imageeditor;\n            }\n        });\n        var OpenPaneImageEditorCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var that = this, imageeditor = that.imageeditor, pane = new imageeditorNS.panes[that.options.value](imageeditor);\n                pane.open();\n            }\n        });\n        var ZoomImageEditorCommand = Command.extend({\n            options: {\n                zoomStep: 0.05,\n                spacing: 20\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var that = this, options = that.options, value = options.value, imageeditor = that.imageeditor, imgHeight = imageeditor._image.height, currentZoom = imageeditor.getZoomLevel(), newHeight = imgHeight;\n                if (!isNaN(value)) {\n                    value = parseFloat(value);\n                } else if (typeof value === 'string') {\n                    value = that._processStringValue(value, currentZoom);\n                }\n                newHeight = Math.round(imgHeight * value);\n                if (newHeight > 0) {\n                    $(imageeditor._canvas).css('height', newHeight);\n                    imageeditor._zoomLevel = value;\n                }\n                if (imageeditor.currentPaneTool) {\n                    imageeditor.currentPaneTool.refresh();\n                }\n            },\n            _processStringValue: function (value, initialZoom) {\n                var that = this, options = that.options, imageeditor = that.imageeditor, imgHeight = imageeditor._image.height, expectedHeight = imageeditor.canvasWrapper.height() - options.spacing, zoomStep = options.zoomStep;\n                switch (value) {\n                case 'zoomIn':\n                    return initialZoom + zoomStep;\n                case 'zoomOut':\n                    return initialZoom - zoomStep;\n                case 'fitToScreen':\n                    return Math.round(expectedHeight / imgHeight * 100) / 100;\n                default:\n                    return 1;\n                }\n            }\n        });\n        var CropImageEditorCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var that = this, options = that.options, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), ctx = imageeditor.getCurrent2dContext(), croppedImage = ctx.getImageData(options.left, options.top, options.width, options.height);\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\n                canvas.width = options.width;\n                canvas.height = options.height;\n                ctx.putImageData(croppedImage, 0, 0);\n                imageeditor.drawImage(canvas.toDataURL()).done(function (image) {\n                    imageeditor.drawCanvas(image);\n                }).fail(function (ev) {\n                    imageeditor.trigger('error', ev);\n                });\n            }\n        });\n        var ResizeImageEditorCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var that = this, options = that.options, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), ctx = imageeditor.getCurrent2dContext(), image = imageeditor.getCurrentImage();\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\n                canvas.width = options.width;\n                canvas.height = options.height;\n                ctx.drawImage(image, 0, 0, options.width, options.height);\n                imageeditor.drawImage(canvas.toDataURL()).done(function (image) {\n                    imageeditor.drawCanvas(image);\n                }).fail(function (ev) {\n                    imageeditor.trigger('error', ev);\n                });\n            }\n        });\n        var UndoImageEditorCommand = Command.extend({\n            exec: function () {\n                var that = this, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), ctx = imageeditor.getCurrent2dContext(), image = imageeditor.undoStack.pop();\n                if (image) {\n                    imageeditor.redoStack.push(imageeditor.getCurrentImage());\n                    delete imageeditor._image;\n                    ctx.clearRect(0, 0, canvas.width, canvas.height);\n                    canvas.width = image.width;\n                    canvas.height = image.height;\n                    ctx.drawImage(image, 0, 0, image.width, image.height);\n                    imageeditor.drawImage(canvas.toDataURL()).done(function (image) {\n                        imageeditor.drawCanvas(image);\n                    }).fail(function (ev) {\n                        imageeditor.trigger('error', ev);\n                    });\n                }\n            }\n        });\n        var RedoImageEditorCommand = Command.extend({\n            exec: function () {\n                var that = this, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement(), ctx = imageeditor.getCurrent2dContext(), image = imageeditor.redoStack.pop();\n                if (image) {\n                    imageeditor.undoStack.push(imageeditor.getCurrentImage());\n                    delete imageeditor._image;\n                    ctx.clearRect(0, 0, canvas.width, canvas.height);\n                    canvas.width = image.width;\n                    canvas.height = image.height;\n                    ctx.drawImage(image, 0, 0, image.width, image.height);\n                    imageeditor.drawImage(canvas.toDataURL()).done(function (image) {\n                        imageeditor.drawCanvas(image);\n                    }).fail(function (ev) {\n                        imageeditor.trigger('error', ev);\n                    });\n                }\n            }\n        });\n        var SaveImageEditorCommand = Command.extend({\n            exec: function () {\n                var that = this, imageeditor = that.imageeditor, canvas = imageeditor.getCanvasElement();\n                kendo.saveAs(extend({}, imageeditor.options.saveAs, { dataURI: canvas.toDataURL() }));\n            }\n        });\n        var OpenImageEditorCommand = Command.extend({\n            exec: function () {\n                var that = this, imageeditor = that.imageeditor, upload = imageeditor._upload;\n                if (!upload) {\n                    var input = $('<input type=\\'file\\' />');\n                    input.kendoUpload({\n                        select: proxy(that.onSelect, that),\n                        error: proxy(that.onError, that),\n                        multiple: false,\n                        validation: {\n                            allowedExtensions: [\n                                '.jpg',\n                                '.jpeg',\n                                '.gif',\n                                '.png',\n                                '.bmp',\n                                '.tiff',\n                                '.webp'\n                            ]\n                        }\n                    });\n                    imageeditor._upload = upload = input.getKendoUpload();\n                }\n                upload.element.click();\n            },\n            onSelect: function (ev) {\n                var that = this, imageeditor = that.imageeditor, file = ev.files[0].rawFile, reader = new FileReader();\n                reader.addEventListener('load', function () {\n                    imageeditor.drawImage(reader.result).done(function (image) {\n                        if (!imageeditor.trigger('imageLoaded', { image: image })) {\n                            imageeditor.drawCanvas(image);\n                            imageeditor._initUndoRedoStack();\n                            imageeditor._toggleTools();\n                        }\n                    }).fail(function (ev) {\n                        imageeditor.trigger('error', ev);\n                    });\n                }, false);\n                if (file) {\n                    reader.readAsDataURL(file);\n                }\n            },\n            onError: function (ev) {\n                var that = this, imageeditor = that.imageeditor;\n                imageeditor.trigger('error', ev);\n            }\n        });\n        extend(kendo.ui.imageeditor, {\n            ImageEditorCommand: Command,\n            commands: {\n                OpenPaneImageEditorCommand: OpenPaneImageEditorCommand,\n                ZoomImageEditorCommand: ZoomImageEditorCommand,\n                CropImageEditorCommand: CropImageEditorCommand,\n                ResizeImageEditorCommand: ResizeImageEditorCommand,\n                UndoImageEditorCommand: UndoImageEditorCommand,\n                RedoImageEditorCommand: RedoImageEditorCommand,\n                SaveImageEditorCommand: SaveImageEditorCommand,\n                OpenImageEditorCommand: OpenImageEditorCommand\n            }\n        });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.imageeditor', [\n        'imageeditor/toolbar',\n        'imageeditor/commands'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'imageeditor',\n        name: 'ImageEditor',\n        category: 'web',\n        depends: ['core']\n    };\n    (function ($, undefined) {\n        var kendo = window.kendo, extend = $.extend, isPlainObject = $.isPlainObject, Widget = kendo.ui.Widget, ui = kendo.ui, NS = '.kendoImageEditor', outerHeight = kendo._outerHeight, ERROR = 'error', IMAGELOADED = 'imageLoaded', IMAGERENDERED = 'imageRendered', EXECUTE = 'execute';\n        var imageEditorStyles = {\n            wrapper: 'k-widget k-imageeditor',\n            header: 'k-imageeditor-header',\n            toolbar: 'k-imageeditor-toolbar',\n            paneWrapper: 'k-imageeditor-action-pane',\n            contentWrapper: 'k-imageeditor-content',\n            canvasWrapper: 'k-imageeditor-canvas-container',\n            canvasContainer: 'k-imageeditor-canvas'\n        };\n        var ImageEditor = Widget.extend({\n            init: function (element, options) {\n                var that = this;\n                Widget.fn.init.call(that, element, options);\n                options = $.extend(true, {}, options);\n                that._wrapper();\n                that._renderHeader();\n                that._contentWrapper();\n                that._keyHandler();\n                if (options.imageUrl) {\n                    that._drawCanvas();\n                }\n                that._initUndoRedoStack();\n                that._toggleTools();\n                kendo.notify(that);\n            },\n            options: {\n                name: 'ImageEditor',\n                width: '100%',\n                height: 570,\n                imageUrl: '',\n                toolbar: {},\n                saveAs: { fileName: 'image.png' },\n                messages: {\n                    toolbar: {\n                        open: 'Open Image',\n                        save: 'Save Image',\n                        undo: 'Undo',\n                        redo: 'Redo',\n                        crop: 'Crop',\n                        resize: 'Resize',\n                        zoomIn: 'Zoom In',\n                        zoomOut: 'Zoom Out',\n                        zoomDropdown: 'Zoom options',\n                        zoomActualSize: 'Show actual size',\n                        zoomFitToScreen: 'Fit to screen'\n                    },\n                    panes: {\n                        crop: {\n                            title: 'Crop Image',\n                            aspectRatio: 'Aspect Ratio:',\n                            aspectRatioItems: {\n                                'originalRatio': 'Original ratio',\n                                '1:1': '1:1 (Square)',\n                                '4:5': '4:5 (8:10)',\n                                '5:7': '5:7',\n                                '2:3': '2:3 (4:6)',\n                                '16:9': '16:9'\n                            },\n                            orientation: 'Orientation:',\n                            portrait: 'Portrait',\n                            landscape: 'Landscape'\n                        },\n                        resize: {\n                            title: 'Resize image',\n                            pixels: 'Pixels',\n                            percents: 'Percents'\n                        }\n                    },\n                    common: {\n                        width: 'Width:',\n                        height: 'Height:',\n                        cancel: 'Cancel',\n                        confirm: 'Confirm',\n                        lockAspectRatio: 'Lock aspect ratio'\n                    }\n                }\n            },\n            events: [\n                ERROR,\n                IMAGELOADED,\n                IMAGERENDERED,\n                EXECUTE\n            ],\n            _wrapper: function () {\n                var that = this, options = that.options, width = options.width, height = options.height;\n                that.wrapper = that.element.addClass(imageEditorStyles.wrapper);\n                if (width) {\n                    that.wrapper.width(width);\n                }\n                if (height) {\n                    that.wrapper.height(height);\n                }\n                that._resizeHandler = kendo.onResize(function () {\n                    that.resize(true);\n                });\n            },\n            _renderHeader: function () {\n                var that = this, options = that.options;\n                that.header = $('<div />').addClass(imageEditorStyles.header);\n                if (options.toolbar) {\n                    that.header.append(that._initToolbar().element);\n                }\n                that.wrapper.append(that.header);\n            },\n            _initToolbar: function () {\n                var that = this, options = that.options, toolbarElement = $('<div></div>').addClass(imageEditorStyles.toolbar), toolbarOptions = extend({}, options.toolbar, {\n                        messages: options.messages.toolbar,\n                        action: that.executeCommand.bind(that)\n                    });\n                that.toolbar = new ui.imageeditor.ToolBar(toolbarElement, toolbarOptions);\n                return that.toolbar;\n            },\n            _contentWrapper: function () {\n                var that = this, contentWrapper = $('<div></div>').addClass(imageEditorStyles.contentWrapper), canvasWrapper = $('<div></div>').addClass(imageEditorStyles.canvasWrapper), canvasContainer = $('<div></div>').addClass(imageEditorStyles.canvasContainer), paneWrapper = $('<div></div>').addClass(imageEditorStyles.paneWrapper).hide(), toolbarHeight = outerHeight(that.header);\n                that.canvasWrapper = canvasWrapper;\n                that.canvasContainer = canvasContainer;\n                that.paneWrapper = paneWrapper;\n                canvasWrapper.append(canvasContainer);\n                contentWrapper.height(outerHeight(that.wrapper) - toolbarHeight);\n                contentWrapper.append(canvasWrapper).append(paneWrapper);\n                that.wrapper.append(contentWrapper);\n            },\n            _keyHandler: function () {\n                var that = this, prevent = false;\n                that.wrapper.on('keydown' + NS, function (ev) {\n                    if (ev.ctrlKey) {\n                        switch (ev.keyCode) {\n                        case 48:\n                            that.executeCommand({\n                                command: 'ZoomImageEditorCommand',\n                                options: 'fitToScreen'\n                            });\n                            prevent = true;\n                            break;\n                        case 189:\n                            that.executeCommand({\n                                command: 'ZoomImageEditorCommand',\n                                options: 'zoomOut'\n                            });\n                            prevent = true;\n                            break;\n                        case 187:\n                            that.executeCommand({\n                                command: 'ZoomImageEditorCommand',\n                                options: 'zoomIn'\n                            });\n                            prevent = true;\n                            break;\n                        case 90:\n                            that.executeCommand({ command: 'UndoImageEditorCommand' });\n                            prevent = true;\n                            break;\n                        case 89:\n                            that.executeCommand({ command: 'RedoImageEditorCommand' });\n                            prevent = true;\n                            break;\n                        }\n                        if (prevent) {\n                            ev.preventDefault();\n                        }\n                    }\n                });\n            },\n            _drawCanvas: function () {\n                var that = this;\n                var imageUrl = that.options.imageUrl;\n                that.drawImage(imageUrl).done(function (image) {\n                    if (!that.trigger(IMAGELOADED, { image: image })) {\n                        that.drawCanvas(image);\n                    }\n                }).fail(function (ev) {\n                    that.trigger(ERROR, ev);\n                });\n            },\n            _initUndoRedoStack: function () {\n                var that = this;\n                that.undoStack = [];\n                that.redoStack = [];\n            },\n            _toggleTools: function () {\n                var that = this, canRedo = that.redoStack.length > 0, canUndo = that.undoStack.length > 0, hasImage = !!that._image, canExport = true;\n                try {\n                    that._canvas.toDataURL();\n                } catch (error) {\n                    canExport = false;\n                }\n                that.toolbar.toggleTools({\n                    redo: canRedo,\n                    undo: canUndo,\n                    enable: hasImage,\n                    canExport: canExport\n                });\n            },\n            drawImage: function (imageUrl) {\n                var that = this, deferred = new $.Deferred(), image = new Image();\n                image.onload = function () {\n                    kendo.ui.progress(that.canvasContainer, false);\n                    deferred.resolve(image);\n                };\n                image.onerror = function () {\n                    kendo.ui.progress(that.canvasContainer, false);\n                    deferred.reject(arguments);\n                };\n                kendo.ui.progress(that.canvasContainer, true);\n                image.src = imageUrl;\n                return deferred.promise();\n            },\n            drawCanvas: function (image) {\n                var that = this;\n                var canvas = $('<canvas>Canvas element</canvas>')[0];\n                var ctx = canvas.getContext('2d');\n                if (that._canvas) {\n                    $(that._canvas).remove();\n                }\n                if (that._image) {\n                    that.undoStack.push(that._image);\n                }\n                that._canvas = canvas;\n                that._ctx = ctx;\n                that._image = image;\n                canvas.width = image.width;\n                canvas.height = image.height;\n                ctx.drawImage(image, 0, 0);\n                that.canvasContainer.append(canvas);\n                if (image.height > that.canvasWrapper.height()) {\n                    that.executeCommand({\n                        command: 'ZoomImageEditorCommand',\n                        options: 'fitToScreen'\n                    });\n                } else {\n                    that.executeCommand({\n                        command: 'ZoomImageEditorCommand',\n                        options: that.getZoomLevel()\n                    });\n                }\n                that.trigger(IMAGERENDERED, {\n                    canvas: canvas,\n                    ctx: ctx,\n                    image: image\n                });\n                that._toggleTools();\n            },\n            getCanvasElement: function () {\n                return this._canvas;\n            },\n            getCurrent2dContext: function () {\n                return this._ctx;\n            },\n            getCurrentImage: function () {\n                return this._image;\n            },\n            executeCommand: function (args) {\n                var commandName = args.command, commandOptions = extend({ imageeditor: this }, isPlainObject(args.options) ? args.options : { value: args.options }), command = new ui.imageeditor.commands[commandName](commandOptions);\n                if (!this.trigger(EXECUTE, args)) {\n                    this._toggleTools();\n                    return command.exec();\n                }\n            },\n            getZoomLevel: function () {\n                return this._zoomLevel || 1;\n            },\n            destroy: function () {\n                var that = this;\n                that.element.off(NS);\n                if (that.currentPaneTool) {\n                    that.currentPaneTool.destroy();\n                }\n                if (that.toolbar) {\n                    that.toolbar.destroy();\n                }\n                if (that._upload) {\n                    that._upload.destroy();\n                }\n                Widget.fn.destroy.call(that);\n            }\n        });\n        ui.plugin(ImageEditor);\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}