{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","$","normalizeText","text","String","replace","REPLACE_REGEX","SPACE","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","LRUCache","DEFAULT_OPTIONS","defaultMeasureBox","window","Class","size","_size","_length","_map","put","value","map","entry","_head","_tail","newer","older","get","baselineMarkerSize","document","createElement","cssText","_cache","styleKey","cacheKey","cachedResult","baselineMarker","textStr","box","_baselineMarker","cloneNode","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","jQuery","sqr","renderSize","renderPos","pos","result","toHyphens","split","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","now","Date","getTime","RegExp","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","name","attrs","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","isNaN","ENTITIES","undefined","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","fromCharCode","amp","lt","gt","quot","apos","nbsp","parseXML","DrawingCommand","ReorderDrawingsCommand","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","COMMAND_TYPES","AUTO_FILL","CLEAR","CUT","EDIT","PASTE","VALIDATION","Command","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","select","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","usesImage","DrawingUpdateCommand","_sheet","_drawing","drawing","_orig","clone","_previous","previous","reset","_activeDrawing","triggerChange","layout","img","image","InsertImageCommand","_blob","blob","_width","_height","aspect","Math","min","addDrawing","topLeftCell","topLeft","offsetX","offsetY","opacity","addImage","removeDrawing","DeleteDrawingCommand","_origIndex","_drawings","indexOf","splice","_newIndex","_reorder","drawings","BringToFrontCommand","SendToBackCommand","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","rowValues","nullValues","currentRange","canEditArrayFormula","refs","concat","row","changeType","clearContent","_getValidationState","cell","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","InsertCommentCommand","TextWrapCommand","forEachRow","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","format","adjustDecimals","BorderChangeCommand","_type","border","_style","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","event","_clipboardContent","_content","activeSheet","selection","pasteRef","_targetRangeRefs","UnionRef","status","canPaste","clipboardContent","preventDefault","_processPaste","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","bottomRight","that","targetRangeRefs","RangeRef","compare","b","topLeftA","topLeftB","cols","sourceData","_targetRanges","_populateTargetRange","recalc","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","support","paste","_view","focus","execCommand","CutCommand","_eventType","rangeValues","currentRow","canCopy","cut","copy","multiSelection","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","autoFillData","intersectingArrayFormula","_previewFillFrom","props","dest","_properties","Range","FillError","ToolbarCutCommand","cannotUndo","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","DeleteRowCommand","resize","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","_pos","count","base","AddColumnCommand","preventAddColumn","preventAddColumnAfterLast","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","preventAddRow","preventAddRowAfterLast","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","wrapper","FormulaBar","ui","Widget","addClass","prependTo","formulaBarWidth","formulaInput","FormulaInput","appendTo","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","ns","keys","listWrapper","styles","KEY_NAMES","27","37","39","35","36","32","PRIVATE_FORMULA_CHECK","attr","css","autoScale","on","scale","_highlightedRefs","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","ev","val","browser","msie","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","strictMode","refAtPoint","simplify","relative","isMerged","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","html","txt","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","insertNewline","eof","13","38","33","34","46","113","Mac","navigator","platform","isAlphaNum","keyName","EventListener","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","skew","level","temp","insert","NilNode","RangeTreeNode","start","remove","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","findrange","first","last","RangeList","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","Iterator","toJSON","fromJSON","unique","at","SparseRangeList","lastRangeStart","ValueRange","toExcelFormat","cloneFormulaValue","deepClone","cloneFormulaTree","Property","set","dst","JsonProperty","JSON","stringify","ValueProperty","formats","dateToNumber","culture","calendar","patterns","limitPrecision","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","prop","formula","si","iter","iterators","reduce","ret","addBorder","hBorders","leftBorders","rightBorders","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","NULL","NameRef","CellRef","Ref","hasSheet","_hasSheet","absolute","adjust","toString","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","single","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","move","tr","u","empty","theRef","newRefs","NULLREF","SHEETREF","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","makeWordMovement","isCol","firstVal","advanced","hidden","EdgeNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","_columns","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","selectDrawingForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","nextUntil","prevUntil","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","setSelection","selTopLeft","selBottomRight","done","navigatedAway","isSingleCellSelected","isFirstCell","isLastCell","currentNavigationRange","singleCellSelection","focusNextElement","nextNavigationRange","find","previousNavigationRange","shouldSkip","extendSelection","resizeAutoFill","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","preview","_autoFillOrigin","punch","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hasRight","hasLeft","hideColumn","_count","hasBottom","hasTop","hideRow","unhideColumn","unhideRow","preventInsertRow","preventInsertBelowLastRow","preventInsertColumn","preventInsertAfterLastColumn","totalRows","selectedRows","selectedRowsCount","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","color","cellState","vBorders","getComputedStyle","borders","fontSize","background","italic","bold","textAlign","verticalAlign","parseHTML","table","ri","ci","td","rowSpan","colSpan","ignoreColspan","dr","dc","Matrix","getAttribute","parseTSV","Clipboard","_externalContent","_internalContent","iframe","className","setAttribute","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","doc","contentWindow","write","querySelector","internalHTML","internalPlain","partition","predicate","looksLikeANumber","getTextHeight","fontFamily","font-size","font-family","white-space","overflow-wrap","word-wrap","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","_set","noTrigger","topLeftRef","valueProp","_get","_resizedRef","existingFormat","t1","t2","existingFormatType","compile","currency","editorChange","isInEditMode","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","_validation","_merge","mergedRef","vi","isAutofill","setProp","line","propName","propValue","isFilteredRow","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","primary","secondary","cant","_getMergedCells","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","textHeight","sum","hasValue","defStyle","_defaultCellStyle","flag","draw","each","CalcError","argmax","sameRef","constructor","compileArgumentChecks","functionName","args","comp","wantNulls","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","round","err","main","Function","toPrecision","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","getNA","makeAsyncFunction","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","validDate","da","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","makeDateFormat","parseExactDate","equals","binaryCompare","exports","Context","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","_arrayArg","onFormula","fetch","context","pending","add","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","affectedSheet","operation","formulaMoves","formulaRow","formulaCol","newFormulaRow","newFormulaCol","formulaSheet","prevRefs","prevRange","newRef","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","pow","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","pane","triggerSelect","_currentView","Sheet","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","selectedHeaders","allRows","allCols","skipDataSourceInsert","nextRef","isEnabledRow","skipDataSourceDelete","isEnabledColumn","_filterRow","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","startDragging","completeDragging","refBox","drag","drawingBoundingBox","indexVisible","refBoundingBox","dragging","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","maxRow","maxCol","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","clearDefaultStyle","json","positions","viewSelection","hyperlinks","src","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Drawing","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","Rectangle","drw","outerWidth","_outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonDefaults","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","SheetsBar","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","sheetsWrapper","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","_toggleScrollButtons","ul","_sheetsGroup","scrollLeft","scrollWidth","scrollPrevButton","scrollNextButton","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","idx","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","data-type","baseButtonClass","itemsWrapper","childrenElements","children","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","closeCallback","removedSheetName","dlg","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","scrLeft","setDecimalSeparator","sep","SEPARATORS","DEC","ARG","COL","OPERATORS","OPERATORS_COMMA","OPERATORS_STANDARD","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","parseFloat","symbol","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","parseSqref","getNumberRegexp","comma","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","_separators","p","monthFirst","rxnum","rxcur","suffix","has_currency","has_percent","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","strings","relationships","theme","items","loading","ERROR_LOG","readStrings","readRelationships","readTheme","byType","readStyles","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","localSheetId","SEL_DEFINED_NAME","vbProcedure","withErrorLog","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","addAutoFilter","filters","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","commentFile","drawingFile","sharedFormulas","nCols","prevCellRef","relsFile","closed","styleIndex","stop","acRef","SEL_FORMULA","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","percent","blank","leave","failed","SEL_VALIDATION","SEL_VALIDATION_INSANE","sqref","showErrorMessage","MAP_EXCEL_OPERATOR","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","SEL_VALUE","SEL_STRING","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_FORMULA2_INSANE","SEL_VALIDATION_SQREF_INSANE","comments","relative_file","readComments","readDrawings","getContentType","filename","jpg","jpeg","png","gif","getFileName","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","files","asArrayBuffer","edge","Blob","File","excelToPixels","cx","cy","colOffset","rowOffset","brCell","brX","brY","author","authors","SEL_COMMENT","authorId","SEL_AUTHOR","SEL_COMMENT_TEXT","ourOp","equal","notEqual","greaterThanOrEqual","lessThanOrEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","setFormat","formatCode","setFill","setFont","setBorder","side","BORDER_WIDTHS","shouldSet","applyName","xf","inlineStyles","xfId","namedStyles","fonts","indent","fills","numFmts","DEFAULT_FORMATS","part","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","defaultThemeColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","font","fill","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","arr","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","loadBinary","url","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","sheetParamsFromJSON","or","Workbook","messages","defaultSheetName","_images","_imgID","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChanging","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","_inputForRef","execute","commandOptions","cleanupImages","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","images","names","localName","saveJSON","ids","readAsDataURL","reject","ooxml","saveAs","dataURI","forceProxy","toDataURL","toBlob","proxyURL","excel","group","nameForRef","imageUrl","URL","createObjectURL","revokeObjectURL","PDFMixin","_drawPDF","exportPDF","exportPDFToBlob","proxyTarget","fail","area","fsheet","frow","fcol","states","arrayRange","tlRow","tlCol","currentFormula","vrow","vcol","_formulaContextRefresh","toActionSelector","selectors","Controller","alphaNumRegExp","ACTIONS","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","ENTRY_ACTIONS","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum","alt+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","CONTAINER_EVENTS","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","CLIPBOARD_EVENTS","mouseup","*+cut","*+paste","*+copy","EDITOR_EVENTS","esc","alt+enter","shift+ctrl+enter","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","activeSheetName","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","win","originFrame","_startResizingDrawing","stopPropagation","widgetInstance","modal","startBox","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","handle","translateCoords","startX","startY","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","_dragDrawing","onMouseDrag","frame","clientX","clientY","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","clipBoardValue","_pasteImage","Image","onPaste","hasHTML","hasPlainText","DOMStringList","types","kind","getAsFile","onCopy","scrollRight","getBoundingClientRect","noDrawing","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDraw","toHSV","outline","backgroundColor","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","drawingResizeHandles","data-direction","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","DRAWING_CONTEXT_MENU","VIEW_CONTENTS","View","RESIZE_HANDLE_WIDTH","EDIT_BUTTON_WIDTH","ERROR","viewClassNames","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","bringToFront","sendToBack","addColumn","addRow","Node","toDomTree","offset","role","ContextMenu","contextMenuConfig","_chrome","_dialogs","append","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","enableClipboard","isClipboardDeactivated","_resize","actionBar","formulaBar","parents","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","ed","activeCellCustomEditor","_editorInLastColumn","drawingAt","drx","dry","selecting","clientWidth","paneAt","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","FilterMenu","_filterMenu","selectClipboardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","focusButton","onClose","dialogOptions","currentDialogs","errorMessages","hasOpenedError","ESC","_retry","registered","_filterMenuColumn","scrollbarSize","contentWidth","contentHeight","resizeDirection","scrollbar","toplevelElements","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","activeCellRange","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","ttOffset","absRow","absCol","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","renderDrawings","toDiv","backgroundImage","_start","BUTTON_SIZE","BUTTON_OFFSET","filtered","classes","_addDiv","selections","selectionClasses","_renderCustomEditorButton","cssClass","autoFillRectangle","_axis","btnClass","isLastColumn","btn","_buttonOutOfVisiblePane","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","fromValidation","toValidation","Calendar","_rowAndColPresent","disableDates","kendoStaticList","getKendoStaticList","read","intersectsRect","total","PaneGrid","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","accentFoldingFiltering","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","decimal","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","padRight","digNumber","intpart","decpart","TEXT","section","found","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","skipMinus","shouldInsertMinus","lastPart","iv","chf","formatDec","decimals","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","fetchSumRange","continuation","sumRange","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","PI","rad","deg","cos","sin","atan","tan","ceil","mult","prod","coef","seen","m1","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","denomitator","string","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","whipNumberArrays","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","borderPalette","COLOR_PICKER_MESSAGES","colorPicker","customColor","cancel","ColorChooser","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","center","one","_hueSlider","kendoFlatColorPicker","observable","BorderPalette","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","ToolBar","MESSAGES","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","insertComment","insertImage","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","defaultTools","toolDefaults","iconClass","dialogName","togglable","separator","formatCells","SpreadsheetToolBar","handleClick","_expandTools","tools","toolbarName","_addSeparators","tool","_nextTool","activeElement","blur","removeClass","click","activeIndex","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","attributes","aria-label","menuButtons","commandType","checked","setToggle","hasOwnProperty","update","enabled","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","_title","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_defineButtons","_commandPalette","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","inArray","PDF_PAPER_SIZE","basicErrorDialog","register","MessageDialog","messageId","Localizable","path","translate","trans","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ConfirmationDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","InsertCommentDialog","InsertImageDialog","ObservableObject","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","paper","a4","a5","b3","b4","b5","folio","legal","tabloid","executive","margin","normal","narrow","wide","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","removeLink","insertCommentDialog","removeComment","insertImageDialog","info","typeError","registry","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","getter","confirm","_confirmed","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","autoPrint","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","model","okEnabled","hasImage","isHovered","_url","_image","stopEvent","drop","selectFile","dataTransfer","dragEnter","dragLeave","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_requestStart","_error","_progress","getterIdx","distinctValues","query","itemVisible","filterSpread","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","valuesFilter","toLocaleLowerCase","uncheckAll","hasChildren","flattenOperators","operators","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","sortAscending","sortDescending","search","addToCurrent","operatorNone","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","_summary","_toggle","_icon","_container","fx","expand","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","oldRect","newRect","barInput","cellInput","_triggerUpdate","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","noChange","inputType","linearRegression","findSeries","findStep","forEachSeries","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","srcIdx","destRange","fillFrom","CLASS_NAMES","comboBoxTitle","comboElement","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","wholeRect","rowHeights","colWidths","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","nonEmpty","relrow","relcol","rh","cw","shouldDrawCell","emptyCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","addPage","isInside","endbottom","endright","page","bordersGroup","kdrw","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","moveTo","lineTo","stroke","guideColor","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","paddingLeft","paddingRight","vtrans","text_group","CONT","boxSizing","lineHeight","padding","makeFontDef","createTextNode","drawDOM","getPaperOptions","multiPage","Container","pb","addVert","addHoriz","drawTabularData","textWidth","charWidth","mkCell","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidthFunction","columnTitles","columnWidths","label","CACHE_CHAR_WIDTH","geometry","widths","NS","Spreadsheet","version","F10","F11","I","U","H","A","DELETE","R","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","redoTool","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        window.kendo.util = window.kendo.util || {};\n        var LRUCache = kendo.Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var map = this._map;\n                var entry = {\n                    key: key,\n                    value: value\n                };\n                map[key] = entry;\n                if (!this._head) {\n                    this._head = this._tail = entry;\n                } else {\n                    this._tail.newer = entry;\n                    entry.older = this._tail;\n                    this._tail = entry;\n                }\n                if (this._length >= this._size) {\n                    map[this._head.key] = null;\n                    this._head = this._head.newer;\n                    this._head.older = null;\n                } else {\n                    this._length++;\n                }\n            },\n            get: function (key) {\n                var entry = this._map[key];\n                if (entry) {\n                    if (entry === this._head && entry !== this._tail) {\n                        this._head = entry.newer;\n                        this._head.older = null;\n                    }\n                    if (entry !== this._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = this._tail;\n                        entry.newer = null;\n                        this._tail.newer = entry;\n                        this._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n        var SPACE = ' ';\n        function normalizeText(text) {\n            return String(text).replace(REPLACE_REGEX, SPACE);\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var DEFAULT_OPTIONS = { baselineMarkerSize: 1 };\n        var defaultMeasureBox;\n        if (typeof document !== 'undefined') {\n            defaultMeasureBox = document.createElement('div');\n            defaultMeasureBox.style.cssText = 'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: pre!important;';\n        }\n        var TextMetrics = kendo.Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this.options = $.extend({}, DEFAULT_OPTIONS, options);\n            },\n            measure: function (text, style, options) {\n                if (options === void 0) {\n                    options = {};\n                }\n                if (typeof text === 'undefined' || text === null) {\n                    return zeroSize();\n                }\n                var styleKey = objectKey(style);\n                var cacheKey = hashKey(text + styleKey);\n                var cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = options.box || defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (typeof value !== 'undefined') {\n                        measureBox.style[key] = value;\n                    }\n                }\n                var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n                measureBox.textContent = textStr;\n                measureBox.appendChild(baselineMarker);\n                document.body.appendChild(measureBox);\n                if (textStr.length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                var marker = document.createElement('div');\n                marker.style.cssText = 'display: inline-block; vertical-align: baseline;width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;overflow: hidden;';\n                return marker;\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.deepExtend(kendo.util, {\n            LRUCache: LRUCache,\n            TextMetrics: TextMetrics,\n            measureText: measureText,\n            objectKey: objectKey,\n            hashKey: hashKey,\n            normalizeText: normalizeText\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend;\n        function sqr(value) {\n            return value * value;\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        function withExit(f, obj) {\n            try {\n                return f.call(obj, function (value) {\n                    throw new Return(value);\n                });\n            } catch (ex) {\n                if (ex instanceof Return) {\n                    return ex.value;\n                }\n                throw ex;\n            }\n            function Return(value) {\n                this.value = value;\n            }\n        }\n        deepExtend(kendo, {\n            util: {\n                now: now,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                sqr: sqr,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                isUnicodeLetter: isUnicodeLetter,\n                withExit: withExit\n            }\n        });\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var COMMAND_TYPES = {\n            AUTO_FILL: 'autoFill',\n            CLEAR: 'clear',\n            CUT: 'cut',\n            EDIT: 'edit',\n            PASTE: 'paste',\n            VALIDATION: 'validation'\n        };\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.range().select();\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            usesImage: function () {\n                return false;\n            }\n        });\n        kendo.spreadsheet.DrawingUpdateCommand = Command.extend({\n            init: function (options) {\n                this._sheet = options.sheet;\n                this._drawing = options.drawing;\n                this._orig = this._drawing.clone();\n                this._previous = options.previous;\n            },\n            exec: function () {\n            },\n            undo: function () {\n                this._drawing.reset(this._previous);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            redo: function () {\n                this._drawing.reset(this._orig);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            usesImage: function (img) {\n                return this._drawing.image === img || this._orig.image === img || this._previous.image === img;\n            }\n        });\n        var DrawingCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._drawing = options.drawing;\n            },\n            usesImage: function (img) {\n                return this._drawing.image === img;\n            }\n        });\n        kendo.spreadsheet.InsertImageCommand = DrawingCommand.extend({\n            init: function (options) {\n                DrawingCommand.fn.init.call(this, options);\n                this._blob = options.blob;\n                this._width = options.width;\n                this._height = options.height;\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var width = this._width;\n                var height = this._height;\n                var aspect = width / height;\n                if (width > height) {\n                    width = Math.min(width, 300);\n                    height = width / aspect;\n                } else {\n                    height = Math.min(height, 300);\n                    width = height * aspect;\n                }\n                this._drawing = sheet.addDrawing({\n                    topLeftCell: range.topLeft(),\n                    offsetX: 5,\n                    offsetY: 5,\n                    width: width,\n                    height: height,\n                    opacity: 1,\n                    image: this._workbook.addImage(this._blob)\n                }, true);\n                this._blob = null;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            redo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            }\n        });\n        kendo.spreadsheet.DeleteDrawingCommand = DrawingCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            },\n            redo: function () {\n                this.exec();\n            }\n        });\n        var ReorderDrawingsCommand = DrawingCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._origIndex = sheet._drawings.indexOf(this._drawing);\n                sheet._drawings.splice(this._origIndex, 1);\n                this._newIndex = this._reorder();\n                sheet._drawings.splice(this._newIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._drawings.splice(this._newIndex, 1);\n                sheet._drawings.splice(this._origIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            }\n        });\n        kendo.spreadsheet.BringToFrontCommand = ReorderDrawingsCommand.extend({\n            _reorder: function () {\n                return this.range().sheet()._drawings.length;\n            }\n        });\n        kendo.spreadsheet.SendToBackCommand = ReorderDrawingsCommand.extend({\n            _reorder: function () {\n                return 0;\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    if (this.options.property === 'format') {\n                        this._workbook.trigger('changeFormat', { range: range });\n                    }\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                var values = [], range, rowValues, nullValues, validationState, currentRange;\n                if (!this.range().enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                if (!this.range().canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                range = this.range().skipHiddenCells();\n                if (range._ref.refs && range._ref.refs.length > 1) {\n                    range._ref.refs.forEach(function (ref) {\n                        currentRange = range.sheet().range(ref);\n                        values = values.concat(currentRange.values());\n                    });\n                } else {\n                    values = range.values();\n                }\n                nullValues = [];\n                values.forEach(function (row) {\n                    rowValues = [];\n                    row.forEach(function () {\n                        rowValues.push(null);\n                    });\n                    nullValues.push(rowValues);\n                });\n                if (range.sheet().trigger('changing', {\n                        data: nullValues,\n                        range: range,\n                        changeType: COMMAND_TYPES.CLEAR\n                    })) {\n                    return;\n                }\n                range.clearContent();\n                validationState = range._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            },\n            undo: function () {\n                var range = this.range().skipHiddenCells();\n                var sheet = range.sheet();\n                var data = this._state.data;\n                var values = [];\n                var rowValues;\n                data.forEach(function (row) {\n                    rowValues = [];\n                    row.forEach(function (cell) {\n                        rowValues.push(cell.value);\n                    });\n                    values.push(rowValues);\n                });\n                if (sheet.trigger('changing', {\n                        data: values,\n                        range: range,\n                        changeType: COMMAND_TYPES.CLEAR\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            _setRange: function (range) {\n                PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n                this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function () {\n                var editRange = this._editRange;\n                var state = this._state;\n                if (editRange.sheet().trigger('changing', {\n                        data: state.data[0][0].value,\n                        range: editRange,\n                        changeType: COMMAND_TYPES.EDIT\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function () {\n                var arrayFormula = this.options.arrayFormula;\n                var editRange = this._editRange;\n                if (!editRange.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (!editRange.canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this.range().sheet().trigger('changing', {\n                        data: value,\n                        range: this._editRange,\n                        changeType: COMMAND_TYPES.EDIT\n                    })) {\n                    return;\n                }\n                if (this._property == 'value') {\n                    editRange.value(value);\n                    return;\n                }\n                try {\n                    editRange.link(null);\n                    if (value === '') {\n                        editRange.value(null);\n                    } else {\n                        editRange.input(value, { arrayFormula: arrayFormula });\n                        if (/\\n/.test(editRange.value())) {\n                            editRange.wrap(true);\n                        }\n                    }\n                    editRange._adjustRowHeight();\n                    var validationState = editRange._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.InsertCommentCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'comment';\n                PropertyChangeCommand.fn.init.call(this, options);\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._delta = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var delta = this._delta;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (!format) {\n                            var value = cell.value;\n                            if (typeof value == 'number' && /\\./.test(value)) {\n                                format = '0.' + String(value).split('.')[1].replace(/\\d/g, '0');\n                            }\n                        }\n                        if (format || delta > 0) {\n                            format = formatting.adjustDecimals(format || '0', delta);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            _batch: function (f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function () {\n                var self = this;\n                self.getState();\n                self._batch(function () {\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function () {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function (style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function (style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._clipboard.parse();\n                this._event = options.event;\n                this._clipboardContent = this._clipboard._content;\n                this._sheet = this._workbook.activeSheet();\n                this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n                this._targetRangeRefs = this._range._ref instanceof kendo.spreadsheet.UnionRef ? this._range._ref.refs : [this._range._ref];\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function () {\n                var sheet = this._sheet;\n                var range = this._range;\n                if (sheet.trigger('changing', {\n                        data: this._state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.PASTE\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function () {\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var sheet = this._sheet;\n                var range = this._range;\n                if (this._workbook.trigger('paste', {\n                        range: range,\n                        clipboardContent: this._clipboardContent\n                    }) || sheet.trigger('changing', {\n                        data: this._clipboardContent.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.PASTE\n                    })) {\n                    this._event.preventDefault();\n                    return;\n                } else {\n                    this._processPaste();\n                }\n            },\n            _adjustPasteTarget: function (multipliers, sourceRows, sourceCols) {\n                var that = this;\n                var targetRangeRefs = that._targetRangeRefs;\n                var sheet = that._sheet;\n                var RangeRef = kendo.spreadsheet.RangeRef;\n                var UnionRef = kendo.spreadsheet.UnionRef;\n                var refs = [];\n                var compare = function (a, b) {\n                    var result = 0;\n                    var topLeftA = a.topLeft;\n                    var topLeftB = b.topLeft;\n                    if (topLeftA.row > topLeftB.row) {\n                        result = 1;\n                    } else if (topLeftA.row < topLeftB.row) {\n                        result = -1;\n                    } else if (topLeftA.col > topLeftB.col) {\n                        result = 1;\n                    } else if (topLeftA.col < topLeftB.col) {\n                        result = -1;\n                    }\n                    return result;\n                };\n                var refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n                for (i = 0; i < targetRangeRefs.length; i += 1) {\n                    ref = targetRangeRefs[i];\n                    multiplier = multipliers[i];\n                    topLeft = ref.topLeft;\n                    bottomRight = {\n                        row: multiplier.rows * sourceRows + topLeft.row - 1,\n                        col: multiplier.cols * sourceCols + topLeft.col - 1\n                    };\n                    refToSelect = new RangeRef(topLeft, bottomRight);\n                    refs.push(refToSelect);\n                }\n                if (refs.length === 1) {\n                    rangeToSelect = sheet.range(refToSelect);\n                } else {\n                    refs.sort(compare);\n                    rangeToSelect = sheet.range(new UnionRef(refs));\n                }\n                rangeToSelect.select();\n                that._range = rangeToSelect;\n                that._state = that._range.getState();\n            },\n            _processPaste: function () {\n                var that = this;\n                var sheet = that._sheet;\n                var clipboardContent = that._clipboardContent;\n                var range = that._range;\n                var sourceData = clipboardContent.data;\n                var sourceRows = sourceData.length;\n                var sourceCols = sourceData[0].length;\n                var targetRangeRefs = that._targetRangeRefs;\n                var multipliers = that._targetRanges(sourceRows, sourceCols);\n                var i;\n                that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n                sheet.batch(function () {\n                    for (i = 0; i < targetRangeRefs.length; i++) {\n                        that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n                    }\n                }, {\n                    recalc: true,\n                    ref: that._range._ref\n                });\n                range._adjustRowHeight();\n            },\n            _populateTargetRange: function (ref, sourceRows, sourceCols, multipliers) {\n                var topLeft = ref.topLeft;\n                var range, i, j;\n                for (i = 0; i < multipliers.rows; i++) {\n                    for (j = 0; j < multipliers.cols; j++) {\n                        range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                        range.setState(this._clipboardContent, this._clipboard);\n                    }\n                }\n            },\n            _targetRangeDimensions: function (ref, sourceRows, sourceCols) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var targetRangeRows = bottomRight.row - topLeft.row + 1;\n                var targetRangeCols = bottomRight.col - topLeft.col + 1;\n                var rowsMultiplier = 1;\n                var colsMultiplier = 1;\n                if (targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0) {\n                    rowsMultiplier = targetRangeRows / sourceRows;\n                    colsMultiplier = targetRangeCols / sourceCols;\n                }\n                return {\n                    rows: rowsMultiplier,\n                    cols: colsMultiplier\n                };\n            },\n            _targetRanges: function (sourceRows, sourceCols) {\n                var targetRangeRefs = this._targetRangeRefs;\n                var multipliers = [];\n                var i;\n                for (i = 0; i < targetRangeRefs.length; i++) {\n                    multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n                }\n                return multipliers;\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            _eventType: 'cut',\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                var data = [], rangeValues, currentRow;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                if (this._eventType == 'cut') {\n                    if (!range.enable()) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    this.getState();\n                }\n                if (this._workbook.trigger(this._eventType, { range: range })) {\n                    this._event.preventDefault();\n                } else if (this._eventType == 'cut') {\n                    rangeValues = range.values();\n                    rangeValues.forEach(function (row) {\n                        currentRow = [];\n                        row.forEach(function () {\n                            currentRow.push({});\n                        });\n                        data.push(currentRow);\n                    });\n                    if (range.sheet().trigger('changing', {\n                            data: data,\n                            range: range,\n                            changeType: COMMAND_TYPES.CUT\n                        })) {\n                        return;\n                    }\n                    this._clipboard.cut();\n                } else {\n                    this._clipboard.copy();\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                if (range.sheet().trigger('changing', {\n                        data: this._state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.CUT\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n            _eventType: 'copy',\n            undo: $.noop\n        });\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range(), autoFillData;\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (range.intersectingArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                try {\n                    autoFillData = range._previewFillFrom(this._origin);\n                    if (range.sheet().trigger('changing', {\n                            data: autoFillData.props,\n                            range: autoFillData.dest,\n                            changeType: COMMAND_TYPES.AUTO_FILL\n                        })) {\n                        return;\n                    }\n                    autoFillData.dest._properties(autoFillData.props, true);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                var state = this._state;\n                if (range.sheet().trigger('changing', {\n                        data: state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.AUTO_FILL\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            cannotUndo: true,\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                var reason = range.cantSort();\n                if (reason) {\n                    return {\n                        reason: 'error',\n                        type: reason.code\n                    };\n                }\n                range.sort({\n                    column: col,\n                    ascending: ascending\n                });\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = Command.extend({\n            exec: function () {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function () {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function () {\n                    self._indexes.forEach(function (x) {\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, {\n                    layout: true,\n                    recalc: true,\n                    ref: range._ref\n                });\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    left: -Infinity,\n                    right: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    top: -Infinity,\n                    bottom: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function () {\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var value = this._value;\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddColumn();\n                if (!result && value === 'right') {\n                    result = sheet.axisManager().preventAddColumnAfterLast();\n                }\n                if (result) {\n                    return result;\n                }\n                if (value === 'left') {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var value = this._value;\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddRow();\n                if (!result && value === 'below') {\n                    result = sheet.axisManager().preventAddRowAfterLast();\n                }\n                if (result) {\n                    return result;\n                }\n                if (value === 'above') {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var self = this, sheet = self.range().sheet();\n                this.getState();\n                if (sheet.trigger('changing', {\n                        data: self._value,\n                        range: self.range(),\n                        changeType: COMMAND_TYPES.VALIDATION\n                    })) {\n                    return;\n                }\n                try {\n                    sheet.withCultureDecimals(function () {\n                        self.range().validation(self._value);\n                    });\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            },\n            undo: function () {\n                var editRange = this.range();\n                var state = this._state;\n                if (editRange.sheet().trigger('changing', {\n                        data: state.data[0][0].validation,\n                        range: editRange,\n                        changeType: COMMAND_TYPES.VALIDATION\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function () {\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog('importError', { errors: errors });\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                $('<span class=\\'k-icon k-i-formula-fx\\' />').prependTo(element);\n                var formulaBarWidth = element.width();\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element), { formulaBarWidth: formulaBarWidth });\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (options && options.formulaBarWidth) {\n                    element.css('max-width', options.formulaBarWidth - 16 + 'px');\n                }\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1,\n                formulaBarWidth: null\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            select: function () {\n                this.setPos(0, this.length());\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                var that = this;\n                if (KEY_NAMES[key]) {\n                    that.popup.close();\n                    that._navigated = true;\n                } else if (that._move(key)) {\n                    that._navigated = true;\n                    e.preventDefault();\n                }\n                that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                setTimeout(this._sync.bind(this));\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enable(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                return this._canInsertRef(isKeyboardAction);\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(left.type)) {\n                            return {\n                                token: left,\n                                replace: true,\n                                end: left.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(right.type)) {\n                            return {\n                                token: right,\n                                replace: true,\n                                end: right.end\n                            };\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet.isMerged(ref)) {\n                        ref = ref.topLeft;\n                    }\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n                this._sync();\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, '');\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._highlightedRefs.length) {\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223 || keyCode === 229) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.touchProxy = this.touch.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                target.on('touchmove touchend', this.touchProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                $(document.documentElement).on('touchmove touchend', this.touchProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            touch: function (e) {\n                this.handleEvent(e, e.type);\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n            clone: function () {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(function (value) {\n                    return value.clone();\n                });\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state.clone();\n            },\n            toJSON: function () {\n                return this.values();\n            },\n            fromJSON: function (values) {\n                values.forEach(function (v) {\n                    this.value(v.start, v.end, v.value);\n                }, this);\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index] && this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start, end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                } else if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'vBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: JsonProperty,\n                    name: 'hBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'indent',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'comment',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'html',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                }\n            ],\n            init: function (rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                switch (name) {\n                case 'borderRight':\n                    index += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    index++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                switch (name) {\n                case 'borderRight':\n                    start += this.rowCount;\n                    end += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    start++;\n                    end++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n                [\n                    'borderLeft',\n                    'borderRight',\n                    'borderTop',\n                    'borderBottom'\n                ].forEach(function (b) {\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function (index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                return this.specs.reduce(function (ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator('hBorders', start, end + 1);\n                var leftBorders = this.iterator('vBorders', start, end);\n                var rightBorders = this.iterator('vBorders', start + this.rowCount, end + this.rowCount);\n                var values, index;\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n                for (index = start; index <= end; index++) {\n                    values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    addBorder('borderLeft', leftBorders, index);\n                    addBorder('borderRight', rightBorders, index + this.rowCount);\n                    addBorder('borderTop', hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder('borderBottom', hBorders, index + 1);\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone();\n            return x;\n        }\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree;\n            return tree;\n        }\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function (a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ]);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (rr1 === rr2 && rc1 === rc2) {\n                if (r1 > r2) {\n                    changes = true;\n                    tmp = r1;\n                    r1 = r2;\n                    r2 = tmp;\n                    tmp = rr1;\n                    rr1 = rr2;\n                    rr2 = tmp;\n                }\n                if (c1 > c2) {\n                    changes = true;\n                    tmp = c1;\n                    c1 = c2;\n                    c2 = tmp;\n                    tmp = rc1;\n                    rc1 = rc2;\n                    rc2 = tmp;\n                }\n                if (changes) {\n                    this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                    this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n                }\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(function (ref) {\n                if (ref instanceof UnionRef) {\n                    ref.forEach(callback, obj);\n                } else {\n                    callback.call(obj, ref);\n                }\n            }, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            var refs = [];\n            this.forEach(function (ref) {\n                refs.push(callback.call(obj, ref));\n            });\n            return new UnionRef(refs);\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey, view) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection(view);\n                } else {\n                    this._sheet.startSelection(view);\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = null;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            selectDrawingForContextMenu: function (drawing) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = drawing;\n                sheet.triggerChange({ selection: true });\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-word-right':\n                    bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-word-right':\n                    topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-word-left':\n                    topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-word-left':\n                    bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-word-up':\n                    topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-word-up':\n                    bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-word-down':\n                    bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-word-down':\n                    topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'word-right':\n                    column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                case 'word-left':\n                    column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                case 'word-up':\n                    row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                case 'word-down':\n                    row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var isFirstCell = false;\n                var isLastCell = false;\n                var selTopLeft, selBottomRight;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                var tmp;\n                function setSelection(sel) {\n                    selTopLeft = sel.topLeft;\n                    selBottomRight = sel.bottomRight;\n                }\n                setSelection(sheet.currentNavigationRange());\n                var done = false;\n                var navigatedAway = false;\n                while (!done && !navigatedAway) {\n                    var current = new CellRef(row, column);\n                    var isSingleCellSelected = sheet.singleCellSelection();\n                    if (isSingleCellSelected) {\n                        isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                        isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n                        if (!isFirstCell) {\n                            isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                        }\n                        if (!isLastCell) {\n                            isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                        }\n                    }\n                    switch (direction) {\n                    case 'next':\n                        if (isLastCell) {\n                            navigatedAway = true;\n                            kendo.focusNextElement();\n                        } else if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol);\n                            if (column == topLeftCol || column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                tmp = rows.nextVisible(row);\n                                if (tmp == row || tmp > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (isFirstCell) {\n                            navigatedAway = true;\n                            this._sheet._workbook._view.element.find('.k-spreadsheet-name-editor .k-input').trigger('focus');\n                        } else if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol);\n                            if (column == topLeftCol || column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                tmp = rows.prevVisible(row);\n                                if (tmp == row || tmp < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow);\n                            if (row == topLeftRow || row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                tmp = columns.nextVisible(column);\n                                if (tmp == column || tmp > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow);\n                            if (row == topLeftRow || row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                tmp = columns.prevVisible(column);\n                                if (tmp == column || tmp < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (done) {\n                    if (sheet.singleCellSelection()) {\n                        sheet.select(new CellRef(row, column));\n                    } else {\n                        sheet.activeCell(new CellRef(row, column));\n                    }\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                    return true;\n                }\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        hint = preview.hint;\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                case 'word-left':\n                    action = rightMode ? 'expand-word-left' : 'shrink-word-left';\n                    break;\n                case 'word-right':\n                    action = leftMode ? 'expand-word-right' : 'shrink-word-right';\n                    break;\n                case 'word-up':\n                    action = bottomMode ? 'expand-word-up' : 'shrink-word-up';\n                    break;\n                case 'word-down':\n                    action = topMode ? 'expand-word-down' : 'shrink-word-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        function makeWordMovement(sheet, pivot, isCol) {\n            var firstVal = sheet.range(pivot).value();\n            return function (pos, advanced, hidden) {\n                if (hidden) {\n                    return true;\n                }\n                var val = (isCol ? sheet.range(pivot.row, pos) : sheet.range(pos, pivot.col)).value();\n                if (firstVal === null) {\n                    return val === null ? false : pos;\n                } else if (!advanced && val === null) {\n                    firstVal = null;\n                    return false;\n                } else {\n                    return val === null;\n                }\n            };\n        }\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedColumn(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenColumn(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        width: sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n            deleteSelectedRows: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedRow(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenRow(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        height: sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            preventAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertRow(0, rowCount);\n            },\n            preventAddRowAfterLast: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertBelowLastRow(range.bottomRight.row, rowCount);\n            },\n            preventAddColumn: function () {\n                var range = this._sheet.select().toRangeRef();\n                var columnCount = range.width();\n                return this._sheet.preventInsertColumn(0, columnCount);\n            },\n            preventAddColumnAfterLast: function () {\n                var range = this._sheet.select().toRangeRef();\n                var columnCount = range.width();\n                return this._sheet.preventInsertAfterLastColumn(range.bottomRight.col, columnCount);\n            },\n            addColumnLeft: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addColumnRight: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowAbove: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                var totalRows = sheet._grid.rowCount;\n                var selectedRows = sheet.select();\n                var selectedRowsCount = selectedRows.bottomRight.row - selectedRows.topLeft.row + 1;\n                sheet.batch(function () {\n                    selectedRows.forEachRowIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        if (selectedRows.bottomRight.row + selectedRowsCount < totalRows) {\n                            sheet.insertRow(base);\n                        }\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowBelow: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                var totalRows = sheet._grid.rowCount;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    if (base + count < totalRows) {\n                        for (var i = 0; i < count; ++i) {\n                            sheet.insertRow(base);\n                        }\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.iframe.setAttribute('title', 'Spreadsheet clipboard iframe');\n                this.menuInvoked = false;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector('table');\n                        if (table) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(row, col, element, hBorders, vBorders) {\n            var styles = window.getComputedStyle(element);\n            var text = element.innerText.replace(/\\t$/, '');\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderTop: borders.borderTop || hBorders.get(row, col) || null,\n                borderBottom: borders.borderBottom || hBorders.get(row + 1, col) || null,\n                borderLeft: borders.borderLeft || vBorders.get(row, col) || null,\n                borderRight: borders.borderRight || vBorders.get(row, col + 1) || null,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            hBorders.set(row, col, state.borderTop);\n            hBorders.set(row + 1, col, state.borderBottom);\n            vBorders.set(row, col, state.borderLeft);\n            vBorders.set(row, col + 1, state.borderRight);\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n                    var style = td.getAttribute('style');\n                    var ignoreColspan = /mso-ignore:colspan/.test(style);\n                    setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                    if (rowSpan > 1 || colSpan > 1 && !ignoreColspan) {\n                        state.mergedCells.push(new kendo.spreadsheet.RangeRef(new CellRef(row, col), new CellRef(row + rowSpan - 1, col + colSpan - 1)).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'indent',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor',\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft',\n            'comment',\n            'html'\n        ];\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function (ref) {\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    var result = ref;\n                    var valueProp = name === 'value' || name === 'formula' || name === 'link';\n                    if (valueProp && ref.topLeft) {\n                        var topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n                        sheet.forEachMergedCell(function (f) {\n                            if (f.intersects(topLeftRef)) {\n                                result = topLeftRef;\n                            }\n                        });\n                    }\n                    sheet._set(result.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            html: function (value) {\n                return this._property('html', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            input: function (value, options) {\n                options = $.extend({ arrayFormula: false }, options);\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            var existingFormatType = existingFormat && kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == 'date' && existingFormatType != 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent' && existingFormatType != 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency || existingFormatType == 'number' && x.type == 'number' && x.format.length > existingFormat.length) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula, options.arrayFormula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat);\n                                var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                if (t1 == t2) {\n                                    value = t1;\n                                    break OUT;\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            } else if (this._sheet._useCultureDecimals() && typeof value == 'number' && value != Math.floor(value)) {\n                                value = String(value).replace('.', kendo.culture().numberFormat['.']);\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    return !kendo.util.withExit(function (exit) {\n                        this._sheet.forEach(this._ref, function (_, __, data) {\n                            if (data.enable === false) {\n                                exit(true);\n                            }\n                        });\n                    }, this);\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value, arrayFormula) {\n                var self = this;\n                if (value === undefined) {\n                    var f = self._get('formula');\n                    return f ? '' + f : null;\n                }\n                if (arrayFormula) {\n                    var ref = this._ref.toRangeRef();\n                    value = self._sheet.range(ref.topLeft)._set('formula', value)._get('formula');\n                    if (value) {\n                        value.setArrayFormulaRange(ref);\n                    }\n                } else {\n                    self._set('formula', value);\n                }\n                return self;\n            },\n            intersectingArrayFormula: function () {\n                var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n                return kendo.util.withExit(function (exit) {\n                    this._sheet._forFormulas(function (f) {\n                        var r = f.arrayFormulaRange;\n                        if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                            exit({\n                                formula: f,\n                                intersection: r\n                            });\n                        }\n                    });\n                }, this);\n            },\n            canEditArrayFormula: function () {\n                var x = this.intersectingArrayFormula();\n                if (x) {\n                    return x.formula.arrayFormulaRange.eq(x.intersection);\n                }\n                return true;\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props, isAutofill) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            if (!isAutofill && sheet.isHiddenRow(ri)) {\n                                continue;\n                            }\n                            if (isAutofill && sheet.isFilteredRow(ri)) {\n                                continue;\n                            }\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function (x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.fontSize(null);\n                        this.wrap(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !this.cantSort();\n            },\n            cantSort: function () {\n                if (this._ref instanceof UnionRef) {\n                    return {\n                        code: 'cantSortMultipleSelection',\n                        message: 'Unsupported for multiple ranges.'\n                    };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return {\n                        code: 'cantSortNullRef',\n                        message: 'Unsupported for NULLREF.'\n                    };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function (row, col) {\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        } else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch (ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: 'cantSortMixedCells',\n                        message: 'Unsupported for range containing cells of different shapes.'\n                    };\n                }\n                return false;\n            },\n            sort: function (spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(filter.columns[i].index);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref,\n                    rows: this._sheet._rows.getState()\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        var value = typeof cell[property] == 'undefined' ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula || value instanceof kendo.spreadsheet.validation.Validation) {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    if (!clipboard) {\n                        this._sheet._rows.setState(state.rows);\n                    }\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function (data, dr) {\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (externalClipboard) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), {\n                    recalc: true,\n                    ref: this._ref\n                });\n            },\n            _adjustRowHeight: function () {\n                var that = this;\n                var sheet = that._sheet;\n                var mc = sheet._getMergedCells(that._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                sheet.batch(function () {\n                    that.forEachRow(function (rowRange) {\n                        var row = rowRange._ref.topLeft.row;\n                        var height = sheet.rowHeight(row);\n                        if (!height) {\n                            return;\n                        }\n                        rowRange.forEachCell(function (row, col, cell) {\n                            var id = new CellRef(row, col).print();\n                            if (secondary[id]) {\n                                return;\n                            }\n                            var merged = primary[id];\n                            var width;\n                            if (merged) {\n                                width = sheet._columns.sum(merged.topLeft.col, merged.bottomRight.col);\n                            } else {\n                                width = sheet.columnWidth(col);\n                            }\n                            var data = cell.value;\n                            if (cell.format && data != null) {\n                                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                            }\n                            var textHeight = kendo.spreadsheet.util.getTextHeight(data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                            height = Math.max(height, textHeight);\n                        });\n                        sheet.rowHeight(row, height);\n                    });\n                }, { layout: true });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var defStyle = this._sheet._defaultCellStyle;\n                return kendo.util.withExit(function (exit) {\n                    this.forEachCell(function (row, col, cell) {\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                exit(true);\n                            }\n                        }\n                    });\n                }, this);\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this._property('wrap', flag);\n                if (flag !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this._property('fontSize', size);\n                if (size !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n            insideBorders: function (value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n            insideVerticalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set('vBorders', value);\n                    }\n                }, this);\n                return this;\n            },\n            insideHorizontalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set('hBorders', value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap;\"></div>')[0];\n        function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': wrap === true ? width + 'px' : 'auto',\n                'font-size': (fontSize || 12) + 'px',\n                'font-family': fontFamily || 'Arial',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre',\n                'overflow-wrap': wrap === true ? 'break-word' : 'normal',\n                'word-wrap': wrap === true ? 'break-word' : 'normal'\n            };\n            return kendo.util.measureText(text, styles, {\n                box: measureBox,\n                normalizeText: false\n            }).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            if (f.arrayFormulaRange) {\n                val = this.asMatrix(val) || this.asMatrix([[val]]);\n            } else if (val instanceof RangeRef) {\n                val = this._arrayArg(val);\n            }\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, wantNulls) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val, wantNulls);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val, wantNulls));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data, wantNulls));\n                } else {\n                    ret.push(val);\n                }\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (val instanceof RangeRef && this.ss.isMerged(val)) {\n                        val = val.topLeft;\n                    }\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        _arrayArg: function (ref) {\n            var f = this.formula;\n            if (!f.arrayFormulaRange && ref instanceof RangeRef) {\n                if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                    return this.getRefData(new CellRef(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                }\n                if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                    return this.getRefData(new CellRef(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                }\n                return new CalcError('VALUE');\n            } else {\n                return this.asMatrix(ref);\n            }\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            if (typeof el === 'string' && el.length && !isNaN(el)) {\n                                el = Number(el);\n                            }\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo, wantNulls) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n        },\n        getRefData: function (ref, wantNulls) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        getNA: function (row, col) {\n            if (row < this.height && col < this.width) {\n                return this.get(row, col);\n            }\n            return new CalcError('N/A');\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n            this.arrayFormulaRange = arrayFormulaRange;\n        },\n        setArrayFormulaRange: function (ref) {\n            this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            var range = this.arrayFormulaRange;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n                if (range) {\n                    range = range.clone().setSheet(sheet);\n                }\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col, range);\n        },\n        deepClone: function () {\n            var refs = this.refs.map(function (ref) {\n                return ref.clone();\n            });\n            return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                var next = function () {\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function (ref) {\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n                    this.handler.call(ctx);\n                }.bind(this);\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            var prevRefs = this.refs;\n            var modified = formulaMoves;\n            this.refs = prevRefs.map(function (ref) {\n                var newRef = adjust(ref);\n                if (!modified && !sameRef(newRef, ref)) {\n                    modified = true;\n                }\n                return newRef;\n            });\n            var prevRange = this.arrayFormulaRange;\n            if (prevRange) {\n                this.arrayFormulaRange = adjust(prevRange);\n                if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                    modified = true;\n                }\n            }\n            if (modified) {\n                return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n            }\n            function adjust(ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    function sameRef(r1, r2) {\n        if (r1.constructor !== r2.constructor) {\n            return false;\n        }\n        if (r1 instanceof CellRef) {\n            return r1.sheet == r2.sheet && r1.row == r2.row && r1.col == r2.col && r1.rel == r2.rel;\n        }\n        if (r1 instanceof RangeRef) {\n            return sameRef(r1.topLeft, r2.topLeft) && sameRef(r1.bottomRight, r2.bottomRight) && r1.endSheet == r2.endSheet;\n        }\n        if (r1 instanceof UnionRef) {\n            var i = r1.refs.length;\n            if (i != r2.refs.length) {\n                return false;\n            }\n            while (--i >= 0) {\n                if (!sameRef(r1.refs[i], r2.refs[i])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, limitPrecision);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var wantNulls = /!$/.test(type[0]);\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')' + (wantNulls ? ',true' : '') + ').reduce(function(ret, $' + name + '){ ';\n                    if (type[0].charAt(0) != '#') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'if (' + cond(type[1]) + ') ret.push($' + name + '); ';\n                    code += 'return ret; ';\n                    code += '}.bind(this), []); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\' ? ($' + name + ' = +$' + name + ', true) : false) || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this._arrayArg(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'number!') {\n                return '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false)';\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function limitPrecision(num) {\n        return num === parseInt(num, 10) ? num : +num.toPrecision(14);\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return limitPrecision(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function validDate(yr, mo, da) {\n        return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth(yr, mo - 1);\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str, format) {\n        if (format) {\n            format = kendo.spreadsheet.formatting.makeDateFormat(format);\n        }\n        return kendo.parseExactDate(str, format) || kendo.parseExactDate(str) || kendo.parseExactDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.validDate = validDate;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    exports.limitPrecision = limitPrecision;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            'forced'\n        ],\n        [\n            '*b',\n            'forced'\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    function equals(a, b) {\n        a = typeof a === 'string' ? a.toLowerCase() : a;\n        b = typeof b === 'string' ? b.toLowerCase() : b;\n        if (a === false && b == null) {\n            return true;\n        }\n        if (b === false && a == null) {\n            return true;\n        }\n        if (a === 0 && b == null) {\n            return true;\n        }\n        if (b === 0 && a == null) {\n            return true;\n        }\n        if (a === '' && b == null) {\n            return true;\n        }\n        if (b === '' && a == null) {\n            return true;\n        }\n        return a === b;\n    }\n    defineFunction('binary=', equals).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return !equals(a, b);\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        if (typeof m == 'string') {\n            m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n        }\n        return m;\n    }).args([[\n            'm',\n            [\n                'or',\n                'matrix',\n                'string'\n            ]\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                if (validation.from.indexOf('{') > -1) {\n                    validation.from = validation.from.replace(/\\\"/g, '').replace('{', '\"').replace('}', '\"');\n                }\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        deepClone: function () {\n            var v = new Validation(this);\n            v.from = v.from.deepClone();\n            if (v.to) {\n                v.to = v.to.deepClone();\n            }\n            return v;\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            var prevFrom, prevTo, modified;\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            if (this.from) {\n                prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        modified = true;\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        modified = true;\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n            if (modified || prevFrom || prevTo) {\n                var v = new Validation(this);\n                v.from = prevFrom;\n                v.to = prevTo;\n                v.row = formulaRow;\n                v.col = formulaCol;\n                return v;\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var MODIFIED_FORMULAS;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell, view) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this._sheet.forEachMergedCell(ref, function (merged) {\n                                ref = merged.topLeft;\n                            });\n                            this.activeCell(ref);\n                        } else {\n                            ref = this.selection.lastRange();\n                            if (view && view._sheet === this._sheet && view.panes[0]) {\n                                var panes = view.panes;\n                                var i, pane, rows, cols, visible, newRef;\n                                for (i = 0; i < panes.length; i++) {\n                                    pane = panes[i];\n                                    rows = pane._currentView.rows.values;\n                                    cols = pane._currentView.columns.values;\n                                    visible = new RangeRef(new CellRef(rows.start, cols.start), new CellRef(rows.end, cols.end));\n                                    newRef = ref.intersect(visible);\n                                    if (newRef !== kendo.spreadsheet.NULLREF) {\n                                        break;\n                                    }\n                                }\n                                if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                                    ref = newRef;\n                                }\n                            }\n                            this.activeCell(ref.first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            events: [\n                'changing',\n                'commandRequest',\n                'afterInsertRow',\n                'afterDeleteRow',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'dataBinding',\n                'dataBound',\n                'progress'\n            ],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap,\n                    verticalAlign: defaultCellStyle.verticalAlign,\n                    textAlign: defaultCellStyle.textAlign\n                };\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n                this._drawings = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            triggerSelect: function (range) {\n                this.trigger('select', { range: range });\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                if (this.trigger('hideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                if (this.trigger('unhideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _saveModifiedFormulas: function (array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n            _restoreModifiedFormulas: function (array) {\n                var wb = this._workbook;\n                array.forEach(function (f) {\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('formula', index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('validation', index, index, f);\n                    }\n                });\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                        sheet._forValidations(function (validation) {\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n                if (operation == 'row') {\n                    if (delta < 0) {\n                        this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                    } else {\n                        this._filteredRows.copy(start, this._rows._count, start + delta);\n                        this._filteredRows.value(start, start + delta - 1, false);\n                    }\n                }\n                this._drawings.forEach(function (drawing) {\n                    if (drawing.topLeftCell) {\n                        drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null, operation == 'row', start, delta);\n                    }\n                });\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            preventInsertRow: function (rowIndex, count) {\n                if (this.selectedHeaders().allRows) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowWhenColumnIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertBelowLastRow: function (rowIndex, count) {\n                count = count || 1;\n                if (rowIndex + count === this._rows._count) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowBelowLastRow'\n                    };\n                }\n                return false;\n            },\n            preventInsertColumn: function (colIndex, count) {\n                if (this.selectedHeaders().allCols) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColumnWhenRowIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(0, grid.columnCount - count, grid.rowCount, count);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertAfterLastColumn: function (colIndex, count) {\n                count = count || 1;\n                if (colIndex + count === this._columns._count) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColAfterLastCol'\n                    };\n                }\n                return false;\n            },\n            insertRow: function (rowIndex, skipDataSourceInsert) {\n                var result = this.preventInsertRow(rowIndex);\n                if (result) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                if (this.trigger('insertRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                if (!skipDataSourceInsert) {\n                    this.trigger('afterInsertRow', { index: rowIndex });\n                }\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex, skipDataSourceDelete) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                if (!skipDataSourceDelete) {\n                    this.trigger('afterDeleteRow', { index: rowIndex });\n                }\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                if (this.trigger('insertColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            _filterRow: function (rowIndex) {\n                this._rows.hide(rowIndex);\n                this._filteredRows.value(rowIndex, rowIndex, true);\n                this.triggerChange({ layout: true });\n            },\n            hideRow: function (rowIndex) {\n                if (this.trigger('hideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                if (this.trigger('unhideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            isFilteredRow: function (rowIndex) {\n                return this._filteredRows.value(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n                this.forEachMergedCell(range, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n                return {\n                    primary: primary,\n                    secondary: secondary,\n                    hasMerged: hasMerged\n                };\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                var self = this;\n                function forEachRange(ref) {\n                    if (!(ref instanceof RangeRef)) {\n                        ref = ref.toRangeRef();\n                    }\n                    var topLeft = self._grid.normalize(ref.topLeft);\n                    var bottomRight = self._grid.normalize(ref.bottomRight);\n                    var ci, ri;\n                    function doIt(value) {\n                        callback(ri++, ci, value);\n                    }\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        ri = topLeft.row;\n                        var startCellIndex = self._grid.index(ri, ci);\n                        var endCellIndex = self._grid.index(bottomRight.row, ci);\n                        self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                    }\n                }\n                if (!(ref instanceof RangeRef)) {\n                    ref = self._ref(ref);\n                }\n                if (ref instanceof UnionRef) {\n                    ref.forEach(forEachRange);\n                } else {\n                    forEachRange(ref);\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            draggingInProgress: function () {\n                return this._draggingInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            _renderComment: function (ref) {\n                var comment = ref ? this.range(ref).comment() : null;\n                if (comment) {\n                    if (!this._commentRef || !ref.eq(this._commentRef)) {\n                        this._commentRef = ref;\n                        this.trigger('change', { comment: true });\n                    }\n                } else {\n                    if (this._commentRef) {\n                        this._commentRef = null;\n                        this.trigger('change', { comment: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startDragging: function (data) {\n                this._draggingInProgress = data;\n            },\n            completeDragging: function () {\n                var drag = this._draggingInProgress;\n                if (drag) {\n                    this._draggingInProgress = null;\n                    var drawing = drag.drawing;\n                    if (drawing.eq(drag.copy)) {\n                        return;\n                    }\n                    if (drawing.topLeftCell) {\n                        var box = this.drawingBoundingBox(drawing);\n                        var row = this._rows.indexVisible(box.top);\n                        var col = this._columns.indexVisible(box.left);\n                        var ref = new CellRef(row, col);\n                        var refBox = this.refBoundingBox(ref);\n                        drawing.offsetX = box.left - refBox.left;\n                        drawing.offsetY = box.top - refBox.top;\n                        drawing.topLeftCell = ref;\n                        this.triggerChange({ dragging: true });\n                    }\n                    this.trigger('commandRequest', {\n                        command: 'DrawingUpdateCommand',\n                        options: {\n                            sheet: this,\n                            drawing: drawing,\n                            previous: drag.copy\n                        }\n                    });\n                }\n            },\n            startSelection: function (view) {\n                if (this.frozenRows() || this.frozenColumns()) {\n                    this._currentView = null;\n                } else if (view && view._sheet === this) {\n                    this._currentView = view;\n                }\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function (key) {\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    clearDefaultStyle(cell);\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        if (cell.formula.arrayFormulaRange) {\n                            cell.formula = {\n                                src: cell.formula.toString(),\n                                ref: cell.formula.arrayFormulaRange.toString()\n                            };\n                        } else {\n                            cell.formula = cell.formula.toString();\n                        }\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle,\n                    drawings: this._drawings.map(function (dr) {\n                        return dr.toJSON();\n                    })\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        var isArray = typeof cell.formula != 'string';\n                                        var src = isArray ? cell.formula.src : cell.formula;\n                                        var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                        if (isArray) {\n                                            formula.setArrayFormulaRange(kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                        }\n                                        cell.formula = formula;\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.drawings) {\n                        this._drawings = json.drawings.map(Drawing.fromJSON);\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef.first();\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.forEach(ref, function (row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), 'row', start, diff);\n                        }\n                    }\n                }.bind(this));\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this.isFilteredRow(ri)) {\n                            this._filteredRows.value(ri, ri, false);\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this._filterRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    recalc: true,\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        recalc: true,\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            },\n            _useCultureDecimals: function () {\n                return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n            withCultureDecimals: function (f) {\n                var dot = '.';\n                if (this._useCultureDecimals()) {\n                    dot = kendo.culture().numberFormat['.'];\n                }\n                return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            },\n            drawingBoundingBox: function (drawing) {\n                var left = drawing.offsetX;\n                var top = drawing.offsetY;\n                if (drawing.topLeftCell) {\n                    left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                    top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n                }\n                return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n            },\n            refBoundingBox: function (ref) {\n                return this._grid.rectangle(ref.toRangeRef());\n            },\n            addDrawing: function (drw, activate) {\n                if (!(drw instanceof Drawing)) {\n                    drw = new Drawing(drw);\n                }\n                this._drawings.push(drw);\n                if (activate) {\n                    this._activeDrawing = drw;\n                }\n                this.triggerChange({ layout: true });\n                return drw;\n            },\n            removeDrawing: function (drawing) {\n                var pos = this._drawings.indexOf(drawing);\n                if (pos >= 0) {\n                    this._drawings.splice(pos, 1);\n                    this.triggerChange({ layout: true });\n                }\n            },\n            usesImage: function (img) {\n                for (var i = this._drawings.length; --i >= 0;) {\n                    if (this._drawings[i].image === img) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n            isMerged: function (ref) {\n                var merged = this._mergedCells;\n                for (var i = merged.length; --i >= 0;) {\n                    if (merged[i].eq(ref)) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        });\n        var Drawing = kendo.Class.extend({\n            init: function Drawing(args) {\n                this.reset(args);\n            },\n            toJSON: function () {\n                return {\n                    topLeftCell: this.topLeftCell.toString(),\n                    offsetX: this.offsetX,\n                    offsetY: this.offsetY,\n                    width: this.width,\n                    height: this.height,\n                    image: this.image,\n                    opacity: this.opacity\n                };\n            },\n            clone: function () {\n                return new Drawing(this);\n            },\n            reset: function (dr) {\n                var anchor = dr.topLeftCell;\n                if (typeof anchor == 'string') {\n                    anchor = kendo.spreadsheet.calc.parseReference(anchor);\n                }\n                this.topLeftCell = anchor;\n                this.offsetX = dr.offsetX || 0;\n                this.offsetY = dr.offsetY || 0;\n                this.width = dr.width;\n                this.height = dr.height;\n                this.image = dr.image;\n                this.opacity = dr.opacity != null ? dr.opacity : 1;\n            },\n            eq: function (dr) {\n                return (!this.topLeftCell && !dr.topLeftCell || this.topLeftCell && dr.topLeftCell && this.topLeftCell.eq(dr.topLeftCell)) && this.offsetX === dr.offsetX && this.offsetY === dr.offsetY && this.width === dr.width && this.height === dr.height && this.image === dr.image && this.opacity === dr.opacity;\n            }\n        });\n        Drawing.fromJSON = function (args) {\n            return new Drawing(args);\n        };\n        kendo.spreadsheet.Sheet = Sheet;\n        kendo.spreadsheet.Drawing = Drawing;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-tabstrip-item',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-icon',\n            sheetsBarKButton: 'k-button k-icon-button',\n            sheetsBarKButtonDefaults: 'k-button-md k-rounded-md k-button-solid k-button-solid-base',\n            sheetsBarKButtonBare: 'k-button-md k-rounded-md k-button-flat k-button-flat-base',\n            sheetsBarKArrowW: 'k-i-arrow-60-left',\n            sheetsBarKArrowE: 'k-i-arrow-60-right',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-close',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._openDialog = options.openDialog;\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).trigger('focus').on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = kendo.scrollLeft(ul);\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.addClass('k-disabled');\n                    next.addClass('k-disabled');\n                } else {\n                    prev.toggleClass('k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0));\n                    next.toggleClass('k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1));\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        if (sheets.length > 1) {\n                            var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                            elementContent.push(element('span', {\n                                className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove,\n                                'data-type': 'remove'\n                            }, [deleteIcon]));\n                        }\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' });\n                var childrenElements = [\n                    null,\n                    element('ul', { className: classNames.sheetsBarKReset }, sheetElements),\n                    null\n                ];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements[0] = element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: 'k-button-icon' + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]);\n                    childrenElements[2] = element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: 'k-button-icon' + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]);\n                }\n                itemsWrapper.children = childrenElements;\n                return element('div', { className: classNames.sheetsBarItems }, [itemsWrapper]);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                var closeCallback = function (e) {\n                    var dlg = e.sender;\n                    if (dlg.isConfirmed()) {\n                        this.trigger('remove', {\n                            name: removedSheetName,\n                            confirmation: true\n                        });\n                    }\n                }.bind(this);\n                this._openDialog('confirmation', { close: closeCallback });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonDefaults }, [element('span', { className: 'k-button-icon' + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().find('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = kendo.scrollLeft(sheetsGroup);\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS_STANDARD = Object.create(null);\n    var OPERATORS_COMMA = Object.create(null);\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS_STANDARD[op] = ops.length - i;\n                OPERATORS_COMMA[op == ',' ? ';' : op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var OPERATORS = OPERATORS_STANDARD;\n    var SEPARATORS = {\n        DEC: '.',\n        ARG: ',',\n        COL: ','\n    };\n    function setDecimalSeparator(sep) {\n        SEPARATORS.DEC = sep;\n        SEPARATORS.ARG = sep == ',' ? ';' : ',';\n        SEPARATORS.COL = sep == ',' ? '\\\\' : ',';\n        OPERATORS = sep == ',' ? OPERATORS_COMMA : OPERATORS_STANDARD;\n    }\n    exports.withDecimalSeparator = function (sep, f) {\n        if (SEPARATORS.DEC == sep) {\n            return f();\n        }\n        var save = SEPARATORS.DEC;\n        setDecimalSeparator(sep);\n        try {\n            return f();\n        } finally {\n            setDecimalSeparator(save);\n        }\n    };\n    exports._separators = SEPARATORS;\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', SEPARATORS.ARG)) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', SEPARATORS.ARG)) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', SEPARATORS.ARG);\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom() {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom()\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is(null, ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip(null, SEPARATORS.COL);\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value == ';' ? ',' : tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n                return '(kendo.spreadsheet.calc._separators.DEC == \\'.\\' ? ' + JSON.stringify(JSON.stringify(node.value)) + ' : ' + JSON.stringify(JSON.stringify(node.value)) + '.replace(\\'.\\' , kendo.spreadsheet.calc._separators.DEC))';\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    if (/^[,;]/.test(node.op)) {\n                        return left + ' + kendo.spreadsheet.calc._separators.ARG + ' + right;\n                    } else {\n                        return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                    }\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + kendo.spreadsheet.calc._separators.ARG + \\' \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + kendo.spreadsheet.calc._separators.COL + \\' \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'prefix' && prec == OPERATORS[op] && parent.op == '-' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\r\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    var EOF = { type: 'eof' };\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '\\\\!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == SEPARATORS.DEC) {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            if (number == SEPARATORS.DEC) {\n                return {\n                    type: 'punc',\n                    value: SEPARATORS.DEC\n                };\n            } else {\n                return {\n                    type: 'num',\n                    value: parseFloat(number.replace(SEPARATORS.DEC, '.'))\n                };\n            }\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if (!a && !c || a && c) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character with code: ' + ch.charCodeAt(0));\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input, format) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^-?[0-9]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input, format);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            format = null;\n            if (num != Math.floor(num)) {\n                format = '0.' + String(num).split('.')[1].replace(/\\d/g, '0');\n            }\n            return {\n                type: 'number',\n                value: num,\n                format: format\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != 'ref') {\n                throw new ParseError('Expecting a reference but got: ' + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m, date = 0, format = '';\n        if (m = /^(\\d+)([-\\/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input)) {\n            var mo = parseInt(m[1], 10);\n            var sep = m[2];\n            var da = parseInt(m[3], 10);\n            var yr = parseInt(m[4], 10);\n            if (yr < 30) {\n                yr += 2000;\n            } else if (yr < 100) {\n                yr += 1900;\n            }\n            var monthFirst = true;\n            if (mo > 12) {\n                var tmp = mo;\n                mo = da;\n                da = tmp;\n                monthFirst = false;\n            }\n            if (!runtime.validDate(yr, mo, da)) {\n                return null;\n            }\n            date = runtime.packDate(yr, mo - 1, da);\n            if (date < 0) {\n                date--;\n            }\n            if (monthFirst) {\n                format = [\n                    'mm',\n                    'dd',\n                    'yyyy'\n                ].join(sep);\n            } else {\n                format = [\n                    'dd',\n                    'mm',\n                    'yyyy'\n                ].join(sep);\n            }\n            format += m[5];\n            input = input.substr(m[0].length);\n        }\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm',\n                value: date + runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'mm:ss.00',\n                value: date + runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss',\n                value: date + runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss.00',\n                value: date + runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        var has_percent = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '0';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n            has_percent = true;\n            suffix = m[0];\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format = format.replace('0', '#');\n            format += ',0';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        value = parseFloat(value);\n        if (has_percent) {\n            value /= 100;\n        }\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            currency: has_currency,\n            format: format,\n            value: sign * value\n        };\n    });\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input)) {\n            return {\n                type: 'number',\n                value: parseFloat(input) / 100,\n                format: '0.' + repeat('0', m[2].length) + m[3]\n            };\n        }\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    var MAP_EXCEL_OPERATOR = {\n        greaterThanOrEqual: 'greaterThanOrEqualTo',\n        lessThanOrEqual: 'lessThanOrEqualTo'\n    };\n    var ERROR_LOG = null;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    var SEL_VALIDATION = [\n        'dataValidations',\n        'dataValidation'\n    ];\n    var SEL_VALIDATION_FORMULA1 = [\n        'dataValidations',\n        'dataValidation',\n        'formula1'\n    ];\n    var SEL_VALIDATION_FORMULA2 = [\n        'dataValidations',\n        'dataValidation',\n        'formula2'\n    ];\n    var SEL_VALIDATION_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation'\n    ];\n    var SEL_VALIDATION_SQREF_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'xm:sqref'\n    ];\n    var SEL_VALIDATION_FORMULA1_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula1',\n        'xm:f'\n    ];\n    var SEL_VALIDATION_FORMULA2_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula2',\n        'xm:f'\n    ];\n    var SEL_COMMENT = [\n        'commentList',\n        'comment'\n    ];\n    var SEL_AUTHOR = [\n        'authors',\n        'author'\n    ];\n    var SEL_COMMENT_TEXT = ['t'];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            if (!/^xl\\//.test(file)) {\n                file = 'xl/' + file;\n            }\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                    workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (name != '_xlnm._FilterDatabase') {\n                        if (sheet) {\n                            name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                        }\n                        withErrorLog(sheet, null, function () {\n                            workbook.defineName(name, text, bool(attrs.hidden));\n                        }, 'reading user-defined name: ' + name);\n                    }\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return fraction * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * (4 / 3);\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var sharedFormulas = {};\n        var ref, type, value, formula, formulaRange, isArrayFormula;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        var formula1, formula2;\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n        file = xl(file);\n        parse(zip, file, {\n            enter: function (tag, attrs, closed) {\n                var tmp;\n                if (this.is(SEL_FORMULA)) {\n                    if (closed) {\n                        if (attrs.t == 'shared' && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                        }\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    ref = attrs.r;\n                    formulaRange = null;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state && attrs.state.indexOf('frozen') > -1) {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                } else if (this.is(['autoFilter'])) {\n                    filterRef = attrs.ref;\n                    if (closed) {\n                        addAutoFilter();\n                    }\n                } else if (filterRef) {\n                    if (this.is(['filterColumn'])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    } else if (this.is(['customFilters'])) {\n                        customFilterLogic = bool(attrs.and) ? 'and' : 'or';\n                        customFilterCriteria = [];\n                    } else if (this.is(['customFilter'])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    } else if (this.is(['dynamicFilter'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({ type: dynamicFilterType(attrs.type) })\n                        });\n                    } else if (this.is(['top10'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: function (percent, top) {\n                                    return percent && top ? 'topPercent' : top ? 'topNumber' : percent ? 'bottomPercent' : 'bottomNumber';\n                                }(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    } else if (this.is(['filters'])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    } else if (this.is(['filter'])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function (tag, attrs) {\n                if (this.is(SEL_FORMULA)) {\n                    if (!formula && attrs.t == 'shared' && attrs.si != null) {\n                        formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function () {\n                            sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                        }, 'parsing formula');\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION) || this.is(SEL_VALIDATION_INSANE)) {\n                    (function () {\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            type = 'number';\n                        } else if (type == 'list') {\n                            operator = 'list';\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            operator = 'between';\n                        }\n                        refs.forEach(function (ref) {\n                            withErrorLog(sheet, ref, function () {\n                                sheet.range(ref).validation({\n                                    type: bool(attrs.showErrorMessage, true) ? 'reject' : 'warning',\n                                    from: formula1,\n                                    to: formula2,\n                                    dataType: type,\n                                    comparerType: MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls: bool(attrs.allowBlank),\n                                    showButton: bool(attrs.showDropDown) || type == 'date' || type == 'list',\n                                    messageTemplate: attrs.error,\n                                    titleTemplate: attrs.errorTitle\n                                });\n                            }, 'parsing validation');\n                        });\n                    }());\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                } else if (tag == 'autoFilter') {\n                    addAutoFilter();\n                } else if (filterRef) {\n                    if (tag == 'customFilters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == 'filters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    isArrayFormula = attrs.t == 'array';\n                    if (isArrayFormula) {\n                        formulaRange = attrs.ref;\n                    } else if (attrs.t == 'shared') {\n                        sharedFormulas[attrs.si] = ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1) || this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2) || this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                    formula2 = text;\n                } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                    this.stack[this.stack.length - 2].sqref = text;\n                }\n            }\n        });\n        if (relationships.byType.comments) {\n            var commentFile = relative_file(file, relationships.byType.comments[0]);\n            readComments(zip, commentFile, sheet);\n        }\n        if (relationships.byType.drawing) {\n            var drawingFile = relative_file(file, relationships.byType.drawing[0]);\n            readDrawings(zip, drawingFile, sheet);\n        }\n        function addAutoFilter() {\n            sheet.range(filterRef).filter(filters);\n            filterRef = null;\n        }\n    }\n    function getContentType(filename) {\n        var m = /\\.([^.]+)$/.exec(filename);\n        if (m && m[1]) {\n            return {\n                jpg: 'image/jpeg',\n                jpeg: 'image/jpeg',\n                png: 'image/png',\n                gif: 'image/gif'\n            }[m[1].toLowerCase()];\n        }\n    }\n    function getFileName(filename) {\n        var m = /[^\\/]+$/.exec(filename);\n        return m && m[0];\n    }\n    function readDrawings(zip, file, sheet) {\n        var sel_two_cell_anchor = ['xdr:twoCellAnchor'];\n        var sel_ext = ['xdr:ext'];\n        var sel_one_cell_anchor = ['xdr:oneCellAnchor'];\n        var sel_from = ['xdr:from'];\n        var sel_to = ['xdr:to'];\n        var sel_row = ['xdr:row'];\n        var sel_col = ['xdr:col'];\n        var sel_row_offset = ['xdr:rowOff'];\n        var sel_col_offset = ['xdr:colOff'];\n        var sel_blip = [\n            'xdr:blipFill',\n            'a:blip'\n        ];\n        var relsFile = file.replace(/drawings\\//, 'drawings/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        if (relationships.byType.image) {\n            Object.keys(relationships.byId).forEach(function (id) {\n                var img = relative_file(file, relationships.byId[id]);\n                var type = getContentType(img);\n                if (type) {\n                    var data = zip.files[img].asArrayBuffer();\n                    var name = getFileName(img);\n                    var blob = name && !(kendo.support.browser.msie || kendo.support.browser.edge) ? new window.File([data], name, { type: type }) : new window.Blob([data], { type: type });\n                    relationships.byId[id] = sheet._workbook.addImage(blob);\n                }\n            });\n        }\n        var cdr, ref, width, height;\n        parse(zip, file, {\n            enter: function (tag, attrs) {\n                if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                    cdr = {};\n                } else if (this.is(sel_from) || this.is(sel_to)) {\n                    ref = {};\n                } else if (this.is(sel_blip)) {\n                    var id = attrs['r:embed'];\n                    cdr.image = relationships.byId[id];\n                } else if (this.is(sel_ext)) {\n                    width = excelToPixels(parseFloat(attrs.cx));\n                    height = excelToPixels(parseFloat(attrs.cy));\n                }\n            },\n            leave: function () {\n                if (this.is(sel_from)) {\n                    cdr.topLeftCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.offsetX = excelToPixels(ref.colOffset);\n                    cdr.offsetY = excelToPixels(ref.rowOffset);\n                } else if (this.is(sel_to)) {\n                    cdr.brCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.brX = excelToPixels(ref.colOffset);\n                    cdr.brY = excelToPixels(ref.rowOffset);\n                } else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                    var left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                    var top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                    var right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                    var bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n                    sheet.addDrawing({\n                        topLeftCell: cdr.topLeftCell,\n                        offsetX: cdr.offsetX,\n                        offsetY: cdr.offsetY,\n                        width: width != null ? width : right - left,\n                        height: height != null ? height : bottom - top,\n                        image: cdr.image,\n                        opacity: 1\n                    });\n                } else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                    sheet.addDrawing({\n                        topLeftCell: cdr.topLeftCell,\n                        offsetX: cdr.offsetX,\n                        offsetY: cdr.offsetY,\n                        width: width,\n                        height: height,\n                        image: cdr.image,\n                        opacity: 1\n                    });\n                }\n            },\n            text: function (text) {\n                if (this.is(sel_row)) {\n                    ref.row = parseFloat(text);\n                } else if (this.is(sel_col)) {\n                    ref.col = parseFloat(text);\n                } else if (this.is(sel_row_offset)) {\n                    ref.rowOffset = parseFloat(text);\n                } else if (this.is(sel_col_offset)) {\n                    ref.colOffset = parseFloat(text);\n                }\n            }\n        });\n    }\n    function readComments(zip, file, sheet) {\n        var authors = [];\n        var author;\n        var comment;\n        parse(zip, file, {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_COMMENT)) {\n                    comment = {\n                        author: authors[attrs.authorId],\n                        ref: attrs.ref,\n                        text: ''\n                    };\n                } else if (this.is(SEL_AUTHOR)) {\n                    author = '';\n                }\n            },\n            leave: function () {\n                if (this.is(SEL_COMMENT)) {\n                    sheet.range(comment.ref).comment(comment.text);\n                } else if (this.is(SEL_AUTHOR)) {\n                    authors.push(author);\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_COMMENT_TEXT)) {\n                    comment.text += text;\n                } else if (this.is(SEL_AUTHOR)) {\n                    author += text;\n                }\n            }\n        });\n    }\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal: 'eq',\n            notEqual: 'ne',\n            greaterThan: 'gt',\n            greaterThanOrEqual: 'gte',\n            lessThan: 'lt',\n            lessThanOrEqual: 'lte'\n        }[op];\n        value = getFilterVal(value);\n        if (ourOp && typeof value == 'number') {\n            return {\n                operator: ourOp,\n                value: value\n            };\n        }\n        if ((op == 'notEqual' || !op) && typeof value == 'string') {\n            return {\n                operator: op ? 'doesnotmatch' : 'matches',\n                value: value\n            };\n        }\n    }\n    function dynamicFilterType(type) {\n        return {\n            Q1: 'quarter1',\n            Q2: 'quarter2',\n            Q3: 'quarter3',\n            Q4: 'quarter4',\n            M1: 'january',\n            M2: 'february',\n            M3: 'march',\n            M4: 'april',\n            M5: 'may',\n            M6: 'june',\n            M7: 'july',\n            M8: 'august',\n            M9: 'september',\n            M10: 'october',\n            M11: 'november',\n            M12: 'december'\n        }[type.toUpperCase()] || type;\n    }\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch (ex) {\n            var err = {\n                context: context,\n                error: String(ex)\n            };\n            if (sheet && sheet.name) {\n                err.sheet = sheet.name();\n            } else if (sheet) {\n                err.sheet = sheet;\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'indent')) {\n            range.indent(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            if (f.size) {\n                range._property('fontSize', f.size * 4 / 3);\n            }\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n            if (f.underline) {\n                range.underline(true);\n            }\n            if (f.color) {\n                range.color(f.color);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                    if (closed) {\n                        font = null;\n                    }\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    } else if (tag == 'u') {\n                        font.underline = attrs.val == null || attrs.val == 'single';\n                    } else if (tag == 'color') {\n                        font.color = getColor(attrs, null);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                    if (closed) {\n                        fill = null;\n                    }\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                    if (closed) {\n                        border = null;\n                    }\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag)) {\n                        border[tag] = { style: attrs.style || 'none' };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                        if (attrs.indent != null) {\n                            xf.indent = integer(attrs.indent);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs, defaultThemeColor) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return defaultThemeColor;\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    function relative_file(base, name) {\n        base = base.split(/\\/+/);\n        name = name.split(/\\/+/);\n        base.pop();\n        while (name.length) {\n            var part = name.shift();\n            if (part === '') {\n                base = [];\n            } else if (part === '.') {\n                continue;\n            } else if (part === '..') {\n                base.pop();\n            } else {\n                base.push(part);\n            }\n        }\n        return base.join('/');\n    }\n    function excelToPixels(val) {\n        return val / 9525;\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        kendo.spreadsheet.messages.workbook = { defaultSheetName: 'Sheet' };\n        function loadBinary(url, callback) {\n            var xhr = new XMLHttpRequest();\n            xhr.onload = function () {\n                callback(xhr.response, xhr.getResponseHeader('Content-Type'));\n            };\n            xhr.onerror = function () {\n                callback(null);\n            };\n            xhr.open('GET', url);\n            xhr.responseType = 'arraybuffer';\n            xhr.send();\n        }\n        var Workbook = kendo.Observable.extend({\n            options: {},\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._images = {};\n                this._imgID = 0;\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'changing',\n                'change',\n                'excelImport',\n                'excelExport',\n                'insertSheet',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat',\n                'dataBinding',\n                'dataBound',\n                'progress'\n            ],\n            _sheetChanging: function (e) {\n                if (this.trigger('changing', e)) {\n                    e.preventDefault();\n                }\n            },\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetInsertRow: function (e) {\n                if (this.trigger('insertRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetInsertColumn: function (e) {\n                if (this.trigger('insertColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (this.trigger('deleteRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideRow: function (e) {\n                if (this.trigger('hideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideColumn: function (e) {\n                if (this.trigger('hideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideRow: function (e) {\n                if (this.trigger('unhideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _sheetDataBinding: function (e) {\n                if (this.trigger('dataBinding', { sheet: e.sender })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDataBound: function (e) {\n                this.trigger('dataBound', { sheet: e.sender });\n            },\n            _sheetProgress: function (e) {\n                var that = this;\n                setTimeout(function () {\n                    that.trigger('progress', { toggle: e.toggle });\n                });\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                var self = this;\n                return self._sheet.withCultureDecimals(function () {\n                    return new kendo.spreadsheet.Range(ref, self._sheet).input();\n                });\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else {\n                    command.range(sheet.selection());\n                }\n                if (commandOptions.editRange) {\n                    command._editRange = commandOptions.editRange;\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (!command.cannotUndo) {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                this.cleanupImages();\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = kendo.spreadsheet.messages.workbook.defaultSheetName + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth, options.defaultCellStyle || this.options.defaultCellStyle);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                this._bindSheetEvents(sheet);\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            _bindSheetEvents: function (sheet) {\n                sheet.bind('changing', this._sheetChanging.bind(this));\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('insertRow', this._sheetInsertRow.bind(this));\n                sheet.bind('insertColumn', this._sheetInsertColumn.bind(this));\n                sheet.bind('deleteRow', this._sheetDeleteRow.bind(this));\n                sheet.bind('deleteColumn', this._sheetDeleteColumn.bind(this));\n                sheet.bind('hideRow', this._sheetHideRow.bind(this));\n                sheet.bind('hideColumn', this._sheetHideColumn.bind(this));\n                sheet.bind('unhideRow', this._sheetUnhideRow.bind(this));\n                sheet.bind('unhideColumn', this._sheetUnhideColumn.bind(this));\n                sheet.bind('select', this._sheetSelect.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n                sheet.bind('dataBinding', this._sheetDataBinding.bind(this));\n                sheet.bind('dataBound', this._sheetDataBound.bind(this));\n                sheet.bind('progress', this._sheetProgress.bind(this));\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (this.trigger('renameSheet', {\n                        sheet: sheet,\n                        newSheetName: newSheetName\n                    })) {\n                    return;\n                }\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                if (this.trigger('removeSheet', { sheet: sheet })) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i]._activeDrawing = [];\n                    this._sheets[i]._drawings = [];\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n                this._images = {};\n                this._imgID = 0;\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    if (json.images) {\n                        this._imgID = 0;\n                        this._images = {};\n                        Object.keys(json.images).forEach(function (id) {\n                            if (!isNaN(id)) {\n                                var num = parseFloat(id);\n                                if (isFinite(num)) {\n                                    this._imgID = Math.max(this._imgID, num);\n                                }\n                            }\n                            this._images[id] = { url: json.images[id] };\n                        }, this);\n                    }\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n            saveJSON: function () {\n                var self = this;\n                var deferred = new $.Deferred();\n                var data = self.toJSON();\n                var ids = Object.keys(self._images).filter(function (id) {\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                data.images = {};\n                if (count) {\n                    ids.forEach(function (id) {\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function () {\n                                data.images[id] = reader.result;\n                                next();\n                            };\n                            reader.readAsDataURL(img.blob);\n                        } else {\n                            data.images[id] = img.url;\n                            next();\n                        }\n                    });\n                } else {\n                    next();\n                }\n                return deferred.promise();\n                function next() {\n                    if (--count <= 0) {\n                        deferred.resolve(data);\n                    }\n                }\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                var self = this;\n                options = $.extend({}, self.options.excel, options);\n                var data = self.toJSON();\n                if (self.trigger('excelExport', { workbook: data })) {\n                    return;\n                }\n                var ids = Object.keys(self._images).filter(function (id) {\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                var images = count ? {} : null;\n                if (count) {\n                    ids.forEach(function (id) {\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function () {\n                                images[id] = {\n                                    type: img.blob.type,\n                                    name: img.blob.name,\n                                    data: reader.result\n                                };\n                                next();\n                            };\n                            reader.readAsArrayBuffer(img.blob);\n                        } else {\n                            loadBinary(img.url, function (data, type) {\n                                images[id] = {\n                                    type: type,\n                                    data: data\n                                };\n                                next();\n                            });\n                        }\n                    });\n                } else {\n                    next();\n                }\n                function next() {\n                    if (--count <= 0) {\n                        data.images = images;\n                        var workbook = new kendo.ooxml.Workbook(data);\n                        kendo.saveAs({\n                            dataURI: options.forceProxy ? workbook.toDataURL() : workbook.toBlob(),\n                            fileName: data.fileName || options.fileName,\n                            proxyURL: options.proxyURL,\n                            forceProxy: options.forceProxy\n                        });\n                    }\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            addImage: function (image) {\n                var id = String(++this._imgID);\n                if (typeof image == 'string') {\n                    this._images[id] = { url: image };\n                } else {\n                    this._images[id] = { blob: image };\n                }\n                return id;\n            },\n            imageUrl: function (id) {\n                var img = this._images[id];\n                var url = img.url;\n                if (!url) {\n                    url = img.url = window.URL.createObjectURL(img.blob);\n                }\n                return url;\n            },\n            cleanupImages: function () {\n                Object.keys(this._images).forEach(function (id) {\n                    if (!this.usesImage(id)) {\n                        var url = this._images[id].url;\n                        if (url) {\n                            window.URL.revokeObjectURL(url);\n                        }\n                        delete this._images[id];\n                    }\n                }, this);\n            },\n            usesImage: function (img) {\n                var i;\n                var sheets = this._sheets;\n                for (i = sheets.length; --i >= 0;) {\n                    if (sheets[i].usesImage(img)) {\n                        return 1;\n                    }\n                }\n                var stack = this.undoRedoStack.stack;\n                for (i = stack.length; --i >= 0;) {\n                    if (stack[i].usesImage(img)) {\n                        return 2;\n                    }\n                }\n                return false;\n            }\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return options.forceProxy ? kendo.pdf.exportPDF(root) : kendo.pdf.exportPDFToBlob(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (wantNulls || formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (wantNulls || formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        isMerged: function (ref) {\n            var sheet = this.workbook.sheetByName(ref.sheet);\n            return sheet.isMerged(ref);\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol, wantNulls) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            var arrayRange = f.arrayFormulaRange;\n            if (arrayRange) {\n                var tlRow, tlCol;\n                var width = value.width;\n                var height = value.height;\n                sheet.forEach(arrayRange, function (row, col) {\n                    if (tlRow === undefined) {\n                        tlRow = row;\n                        tlCol = col;\n                    }\n                    var vrow = row - tlRow;\n                    var vcol = col - tlCol;\n                    var val;\n                    if (vrow < height && vcol < width) {\n                        val = value.get(vrow, vcol);\n                    } else {\n                        val = new kendo.spreadsheet.calc.runtime.CalcError('N/A');\n                    }\n                    sheet._value(row, col, val);\n                });\n            } else {\n                if (value instanceof Ref) {\n                    value = this.getData(value, f.sheet, row, col);\n                    if (Array.isArray(value)) {\n                        value = value[0];\n                    }\n                    if (value === undefined) {\n                        value = null;\n                    }\n                }\n                if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    value = value.get(0, 0);\n                }\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'end': 'last-col',\n            'ctrl+left': 'word-left',\n            'ctrl+right': 'word-right',\n            'ctrl+up': 'word-up',\n            'ctrl+down': 'word-down',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            'alt+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            'pageup': 'onPageUp',\n            'pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur',\n            'shift+ctrl+enter': 'onEditorArrayFormula'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.drawingContextMenu = view.drawingContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                $(view.scroller).on('mousedown', this.onMouseDown.bind(this));\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.drawingContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).add(this.drawingContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === 'error') {\n                        this.editor.deactivate(true);\n                        this.view.showError(result, function () {\n                            this.activateEditor(false);\n                            this.editor.value(this._lastEditorValue);\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'delete-drawing':\n                    command = {\n                        command: 'DeleteDrawingCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'bring-to-front':\n                    command = {\n                        command: 'BringToFrontCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'send-to-back':\n                    command = {\n                        command: 'SendToBackCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    if (this._workbook.trigger('insertSheet')) {\n                        return;\n                    }\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger('selectSheet', { sheet: sheet })) {\n                        return;\n                    }\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var workbook = this._workbook;\n                var sheet = workbook.sheetByIndex(e.oldIndex);\n                var activeSheet = workbook.activeSheet();\n                var activeSheetName = activeSheet.name();\n                workbook.moveSheetToIndex(sheet, e.newIndex);\n                if (activeSheetName !== sheet.name()) {\n                    if (workbook.trigger('selectSheet', { sheet: sheet })) {\n                        workbook.activeSheet(activeSheet);\n                        return;\n                    }\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    this.resetEditorValue();\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render({ scroll: true });\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                var sheet = this._workbook.activeSheet();\n                sheet._activeDrawing = null;\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                var sheet = this._workbook.activeSheet();\n                if (event.mod) {\n                    var key = String.fromCharCode(event.keyCode);\n                    var shouldPrevent = true;\n                    switch (key) {\n                    case 'A':\n                        sheet._activeDrawing = null;\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = sheet.selection().enable() === false;\n                    var casual = action !== ':edit';\n                    if (action == 'delete' || action == 'backspace') {\n                        if (sheet._activeDrawing) {\n                            this._execute({\n                                command: 'DeleteDrawingCommand',\n                                options: { drawing: sheet._activeDrawing }\n                            });\n                        } else if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || !casual) {\n                        sheet._activeDrawing = null;\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (casual) {\n                            this.editor.value('');\n                        }\n                        this.activateEditor(casual);\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n                sheet._renderComment(object.type == 'cell' ? object.ref : null);\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this._startResizingDrawing(event, object)) {\n                    event.stopPropagation();\n                    return;\n                }\n                var sheet = this._workbook.activeSheet();\n                var win = this.container.closest('[' + kendo.attr('role') + '=\"window\"]');\n                if (win.length) {\n                    win = kendo.widgetInstance(win);\n                    if (win && win.options.modal) {\n                        event.stopPropagation();\n                    }\n                }\n                sheet._activeDrawing = null;\n                if (object.type === 'drawing') {\n                    sheet._activeDrawing = object.drawing;\n                    object.copy = object.drawing.clone();\n                    object.startBox = sheet.drawingBoundingBox(object.copy);\n                    sheet.startDragging(object);\n                    sheet.triggerChange({ dragging: true });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;\n                    }\n                }\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n            },\n            _startResizingDrawing: function (event) {\n                var handle = $(event.target).closest('.k-spreadsheet-drawing-handle');\n                if (handle.length) {\n                    var location = this.translateCoords(event);\n                    var direction = handle.data('direction');\n                    var sheet = this._workbook.activeSheet();\n                    var drawing = sheet._activeDrawing;\n                    sheet.startDragging({\n                        pane: this.originFrame,\n                        drawing: drawing,\n                        copy: drawing.clone(),\n                        startBox: sheet.drawingBoundingBox(drawing),\n                        resize: direction,\n                        startX: location.x,\n                        startY: location.y\n                    });\n                    return true;\n                }\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                event.preventDefault();\n                if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n                    return;\n                }\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                this.drawingContextMenu.close();\n                var menu;\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                if (object.ref) {\n                    this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                } else if (object.type == 'drawing') {\n                    this.navigator.selectDrawingForContextMenu(object.drawing);\n                }\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else if (object.type == 'drawing') {\n                    menu = this.drawingContextMenu;\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            _dragDrawing: function (event) {\n                var sheet = this._workbook.activeSheet();\n                var drag = sheet.draggingInProgress();\n                if (!drag) {\n                    return false;\n                }\n                var location = this.translateCoords(event);\n                var drawing = drag.drawing;\n                var deltaX = location.x - drag.startX;\n                var deltaY = location.y - drag.startY;\n                if (drag.resize == 'SE') {\n                    if (drag.aspect) {\n                        if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                            drawing.height = drawing.width / drag.aspect;\n                        } else {\n                            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                            drawing.width = drawing.height * drag.aspect;\n                        }\n                    } else {\n                        drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                        drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    }\n                } else if (drag.resize == 'E') {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                } else if (drag.resize == 'S') {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                } else if (drag.resize == 'N') {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                } else if (drag.resize == 'W') {\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else if (drag.resize == 'NE') {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                } else if (drag.resize == 'SW') {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else if (drag.resize == 'NW') {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else {\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n                sheet.triggerChange({ dragging: true });\n                return true;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    clientX: event.clientX,\n                    clientY: event.clientY\n                };\n                var sheet = this._workbook.activeSheet();\n                if (this._dragDrawing(event)) {\n                    return;\n                }\n                var object = this.objectAt(location);\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        kendo.scrollLeft(this);\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                sheet.completeDragging();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                var sel = this._workbook.activeSheet().selection();\n                this.activateEditor(!sel.value() && !sel.formula());\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                var self = this;\n                setTimeout(function () {\n                    self.clipboard.menuInvoked = e === undefined;\n                    self._execute({\n                        command: 'CutCommand',\n                        options: {\n                            workbook: self.view._workbook,\n                            event: e.originalEvent || e\n                        }\n                    });\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            _pasteImage: function (blob) {\n                var self = this;\n                var img = new window.Image();\n                img.src = window.URL.createObjectURL(blob);\n                img.onload = function () {\n                    self._execute({\n                        command: 'InsertImageCommand',\n                        options: {\n                            blob: blob,\n                            width: img.width,\n                            height: img.height\n                        }\n                    });\n                };\n                setTimeout(function () {\n                    window.URL.revokeObjectURL(img.src);\n                }, 10);\n            },\n            onPaste: function (e) {\n                var self = this;\n                var html = '';\n                var plain = '';\n                self.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    var clipboardData = e.originalEvent.clipboardData;\n                    if (clipboardData && clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = clipboardData.types.contains('text/html');\n                            hasPlainText = clipboardData.types.contains('text/plain');\n                        } else if (Array.isArray(clipboardData.types)) {\n                            hasHTML = clipboardData.types.indexOf('text/html') >= 0;\n                            hasPlainText = clipboardData.types.indexOf('text/plain') >= 0;\n                        } else {\n                            hasHTML = /text\\/html/.test(clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = clipboardData.getData('text/html').trim();\n                        }\n                        if (hasPlainText) {\n                            plain = clipboardData.getData('text/plain').trim();\n                        }\n                        if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                            for (var i = 0; i < clipboardData.items.length; ++i) {\n                                var item = clipboardData.items[i];\n                                if (item.kind == 'file' && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                                    return self._pasteImage(item.getAsFile());\n                                }\n                            }\n                        }\n                    } else {\n                        if (window.clipboardData.files && window.clipboardData.files.length) {\n                            var file = window.clipboardData.files[0];\n                            if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                                return self._pasteImage(file);\n                            }\n                        }\n                        plain = window.clipboardData.getData('Text');\n                        if (plain) {\n                            plain = plain.trim();\n                        }\n                        self.clipboardElement.empty();\n                        setTimeout(function () {\n                            html = self.clipboardElement.html();\n                            if (html || plain) {\n                                self.clipboard.external({\n                                    html: html,\n                                    plain: plain\n                                });\n                                self._execute({\n                                    command: 'PasteCommand',\n                                    options: {\n                                        workbook: self.view._workbook,\n                                        event: e.originalEvent || e\n                                    }\n                                });\n                            }\n                        });\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        self.clipboardElement.trigger('focus').select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        self.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                self.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                self._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: self.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            translateCoords: function (location) {\n                var box = this.container[0].getBoundingClientRect();\n                return {\n                    x: location.clientX - box.left,\n                    y: location.clientY - box.top\n                };\n            },\n            objectAt: function (location, noDrawing) {\n                if (!location) {\n                    return;\n                }\n                location = this.translateCoords(location);\n                return this.view.objectAt(location.x, location.y, noDrawing);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation, true);\n                if (object.pane && object.ref) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            _saveEditorValue: function (arrayFormula) {\n                var sheet = this.editor._range.sheet();\n                var value = this.editor.value();\n                if (this._workbook.activeSheet() !== sheet) {\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = value;\n                this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        value: value,\n                        arrayFormula: arrayFormula\n                    }\n                });\n            },\n            onEditorChange: function () {\n                this._saveEditorValue(false);\n            },\n            onEditorArrayFormula: function () {\n                this._saveEditorValue(true);\n                this.editor.deactivate(true);\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.trigger('focus');\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (!this._preventNavigation) {\n                    this.clipboardElement.trigger('focus');\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                    this.deactivateEditor();\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    event.preventDefault();\n                } else if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                var sheet = this._workbook.activeSheet();\n                var ref = sheet.activeCell();\n                var input = this._workbook._inputForRef(ref);\n                var x = sheet.range(ref).intersectingArrayFormula();\n                if (x) {\n                    input = '=' + x.formula;\n                }\n                this.editor.value(input, !!x);\n            },\n            activateEditor: function (casual) {\n                this._casualEditing = casual;\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n            deactivateEditor: function () {\n                this.view.editor.deactivate();\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.trigger('focus');\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.trigger('focus');\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.trigger('focus');\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.trigger('focus');\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var EDIT_BUTTON_WIDTH = 20;\n        var ERROR = 'Error';\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonSelected: 'k-selected',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon',\n            iconFilterDefault: 'k-i-arrow-60-down',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu',\n            drawingContextMenu: 'k-spreadsheet-drawing-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            nameBox: 'Name Box',\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                insertColumnWhenRowIsSelected: 'Cannot insert column when all columns are selected.',\n                insertRowWhenColumnIsSelected: 'Cannot insert row when all rows are selected.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                cantSortMultipleSelection: 'Cannot sort multiple selection',\n                cantSortNullRef: 'Cannot sort empty selection',\n                cantSortMixedCells: 'Cannot sort range containing cells of mixed shapes',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.',\n                insertRowBelowLastRow: 'Cannot insert row below the last row.',\n                insertColAfterLastCol: 'Cannot insert column to the right of the last column.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        kendo.spreadsheet.messages.menus = {\n            'cut': 'Cut',\n            'copy': 'Copy',\n            'paste': 'Paste',\n            'merge': 'Merge',\n            'unmerge': 'Unmerge',\n            'delete': 'Delete',\n            'hide': 'Hide',\n            'unhide': 'Unhide',\n            'bringToFront': 'Bring to front',\n            'sendToBack': 'Send to back'\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return (value.size || 1) + 'px solid ' + (value.color || '#000');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            var shouldDraw = cell.value != null || cell.validation != null && !cell.validation.value || cell.background || cell.merged || cell.comment;\n            if (!cls && !shouldDraw) {\n                return;\n            }\n            var style = {};\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.overflowWrap = 'break-word';\n                style.wordWrap = 'break-word';\n            } else {\n                style.whiteSpace = 'pre';\n                style.overflowWrap = 'normal';\n                style.wordWrap = 'normal';\n            }\n            style.left = cell.left + 1 + 'px';\n            style.top = cell.top + 1 + 'px';\n            style.width = cell.width - 1 + 'px';\n            style.height = cell.height - 1 + 'px';\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                if (cell.html) {\n                    data = kendo.dom.html(data);\n                } else {\n                    data = kendo.dom.text(data);\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            kendo.spreadsheet.draw.applyIndent(cell, style);\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            if (cell.comment) {\n                classNames.push('k-spreadsheet-has-comment');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation.message;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className,\n                    role: 'presentation'\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>#: messages.merge #</li>' + '<li data-action=unmerge>#: messages.unmerge #</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">#: messages.delete #</li>' + '<li data-action=\"hide-row\">#: messages.hide #</li>' + '<li data-action=\"unhide-row\">#: messages.unhide #</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">#: messages.delete #</li>' + '<li data-action=\"hide-column\">#: messages.hide #</li>' + '<li data-action=\"unhide-column\">#: messages.unhide #</li>' + '</ul>';\n        var DRAWING_CONTEXT_MENU = '<ul class=\"#=classNames.drawingContextMenu#\">' + '<li data-action=\"bring-to-front\">#: messages.bringToFront #</li>' + '<li data-action=\"send-to-back\">#: messages.sendToBack #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-drawing\">#: messages.delete #</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU + DRAWING_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({\n                    classNames: classNames,\n                    messages: kendo.spreadsheet.messages.menus\n                }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                this.drawingContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.drawingContextMenu), contextMenuConfig);\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var actionBar = $(this.formulaBar.element).parents('.k-spreadsheet-action-bar');\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, { openDialog: this.openDialog.bind(this) }, this.options.sheetsbar);\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                workbook._view = this;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, col) {\n                x -= this._sheet._grid._headerWidth;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                col = this._sheet._grid._columns.locate(0, col, function (w) {\n                    return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n            },\n            isRowResizer: function (y, pane, row) {\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                row = this._sheet._grid._rows.locate(0, row, function (h) {\n                    return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var self = this;\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n                x -= self._sheet._grid._headerWidth - scrollLeft;\n                y -= self._sheet._grid._headerHeight - scrollTop;\n                return kendo.util.withExit(function (exit) {\n                    self._sheet.forEachFilterHeader(ref, function (ref) {\n                        var rect = self._rectangle(pane, ref);\n                        if (pane.filterIconRect(rect).intersects(x, y)) {\n                            exit(true);\n                        }\n                    });\n                });\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y, pane) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    if (y >= r.top && y <= r.bottom) {\n                        return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n                    }\n                }\n            },\n            drawingAt: function (x, y, pane) {\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var sheet = this._sheet;\n                var drawings = this._sheet._drawings;\n                for (var i = drawings.length; --i >= 0;) {\n                    var d = drawings[i];\n                    var box = sheet.drawingBoundingBox(d);\n                    if (box.intersects(x, y)) {\n                        return {\n                            drawing: d,\n                            drx: box.left - x,\n                            dry: box.top - y\n                        };\n                    }\n                }\n            },\n            objectAt: function (x, y, noDrawing) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        if (!noDrawing) {\n                            var drawing = this.drawingAt(x, y, pane);\n                            if (drawing) {\n                                return {\n                                    type: 'drawing',\n                                    drawing: drawing.drawing,\n                                    drx: drawing.drx,\n                                    dry: drawing.dry,\n                                    pane: pane,\n                                    startX: x,\n                                    startY: y\n                                };\n                            }\n                        }\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            type = 'rowheader';\n                            if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                                ref = new CellRef(row, -Infinity);\n                                type = 'rowresizehandle';\n                            }\n                        } else if (!selecting && y < grid._headerHeight) {\n                            type = 'columnheader';\n                            if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                                ref = new CellRef(-Infinity, column);\n                                type = 'columnresizehandle';\n                            }\n                        } else if (this.isEditButton(x, y, pane)) {\n                            type = 'editor';\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipboardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                editRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                return sheet.withCultureDecimals(function () {\n                    var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                    if (dialog) {\n                        dialog.bind('action', this._executeCommand.bind(this));\n                        dialog.bind('deactivate', this._destroyDialog.bind(this));\n                        this._dialogs.push(dialog);\n                        var ref = sheet.activeCell();\n                        var range = new kendo.spreadsheet.Range(ref, sheet);\n                        dialog.open(range);\n                        return dialog;\n                    }\n                }.bind(this));\n            },\n            showError: function (options, reopenEditor) {\n                var currentDialogs = this._dialogs;\n                var errorMessages = this.options.messages.errors;\n                var hasOpenedError = false;\n                if (currentDialogs.length > 0) {\n                    currentDialogs.forEach(function (dialog) {\n                        if (dialog.options && dialog.options.title === ERROR) {\n                            hasOpenedError = true;\n                        }\n                    });\n                }\n                if (hasOpenedError) {\n                    return;\n                }\n                var focusButton = function (e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find('.k-button').first().trigger('focus');\n                    cont.find('.k-button, input').on('keydown', function (ev) {\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n                var onClose = function (e) {\n                    var dlg = e.sender;\n                    this.selectClipboardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: onClose };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                this.drawingContextMenu.destroy();\n                this.cellContextMenu = this.rowHeaderContextMenu = this.colHeaderContextMenu = this.drawingContextMenu = null;\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.tabstrip = null;\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function (reason) {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                var scrollbarSize = kendo.support.scrollbar();\n                var contentWidth = this.wrapper[0].clientWidth - scrollbarSize;\n                var contentHeight = this.wrapper[0].clientHeight - scrollbarSize;\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var content = [];\n                var args = {\n                    scroller: this.scroller,\n                    toplevelElements: content,\n                    contentWidth: contentWidth,\n                    contentHeight: contentHeight\n                };\n                this.panes.forEach(function (pane) {\n                    content.push(pane.render(args));\n                });\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                content.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    content.push(this.renderResizeHint());\n                }\n                this.tree.render(content);\n                $(this.container).css({\n                    width: contentWidth,\n                    height: contentHeight\n                });\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!(reason.resize || reason.comment || sheet.selectionInProgress() || sheet.resizingInProgress() || sheet.draggingInProgress() || sheet.isInEditMode())) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = grid.normalize(sheet.select().toRangeRef());\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipboardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                if (kendo.support.browser.msie) {\n                    this.clipboard.empty();\n                }\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipboardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            vborder: 'k-spreadsheet-vborder',\n            hborder: 'k-spreadsheet-hborder',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (args) {\n                var scroller = args.scroller;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData(args));\n                if (!sheet._activeDrawing) {\n                    children.push(this.renderSelection(scroller));\n                }\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    if (!sheet.resizeHintPosition()) {\n                        this.renderResizeHandle(children);\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function (args) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var grid = this._grid;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                var activeCellRange = sheet.activeCell().toRangeRef();\n                var activeCell = activeCellRange.topLeft;\n                layout.cells.forEach(function (cell) {\n                    var cls = null;\n                    var absRow = cell.row + view.ref.topLeft.row;\n                    var absCol = cell.col + view.ref.topLeft.col;\n                    if (sheet._activeDrawing) {\n                        var ref = sheet._activeDrawing.topLeftCell;\n                        if (ref && ref.row == absRow && ref.col == absCol) {\n                            cls = 'k-spreadsheet-drawing-anchor-cell';\n                        }\n                    } else if (absRow == activeCell.row && absCol == activeCell.col) {\n                        cls = [Pane.classNames.activeCell].concat(this._activeFormulaColor(), this._directionClasses(activeCellRange));\n                        if (sheet.singleCellSelection()) {\n                            cls.push(Pane.classNames.single);\n                        }\n                        cls = cls.join(' ');\n                    }\n                    borders.add(cell);\n                    drawCell(cont.children, cell, cls, showGridLines);\n                    if (cell.comment && sheet._commentRef && absRow == sheet._commentRef.row && absCol == sheet._commentRef.col) {\n                        var ttOffset = 4;\n                        var left = cell.right + grid.left + view.columnOffset + ttOffset;\n                        var style = { top: cell.top + grid.top + view.rowOffset + 'px' };\n                        if (left + 200 > args.contentWidth) {\n                            style.right = args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset + 'px';\n                        } else {\n                            style.left = left + 'px';\n                        }\n                        var div = kendo.dom.element('div', {\n                            className: 'k-tooltip k-spreadsheet-cell-comment',\n                            style: style\n                        }, [kendo.dom.text(cell.comment)]);\n                        args.toplevelElements.push(div);\n                    }\n                }, this);\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left: b.x + 'px',\n                                top: b.top + 'px',\n                                height: b.bottom - b.top + 1 + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateX(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top: b.y + 'px',\n                                left: b.left + 'px',\n                                width: b.right - b.left + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateY(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                this.renderDrawings(layout, cont.children);\n                return cont;\n            },\n            renderDrawings: function (layout, container) {\n                var sheet = this._sheet;\n                var workbook = sheet._workbook;\n                layout.drawings.forEach(function (d) {\n                    var drawing = d.drawing;\n                    var box = d.box;\n                    var div = box.toDiv('k-spreadsheet-drawing');\n                    if (drawing.image) {\n                        div.children.push(kendo.dom.element('div', {\n                            className: 'k-spreadsheet-drawing-image',\n                            style: {\n                                backgroundImage: 'url(\\'' + workbook.imageUrl(drawing.image) + '\\')',\n                                opacity: drawing.opacity\n                            }\n                        }));\n                    }\n                    if (drawing === sheet._activeDrawing) {\n                        div.attr.className += ' k-spreadsheet-active-drawing';\n                        drawingResizeHandles(div.children);\n                    }\n                    container.push(div);\n                });\n            },\n            renderResizeHandle: function (container) {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    if (this._grid.rows._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    if (this._grid.columns._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                container.push(kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                }));\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonSelected;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function (scroller) {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var selection = sheet.select();\n                selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._renderCustomEditorButton(selections, activeCell, scroller);\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _renderCustomEditorButton: function (collection, ref, scroller) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                var ed = sheet.activeCellCustomEditor();\n                if (ed && view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        var btnClass = 'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button';\n                        var isLastColumn = col == columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                        if (isLastColumn) {\n                            btnClass += ' k-spreadsheet-last-column';\n                        }\n                        self._editorInLastColumn = isLastColumn;\n                        var btn = kendo.dom.element('div', {\n                            className: btnClass,\n                            style: {\n                                left: cell.left + (isLastColumn ? 0 : cell.width) + 'px',\n                                top: cell.top + 'px',\n                                height: cell.height + 'px'\n                            }\n                        });\n                        if (ed.icon) {\n                            btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                        }\n                        collection.push(btn);\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            },\n            _buttonOutOfVisiblePane: function (row, col, scroller) {\n                var self = this;\n                var theGrid = self._grid;\n                var sheet = self._sheet;\n                var ref = sheet.range(row, col)._ref;\n                var boundaries = theGrid.scrollBoundaries(ref);\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n                    return true;\n                }\n            }\n        });\n        function drawingResizeHandles(container) {\n            [\n                'N',\n                'NE',\n                'E',\n                'SE',\n                'S',\n                'SW',\n                'W',\n                'NW'\n            ].forEach(function (direction) {\n                container.push(kendo.dom.element('div', {\n                    'className': 'k-spreadsheet-drawing-handle ' + direction,\n                    'data-direction': direction\n                }));\n            });\n        }\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        var $ = kendo.jQuery;\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                var sheet = context.range.sheet();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    var fromValidation = val.from;\n                    var toValidation = val.to;\n                    var formula = kendo.spreadsheet.calc.runtime.Formula;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        if (fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                        }\n                    }\n                    if (val.comparerType == 'between') {\n                        if (toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.to.value);\n                        }\n                    }\n                    if (val.comparerType == 'lessThan' || val.comparerType == 'lessThanOrEqualTo') {\n                        if (fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.from.value);\n                        }\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from, to;\n                            if (fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                                from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                            } else {\n                                from = fromValidation ? fromValidation.value | 0 : 0;\n                            }\n                            if (toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                                to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                            } else {\n                                to = toValidation ? toValidation.value | 0 : 0;\n                            }\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            function _rowAndColPresent(value) {\n                return value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1;\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<ul class=\\'k-list k-reset\\'/>').kendoStaticList({\n                        template: '#:value#',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div class=\\'k-spreadsheet-list-popup\\'>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function (el) {\n                        data.push({ value: el });\n                    };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    (items + '').split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-60-down'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function Rectangle(left, top, width, height) {\n                this.left = left;\n                this.top = top;\n                this.width = width;\n                this.height = height;\n                this.right = this.left + this.width;\n                this.bottom = this.top + this.height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                if (x instanceof Rectangle) {\n                    return this.intersectsRect(x);\n                }\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            intersectsRect: function (b) {\n                var a = this;\n                return a.left <= b.right && b.left <= a.right && a.top <= b.bottom && b.top <= a.bottom;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    var value = el[field];\n                    if (value === 0) {\n                        this._hidden.value(index, index, el.hidden || this._value);\n                        this.value(index, index, 0);\n                    } else {\n                        this.value(index, index, value);\n                    }\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index) {\n                var end = this._count - 1, i = index;\n                while (++i <= end) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            nextUntil: function (index, pred) {\n                var end = this._count - 1, i = index, advanced = false;\n                while (++i <= end) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == 'number') {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i - 1;\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index) {\n                var i = index;\n                while (--i >= 0) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            prevUntil: function (index, pred) {\n                var i = index, advanced = false;\n                while (--i >= 0) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == 'number') {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i + 1;\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            locate: function (start, end, predicate) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                    var val = predicate(sum);\n                    if (val) {\n                        return idx;\n                    }\n                }\n                return null;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            indexVisible: function (value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            indexVisible: function (value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria,\n                    accentFoldingFiltering: kendo.culture().name\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var util = kendo.util;\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val,\n                        custom: true\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n        var scaleCount = 0;\n        var code = 'var intPart, decPart, isNegative, date, time; ';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            if (!condition.custom) {\n                code += 'value = Math.abs(value); ';\n            }\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n            code += 'isNegative = parseInt(intPart[0]) < 0;';\n        }\n        if (decFormat.length) {\n            code += 'decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        code += 'var matchedCurrency = false;';\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                if (currency.test(tok.value)) {\n                    code += 'type = \\'currency\\'; ';\n                    code += 'if (isNegative) { output += \\'-\\'; matchedCurrency = true; }';\n                }\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace(\\'-\\', \\'\\');}';\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    var compile = util.memoize(function (format) {\n        var tree = parse(format);\n        var code = tree.map(compileFormatPart);\n        code.push(TEXT);\n        code = code.join('\\n');\n        code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n        return new Function('runtime', code)(runtime);\n    });\n    var makeDateFormat = util.memoize(function (format) {\n        var tree = parse(format);\n        var section, found = false, hasAmpm = false;\n        for (var i = 0; i < tree.length; ++i) {\n            section = tree[i];\n            for (var j = 0; j < section.body.length; ++j) {\n                if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                    found = true;\n                    if (section.body[j].type == 'ampm') {\n                        hasAmpm = true;\n                    }\n                }\n            }\n            if (found) {\n                break;\n            }\n        }\n        if (!found) {\n            return null;\n        }\n        return section.body.map(printToken).join('');\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += padLeft('', Math.max(tok.fraction, 3), 'f');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                var part = tok.part;\n                if (tok.type == 'date' && /^m/.test(part)) {\n                    part = 'M';\n                } else if (tok.type == 'time' && /^h/.test(part)) {\n                    if (!hasAmpm) {\n                        part = part.toUpperCase();\n                    }\n                }\n                return maybeFraction(padLeft('', tok.format, part), tok);\n            } else if (tok.type == 'ampm') {\n                return 'tt';\n            } else if (tok.type == 'str') {\n                return tok.value;\n            } else if (tok.type == 'space') {\n                return ' ';\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            } else {\n                return '';\n            }\n        }\n    });\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = runtime.toFixed(value, declen).replace(/\\..*$/, '');\n            var lastPart = parts[parts.length - 1];\n            if (declen > 0 && lastPart[parts.length - 1] != '0') {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var shouldInsertMinus = false;\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch, skipMinus) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                if (skipMinus && ch === '-') {\n                    shouldInsertMinus = true;\n                    ch = '0';\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        if (value == '0' && chf == '?') {\n                            add(' ');\n                        } else if (chf == '0') {\n                            add(value.charAt(iv), true);\n                        } else {\n                            add(value.charAt(iv));\n                        }\n                        iv--;\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            if (shouldInsertMinus) {\n                result[0] = '-' + result[0];\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = runtime.toFixed(value, declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        },\n        toFixed: function (value, decimals) {\n            return function toFixed(value, last) {\n                if (!isFinite(value)) {\n                    return '#NUM!';\n                }\n                if (value < 0) {\n                    return '-' + toFixed(-value);\n                }\n                if (decimals === 0) {\n                    return String(Math.round(value));\n                }\n                if (value === Math.round(value) && !/e/i.test(String(value))) {\n                    return value.toFixed(decimals);\n                }\n                var num = digNumber(value);\n                var intpart = num.intpart;\n                var decpart = num.decpart;\n                if (decpart.length <= decimals) {\n                    while (decpart.length < decimals) {\n                        decpart += '0';\n                    }\n                    return intpart + '.' + decpart;\n                }\n                if (last) {\n                    return intpart + '.' + decpart.substr(0, decimals);\n                }\n                var f = Math.pow(10, decimals);\n                return toFixed(Math.round(value * f) / f, true);\n            }(Number(value.toFixed(14)));\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function padRight(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val += ch;\n        }\n        return val;\n    }\n    function digNumber(num) {\n        var str = String(num).toLowerCase();\n        var intpart, decpart, m;\n        var pos = str.indexOf('.');\n        if (pos < 0) {\n            pos = str.indexOf('e');\n            if (pos < 0) {\n                intpart = str;\n                decpart = '';\n            } else {\n                intpart = str.substr(0, pos);\n                decpart = str.substr(pos);\n            }\n        } else {\n            intpart = str.substr(0, pos);\n            decpart = str.substr(pos + 1);\n        }\n        if (m = /(\\d*)e([-+]?\\d+)/.exec(decpart)) {\n            var exp = parseInt(m[2], 10);\n            if (exp >= 0) {\n                decpart = padRight(m[1], exp, '0');\n                intpart += decpart.substr(0, exp);\n                decpart = decpart.substr(exp);\n            } else {\n                intpart = padLeft(intpart, -exp, '0');\n                decpart = intpart.substr(exp) + m[1];\n                intpart = intpart.substr(0, intpart.length + exp);\n            }\n        }\n        return {\n            intpart: intpart || '0',\n            decpart: decpart\n        };\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        },\n        makeDateFormat: makeDateFormat\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var NameRef = spreadsheet.NameRef;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return numbers.length ? Math.min.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('max', function (numbers) {\n        return numbers.length ? Math.max.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                'area',\n                '#matrix',\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    function fetchSumRange(continuation) {\n        return function (callback, range, criteria, sumRange) {\n            var self = this;\n            if (sumRange instanceof Ref) {\n                var r = sumRange.clone().toRangeRef();\n                if (r.width() != range.width || r.height() != range.height) {\n                    if (!isFinite(r.topLeft.row)) {\n                        r.topLeft.row = 0;\n                    }\n                    if (!isFinite(r.topLeft.col)) {\n                        r.topLeft.col = 0;\n                    }\n                    r.bottomRight.row = r.topLeft.row + range.height - 1;\n                    r.bottomRight.col = r.topLeft.col + range.width - 1;\n                    return self.resolveCells([r], function () {\n                        callback(continuation(range, criteria, self.asMatrix(r)));\n                    });\n                }\n            }\n            callback(continuation(range, criteria, self.asMatrix(sumRange)));\n        };\n    }\n    defineFunction('sumif', fetchSumRange(function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    })).argsAsync(ARGS_SUMIF);\n    defineFunction('averageif', fetchSumRange(function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    })).argsAsync(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number!'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            var ref = exp.ast;\n            if (ref instanceof NameRef) {\n                ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            }\n            if (!(ref instanceof Ref)) {\n                throw 1;\n            }\n            return ref.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0DECIMALS;($#,##0DECIMALS)';\n        var dec = '';\n        var denomitator = 1;\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        while (++decimals < 0) {\n            denomitator *= 10;\n        }\n        if (dec !== '') {\n            dec = '.' + dec;\n        } else if (denomitator !== 1) {\n            number = Math.round(number / denomitator) * denomitator;\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var scale = Math.pow(10, decimals);\n        number = Math.round(number * scale) / scale;\n        var format = noCommas ? '0' : '#,##0';\n        if (decimals > 0) {\n            format += '.';\n            while (decimals-- > 0) {\n                format += '0';\n            }\n        }\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var a = text.split(oldText);\n        if (nth == null) {\n            return a.join(newText);\n        }\n        text = '';\n        nth--;\n        for (var i = 0; i < a.length; ++i) {\n            text += a[i];\n            if (i < a.length - 1) {\n                if (i === nth) {\n                    text += newText;\n                } else {\n                    text += oldText;\n                }\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        whipNumberArrays(x_, y_);\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n    function whipNumberArrays(a, b) {\n        for (var i = a.length; --i >= 0;) {\n            if (typeof a[i] != 'number' || typeof b[i] != 'number') {\n                a.splice(i, 1);\n                b.splice(i, 1);\n            }\n        }\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border'\n        };\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-' + kendo.ns + 'bind=\\'click: apply\\'><span class=\\'k-button-text\\'>' + COLOR_PICKER_MESSAGES.apply + '</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-' + kendo.ns + 'bind=\\'click: close\\'><span class=\\'k-button-text\\'>' + COLOR_PICKER_MESSAGES.cancel + '</span></button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 'auto',\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[' + kendo.attr('role') + '=flatcolorpicker]').data('kendoFlatColorPicker')._view._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a role=\\'button\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-button-icon k-icon k-i-reset-color\\'></span>' + '<span class=\"k-button-text\">' + COLOR_PICKER_MESSAGES.reset + '</span>' + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a role=\\'button\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-button-icon k-icon\\'></span>' + '<span class=\"k-button-text\">' + COLOR_PICKER_MESSAGES.customColor + '</span>' + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a role=\"button\" title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button\">' + '<span class=\"k-button-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                text: 'Text',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            insertComment: 'Insert comment',\n            insertImage: 'Insert image',\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sort: 'Sort',\n            sortButtons: {\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'insertComment',\n                'insertImage',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'file-excel'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'file-excel'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decimal-decrease'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'decimal-increase'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'align-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'paint'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'foreground-color'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'font-family'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'custom-format'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'cells-merge'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'pane-freeze'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'borders-all'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'link-horizontal',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'border-no',\n                togglable: true\n            },\n            insertComment: {\n                type: 'dialog',\n                dialogName: 'insertComment',\n                property: 'comment',\n                togglable: true,\n                overflow: 'never',\n                iconClass: 'comment',\n                text: ''\n            },\n            insertImage: {\n                type: 'dialog',\n                dialogName: 'insertImage',\n                overflow: 'never',\n                iconClass: 'image',\n                text: ''\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'table-column-insert-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'table-column-insert-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'table-row-insert-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'table-row-insert-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'table-column-delete'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'table-row-delete'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                var that = this;\n                this.element.on('keydown', function (e) {\n                    var tool;\n                    if (e.keyCode === 9) {\n                        tool = that._nextTool(e.shiftKey ? -1 : 1);\n                        if (tool) {\n                            document.activeElement.blur();\n                            if ($(tool).is('.k-upload-button')) {\n                                $(tool).addClass('k-focus');\n                            }\n                            if ($(tool).find('input').length) {\n                                $(tool).find('input').trigger('focus');\n                            } else {\n                                tool.focus();\n                            }\n                            e.preventDefault();\n                        }\n                    }\n                });\n                this.element.on('focusout', function () {\n                    $(this).find('.k-toolbar-first-visible').removeClass('k-focus');\n                });\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _nextTool: function (direction) {\n                var that = this;\n                var tools = that.element.find('.k-widget, .k-button, .k-button-group > a');\n                var activeIndex = tools.index($(document.activeElement).closest('.k-widget, .k-button, .k-button-group > a'));\n                if (activeIndex > 0) {\n                    return tools[activeIndex + direction];\n                }\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\'></span>');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: { showText: 'overflow' },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment: { spriteCssClass: spriteCssClass },\n                        merge: { spriteCssClass: spriteCssClass },\n                        freeze: { spriteCssClass: spriteCssClass }\n                    };\n                    var tool = kendo.deepExtend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: {\n                            title: MESSAGES[options.name || toolName],\n                            'aria-label': MESSAGES[options.name || toolName]\n                        }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if (Array.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        if (toolbar.options.hasOwnProperty('value')) {\n                            toggle = toolbar.options.value === value;\n                        } else {\n                            toggle = value != null;\n                        }\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                    if (tool.type == 'filter') {\n                        var selection = range.sheet().selection();\n                        var enabled = value || selection._ref.height() > 1;\n                        toolbar.enable(enabled);\n                        overflow.enable(enabled);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n                this.resize();\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').attr('title', options.attributes.title).attr('aria-label', options.attributes.title).kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth > 0) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var that = this;\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    setTimeout(function () {\n                        that.toolbar.dialog({ name: popupName });\n                    });\n                } else {\n                    that.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a role=\\'button\\' href=\\'#\\' class=\\'k-button k-button-md k-rounded-md  k-button-rectangle k-button-solid k-button-solid-base\\'>' + '<span class=\\'k-button-icon k-icon ' + options.spriteCssClass + '\\'></span>' + '<span class=\\'k-button-text\\'><span class=\\'k-icon k-i-arrow-s\\'></span></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.on('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this._title = options.attributes.title;\n                this.element = $('<button type=\\'button\\' role=\\'button\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button\\'>' + '<span class=\\'k-button-icon k-icon k-i-download\\'></span>' + '</button>').attr('title', this._title).attr('aria-label', this._title).data('instance', this);\n                this.element.on('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').attr('aria-label', options.attributes.title).attr('title', options.attributes.title).kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-button-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-button-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: '@',\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.text,\n                        name: MESSAGES.formatTypes.text\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'align-left',\n                        text: MESSAGES.alignmentButtons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'align-center',\n                        text: MESSAGES.alignmentButtons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'align-right',\n                        text: MESSAGES.alignmentButtons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'align-justify',\n                        text: MESSAGES.alignmentButtons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentButtons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentButtons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentButtons.alignBottom\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a role=\\'button\\' title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button\\'>' + '<span class=\\'k-button-icon k-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'cells',\n                        iconClass: 'cells-merge',\n                        text: MESSAGES.mergeButtons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'cells-merge-horizontally',\n                        text: MESSAGES.mergeButtons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'cells-merge-vertically',\n                        text: MESSAGES.mergeButtons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.mergeButtons.unmerge\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a role=\\'button\\' title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\'>' + '<span class=\\'k-button-icon k-icon k-i-' + options.iconClass + '\\'></span>' + '<span class=\\'k-button-text\\'>' + options.text + '</span>' + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'panes',\n                        iconClass: 'pane-freeze',\n                        text: MESSAGES.freezeButtons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'row-freeze',\n                        text: MESSAGES.freezeButtons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'column-freeze',\n                        text: MESSAGES.freezeButtons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.freezeButtons.unfreeze\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a role=\\'button\\' title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\'>' + '<span class=\\'k-button-icon k-icon k-i-' + options.iconClass + '\\'></span>' + '<span class=\\'k-button-text\\'>' + options.text + '</span>' + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-upload-button k-icon-button\\'>' + '<span class=\\'k-button-icon k-icon k-i-folder-open\\'></span>' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.find('input').remove();\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).attr('aria-label', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a role=\\'button\\' href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button\\' aria-label=\\'#= title #\\'><span class=\\'k-button-icon k-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div></div>').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            confirmationDialog: {\n                text: 'Are you sure you want to remove this sheet?',\n                title: 'Sheet remove'\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                defaultFileName: 'Workbook',\n                xlsx: { description: 'Excel Workbook (.xlsx)' },\n                pdf: {\n                    description: 'Portable Document Format (.pdf)',\n                    area: {\n                        workbook: 'Entire Workbook',\n                        sheet: 'Active Sheet',\n                        selection: 'Selection'\n                    },\n                    paper: {\n                        a2: 'A2 (420 mm \\xD7 594 mm)',\n                        a3: 'A3 (297 mm x 420 mm)',\n                        a4: 'A4 (210 mm x 297 mm)',\n                        a5: 'A5 (148 mm x 210 mm)',\n                        b3: 'B3 (353 mm \\xD7 500 mm)',\n                        b4: 'B4 (250 mm x 353 mm)',\n                        b5: 'B5 (176 mm x 250 mm)',\n                        folio: 'Folio (8.5\" x 13\")',\n                        legal: 'Legal (8.5\" x 14\")',\n                        letter: 'Letter (8.5\" x 11\")',\n                        tabloid: 'Tabloid (11\" x 17\")',\n                        executive: 'Executive (7.25\" x 10.5\")'\n                    },\n                    margin: {\n                        normal: 'Normal',\n                        narrow: 'Narrow',\n                        wide: 'Wide'\n                    }\n                },\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            intersectsArrayDialog: { errorMessage: 'You cannot alter part of an array' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            },\n            insertCommentDialog: {\n                title: 'Insert comment',\n                labels: {\n                    comment: 'Comment',\n                    removeComment: 'Remove comment'\n                }\n            },\n            insertImageDialog: {\n                title: 'Insert image',\n                info: 'Drag an image here, or click to select',\n                typeError: 'Please select a JPEG, PNG or GIF image'\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = translate($.extend(true, {}, this.options, options));\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window k-popup-edit-form\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        ns: kendo.ns,\n                        errors: this.options.errors\n                    })).kendoWindow(options).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n                this.dialog().element.find('.k-button-solid-primary').trigger('focus');\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-edit-form-container\\'>' + '<div class=\\'k-root-tabs\\' data-#:ns#role=\\'tabstrip\\' ' + 'data-#:ns#text-field=\\'name\\' ' + 'data-#:ns#bind=\\'source: categories, value: categoryFilter\\' ' + 'data-#:ns#animation=\\'false\\'></div>' + '<div class=\\'k-spreadsheet-preview\\' data-#:ns#bind=\\'text: preview\\'></div>' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-#:ns#role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-#:ns#text-field=\\'description\\' ' + 'data-#:ns#value-field=\\'value.name\\' ' + 'data-#:ns#bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\'></select>' + '<ul data-#:ns#role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-#:ns#template=\\'format-item-template\\' ' + 'data-#:ns#value-primitive=\\'true\\' ' + 'data-#:ns#value-field=\\'value\\' ' + 'data-#:ns#bind=\\'source: formats, value: format\\'></ul>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#: messages.apply #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: close\\'><span class=\\'k-button-text\\'>#: messages.cancel #</span></button>' + '</div>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-#:ns#bind=\\'text: text\\'></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: close\\'>' + '<span class=\\'k-button-text\\'>#= messages.okText #</span>' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: 'k-spreadsheet-message',\n                messageId: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-#:ns#bind=\\'text: text\\'></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: confirm\\'>' + '<span class=\\'k-button-text\\'>#= messages.okText #</span>' + '</button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: cancel\\'>' + '<span class=\\'k-button-text\\'>#= messages.cancel #</span>' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function () {\n                return this._confirmed;\n            },\n            confirm: function () {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('confirmation', ConfirmationDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-#:ns#bind=\\'text: text\\'></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: retry\\'>' + '<span class=\\'k-button-text\\'>#= messages.retry #</span>' + '</button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: cancel\\'>' + '<span class=\\'k-button-text\\'>#= messages.cancel #</span>' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function () {\n                this._retry = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#: messages.apply #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: close\\'><span class=\\'k-button-text\\'>#: messages.cancel #</span></button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div').first();\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#: messages.apply #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: close\\'><span class=\\'k-button-text\\'>#: messages.cancel #</span></button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div').first();\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div').first();\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'align-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'align-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'align-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'align-justify',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a role=\\'button\\' title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'cells-merge',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'cells-merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'cells-merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a role=\\'button\\' title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'pane-freeze',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'row-freeze',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'column-freeze',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a role=\\'button\\' title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">' + '<span class=\"k-tooltip-icon k-icon k-i-warning\"></span>' + '<span class=\"k-tooltip-content\">#= message #</span>' + '<span class=\"k-callout k-callout-n\"></span>' + '</div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-#:ns#role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.criteria #\"' + 'data-#:ns#text-field=\"name\" ' + 'data-#:ns#value-field=\"type\" ' + 'data-#:ns#bind=\"value: criterion, source: criteria\"></select>' + '</div>' + '<div data-#:ns#bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-#:ns#role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-#:ns#text-field=\"name\" ' + 'data-#:ns#value-field=\"type\" ' + 'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isNumber\" required=\"required\" /></span>' + '</div>' + '<div data-#:ns#bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span>' + '</div>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-#:ns#role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-#:ns#text-field=\"name\" ' + 'data-#:ns#value-field=\"type\" ' + 'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isText\" required=\"required\" /></span>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-#:ns#role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-#:ns#text-field=\"name\" ' + 'data-#:ns#value-field=\"type\" ' + 'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isDate\" required=\"required\" /></span>' + '</div>' + '<div data-#:ns#bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span>' + '</div>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isCustom\" required=\"required\" /></span>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isList\" required=\"required\" /></span>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' + '<label for=\"listShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' + '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"invisible: isAny\">' + '<div class=\"k-hr\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-#:ns#bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-#:ns#bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-#:ns#bind=\"value: hintTitle\" /></span>' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-#:ns#bind=\"value: hintMessage\" /></span>' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">#: messages.remove #</span></button>' + '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-#:ns#bind=\"click: apply\"><span class=\"k-button-text\">#: messages.apply #</span></button>' + '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"click: close\"><span class=\"k-button-text\">#: messages.cancel #</span></button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        function PDF_PAPER_SIZE(size) {\n            return {\n                value: size,\n                text: TEXT('exportAsDialog.pdf.paper.' + size)\n            };\n        }\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                options = this.options;\n                this.viewModel = kendo.observable({\n                    title: options.title,\n                    name: options.name,\n                    extension: options.extension,\n                    fileFormats: options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        autoPrint: options.pdfExport.autoPrint,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: options.pdf.fitWidth,\n                        area: options.pdf.area,\n                        areas: options.pdf.areas,\n                        paperSize: options.pdf.paperSize,\n                        paperSizes: options.pdf.paperSizes,\n                        margin: options.pdf.margin,\n                        margins: options.pdf.margins,\n                        landscape: options.pdf.landscape,\n                        guidelines: options.pdf.guidelines,\n                        hCenter: options.pdf.hCenter,\n                        vCenter: options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                title: TEXT('exportAsDialog.title', 'Export...'),\n                name: TEXT('exportAsDialog.defaultFileName', 'Workbook'),\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: TEXT('exportAsDialog.xlsx.description', 'Excel Workbook (.xlsx)'),\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: TEXT('exportAsDialog.pdf.description', 'Portable Document Format (.pdf)'),\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: TEXT('exportAsDialog.pdf.area.workbook', 'Entire Workbook')\n                        },\n                        {\n                            area: 'sheet',\n                            text: TEXT('exportAsDialog.pdf.area.sheet', 'Active Sheet')\n                        },\n                        {\n                            area: 'selection',\n                            text: TEXT('exportAsDialog.pdf.area.selection', 'Selection')\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        'a2',\n                        'a3',\n                        'a4',\n                        'a5',\n                        'b3',\n                        'b4',\n                        'b5',\n                        'folio',\n                        'legal',\n                        'letter',\n                        'tabloid',\n                        'executive'\n                    ].map(PDF_PAPER_SIZE),\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.normal', 'Normal')\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.narrow', 'Narrow')\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.wide', 'Wide')\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<span class=\\'k-textbox k-input k-input-md k-rounded-md k-input-solid\\'><input class=\\'k-input-inner\\' data-#:ns#bind=\\'value: name\\' /></span>' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-#:ns#role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-#:ns#text-field=\\'description\\' ' + 'data-#:ns#value-field=\\'extension\\' ' + 'data-#:ns#bind=\\'value: extension, source: fileFormats\\'></select>' + '</div>' + '</div>' + '<div class=\\'k-export-config\\' data-#:ns#bind=\\'visible: showPdfOptions\\'>' + '<hr class=\\'k-hr\\' />' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-#:ns#role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-#:ns#text-field=\\'text\\' ' + 'data-#:ns#value-field=\\'area\\' ' + 'data-#:ns#bind=\\'value: pdf.area, source: pdf.areas\\'></select>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-#:ns#role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-#:ns#text-field=\\'text\\' ' + 'data-#:ns#value-field=\\'value\\' ' + 'data-#:ns#bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\'></select>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-#:ns#role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-#:ns#value-primitive=\\'true\\'' + 'data-#:ns#text-field=\\'text\\' ' + 'data-#:ns#value-field=\\'value\\' ' + 'data-#:ns#bind=\\'value: pdf.margin, source: pdf.margins\\'></select>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<div class=\\'k-button-group\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-#:ns#type=\\'boolean\\' data-#:ns#bind=\\'checked: pdf.landscape\\' value=\\'false\\' />' + '<label class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button\\' for=\\'k-orientation-portrait\\'><span class=\\'k-button-icon k-icon k-i-page-portrait\\'></span></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-#:ns#type=\\'boolean\\' data-#:ns#bind=\\'checked: pdf.landscape\\' value=\\'true\\' />' + '<label class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button\\' for=\\'k-orientation-landscape\\'><span class=\\'k-button-icon k-icon k-i-page-landscape\\'></span></label>' + '</div>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox k-checkbox-md k-rounded-md\\' id=\\'guidelines\\' type=\\'checkbox\\' data-#:ns#bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox k-checkbox-md k-rounded-md\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-#:ns#bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox k-checkbox-md k-rounded-md\\' id=\\'hCenter\\' type=\\'checkbox\\' data-#:ns#bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox k-checkbox-md k-rounded-md\\' id=\\'vCenter\\' type=\\'checkbox\\' data-#:ns#bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\'>' + '<span class=\\'k-icon k-i-page-portrait\\' data-#:ns#bind=\\'invisible: pdf.landscape\\'></span>' + '<span class=\\'k-icon k-i-page-landscape\\' data-#:ns#bind=\\'visible: pdf.landscape\\'></span>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#: messages.save #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: close\\'><span class=\\'k-button-text\\'>#: messages.cancel #</span></button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('intersectsArray', 'intersectsArrayDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: 'Errors in import',\n                template: '<div class=\\'k-spreadsheet-message-content k-spreadsheet-import-errors\\'>' + '<div class=\\'k--header-message\\'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>' + '<div class=\\'k--errors\\'>' + '<table>' + '<thead>' + '<tr><th>Context</th><th>Error message</th></tr>' + '</thead>' + '# for (var i = 0; i < errors.length; ++i) { #' + '# var err = errors[i]; #' + '<tr><td>#: err.context #</td><td>#: err.error #</td></tr>' + '# } #' + '</table>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: close\\'>' + '<span class=\\'k-button-text\\'>#: messages.okText #</span>' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('importError', ImportErrorDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            options: {\n                title: TEXT('useKeyboardDialog.title', 'Copying and pasting'),\n                template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: close\\'>' + '<span class=\\'k-button-text\\'>#= messages.okText #</span>' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT('linkDialog.title', 'Hyperlink'),\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><span class=\\'k-textbox k-input k-input-md k-rounded-md k-input-solid\\'><input class=\\'k-input-inner\\' data-#:ns#bind=\\'value: url\\' title=\\'#: messages.linkDialog.labels.url #\\' /></span></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left\\' data-#:ns#bind=\\'click: remove\\'><span class=\\'k-button-text\\'>#= messages.linkDialog.labels.removeLink #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#= messages.okText #</span></button>' + '<button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: cancel\\'><span class=\\'k-button-text\\'>#= messages.cancel #</span></button>') + '</div>',\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').trigger('focus').on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n        var InsertCommentDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-insert-comment',\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.insertCommentDialog.labels.comment #:</label></div><div class=\\'k-edit-field\\'><span class=\\'k-input k-textarea k-input-solid k-input-md k-rounded-md\\'><textarea rows=\\'5\\' class=\\'k-input-inner\\' data-#:ns#bind=\\'value: comment\\'></textarea></span></div><div class=\\'k-action-buttons\\'>  <button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left\\' data-#:ns#bind=\\'click: remove\\'><span class=\\'k-button-text\\'>#: messages.insertCommentDialog.labels.removeComment #</span></button>  <button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'click: apply\\'><span class=\\'k-button-text\\'>#: messages.okText #</span></button>  <button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: cancel\\'><span class=\\'k-button-text\\'>#= messages.cancel #</span></button></div>',\n                title: TEXT('insertCommentDialog.title', 'Insert comment'),\n                autoFocus: false,\n                width: 450\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    comment: range.comment(),\n                    apply: function () {\n                        if (!/\\S/.test(model.comment)) {\n                            model.comment = null;\n                        }\n                        self.trigger('action', {\n                            command: 'InsertCommentCommand',\n                            options: { value: model.comment }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.comment = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('textarea').trigger('focus');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('insertComment', InsertCommentDialog);\n        var InsertImageDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-spreadsheet-insert-image-dialog\\'>  <label data-#:ns#bind=\\'style: { background-image: imageUrl },                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }\\'>    <div data-#:ns#bind=\\'text: info\\'></div>    <input type=\\'file\\' data-#:ns#bind=\\'events: { change: change }\\'           accept=\\'image/png, image/jpeg, image/gif\\' />  </label></div><div class=\\'k-action-buttons\\'>  <button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\' data-#:ns#bind=\\'enabled: okEnabled, click: apply\\'><span class=\\'k-button-text\\'>#: messages.okText #</span></button>  <button class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\' data-#:ns#bind=\\'click: cancel\\'><span class=\\'k-button-text\\'>#= messages.cancel #</span></button></div>',\n                title: TEXT('insertImageDialog.title', 'Insert image'),\n                width: 'auto'\n            },\n            open: function () {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    okEnabled: false,\n                    info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                    imageUrl: '',\n                    hasImage: false,\n                    isHovered: false,\n                    _url: null,\n                    _image: null,\n                    apply: function () {\n                        window.URL.revokeObjectURL(model._url);\n                        self.trigger('action', {\n                            command: 'InsertImageCommand',\n                            options: {\n                                blob: model._image,\n                                width: model._width,\n                                height: model._height\n                            }\n                        });\n                        self.close();\n                    },\n                    cancel: self.close.bind(self),\n                    stopEvent: function (ev) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    },\n                    drop: function (ev) {\n                        model.stopEvent(ev);\n                        model.selectFile(ev.originalEvent.dataTransfer.files);\n                        model.set('isHovered', false);\n                    },\n                    dragEnter: function (ev) {\n                        model.stopEvent(ev);\n                        model.set('isHovered', true);\n                    },\n                    dragLeave: function (ev) {\n                        model.stopEvent(ev);\n                        model.set('isHovered', false);\n                    },\n                    change: function (ev) {\n                        model.selectFile(ev.target.files);\n                    },\n                    selectFile: function (files) {\n                        var image;\n                        for (var i = 0; i < files.length; ++i) {\n                            if (/^image\\//i.test(files[i].type)) {\n                                image = files[i];\n                                break;\n                            }\n                        }\n                        if (model._url) {\n                            window.URL.revokeObjectURL(model._url);\n                        }\n                        if (image) {\n                            model._image = image;\n                            model._url = window.URL.createObjectURL(image);\n                            var img = new Image();\n                            img.src = model._url;\n                            img.onload = function () {\n                                model._width = img.width;\n                                model._height = img.height;\n                                model.set('info', kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                                model.set('okEnabled', true);\n                                model.set('imageUrl', 'url(\\'' + model._url + '\\')');\n                                model.set('hasImage', true);\n                            };\n                        } else {\n                            model._image = null;\n                            model.set('info', kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                            model.set('okEnabled', false);\n                            model.set('imageUrl', '');\n                            model.set('hasImage', false);\n                        }\n                    }\n                });\n                kendo.bind(element, model);\n            }\n        });\n        kendo.spreadsheet.dialogs.register('insertImage', InsertImageDialog);\n        function Localizable(path, def) {\n            this.path = path.split('.');\n            this.def = def;\n        }\n        Localizable.prototype.trans = function () {\n            var msg = kendo.spreadsheet.messages.dialogs;\n            for (var i = 0; i < this.path.length; ++i) {\n                msg = msg[this.path[i]];\n                if (!msg) {\n                    return this.def;\n                }\n            }\n            return msg;\n        };\n        function TEXT(path, def) {\n            return new Localizable(path, def);\n        }\n        function translate(thing) {\n            if (thing instanceof Localizable) {\n                return thing.trans();\n            } else if (Array.isArray(thing)) {\n                return thing.map(translate);\n            } else if (thing != null && typeof thing == 'object') {\n                return Object.keys(thing).reduce(function (ret, key) {\n                    ret[key] = translate(thing[key]);\n                    return ret;\n                }, {});\n            }\n            return thing;\n        }\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = kendo.jQuery.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('afterDeleteRow', this._sheetDeleteRowHandler).bind('afterInsertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var UnionRef = kendo.spreadsheet.UnionRef;\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var values = [];\n                    var sheet = this.sheet;\n                    var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n                    var setValues = function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                var currentValue = values[i][valueIndex][colValueIndex++];\n                                record.set(columns[ci].field, getters[ci](currentValue));\n                            }\n                            valueIndex++;\n                        }\n                    };\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    normalizedRef = sheet._grid.normalize(e.ref);\n                    if (!(normalizedRef instanceof UnionRef)) {\n                        normalizedRef = new UnionRef([normalizedRef]);\n                    }\n                    normalizedRefs = normalizedRef.refs;\n                    normalizedRefs.forEach(function (ref) {\n                        values.push(sheet.range(ref).values());\n                    });\n                    for (i = 0; i < normalizedRefs.length; i++) {\n                        rangeRef = normalizedRefs[i];\n                        rangeRef.forEach(setValues);\n                    }\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler).unbind('progress', this._progressHandler).unbind('error', this._errorHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                    this._progressHandler = this._requestStart.bind(this);\n                    this._errorHandler = this._error.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler).bind('progress', this._progressHandler).bind('error', this._errorHandler);\n            },\n            _error: function () {\n                this._progress(false);\n            },\n            _requestStart: function () {\n                this._progress(true);\n            },\n            _progress: function (toggle) {\n                this.sheet.trigger('progress', { toggle: toggle });\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                if (this.sheet.trigger('dataBinding')) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n                this._progress(false);\n                this.sheet.trigger('dataBound');\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler).unbind('progress', this._progressHandler).unbind('error', this._errorHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon',\n            iconCollapse: 'k-i-arrow-45-down-right',\n            iconExpand: 'k-i-arrow-60-right',\n            iconSearch: 'k-i-zoom',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        kendo.spreadsheet.messages.filterMenu = {\n            all: 'All',\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with',\n                    matches: 'Text matches',\n                    doesnotmatch: 'Text does not match'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-searchbox k-input k-input-md k-rounded-md k-input-solid\\'>' + '<span class=\\'k-input-icon k-icon k-i-search\\'></span>' + '<input class=\\'k-input-inner\\' autocomplete=\\'off\\' placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox k-checkbox-md k-rounded-md\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\'/><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '></div>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-#=ns#value-primitive=\"false\"' + 'data-#=ns#option-label=\"#=messages.operatorNone#\"' + 'data-#=ns#height=\"auto\"' + 'data-#=ns#text-field=\"text\"' + 'data-#=ns#value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\\'><span class=\\'k-button-text\\'>#=messages.apply#</span></button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\\'><span class=\\'k-button-text\\'>#=messages.clear#</span></button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                if (query.length || values && !values.length) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1) {\n                    item.checked = true;\n                }\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data.toJSON()[0].items;\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                if (!this.get('customFilter')) {\n                    this.reset();\n                }\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = kendo.spreadsheet.messages.filterMenu.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: kendo.spreadsheet.messages.filterMenu.all,\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent' || dataType === 'currency') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with',\n                        matches: 'Text matches',\n                        doesnotmatch: 'Text does not match'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul></ul>', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        this.action({\n                            command: 'SortCommand',\n                            options: options\n                        });\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: kendo.spreadsheet.messages.filterMenu,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[' + kendo.attr('role') + '=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[' + kendo.attr('role') + '=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({\n                    data: values,\n                    accentFoldingFiltering: kendo.culture().name\n                }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[' + kendo.attr('role') + '=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _blur: function () {\n                this.deactivate();\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                var viewElement = this.view.element, viewWidth, scrollerElement, scrollbarWidth;\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n                if (viewElement) {\n                    viewWidth = viewElement.width();\n                    scrollerElement = viewElement.find('.k-spreadsheet-scroller')[0];\n                    scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n                    this.cellInput.element.css('max-width', viewWidth - scrollbarWidth - this.cellInput.element.position().left + 'px');\n                }\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function (noChange) {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                this._active = false;\n                if (!noChange && cellInput.value() != this._value) {\n                    this.trigger('change', {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.trigger('focus');\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.trigger('focus');\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value, isArrayFormula) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n                this.barInput.element.toggleClass('k-spreadsheet-array-formula', !!isArrayFormula);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n            select: function () {\n                this.activeEditor().select();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        var hint = null;\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                if (cell.value != null) {\n                    hint = cell.value;\n                }\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange,\n            hint: hint\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props, true);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var comboBoxTitle = options.messages.nameBox || 'Name Box';\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                var comboElement = $('<input />').attr('title', comboBoxTitle).attr('aria-label', comboBoxTitle);\n                this.combo = comboElement.appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a role=\\'button\\' class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var kdrw = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n        var curr = 0;\n        var out = [];\n        var bottom = pageHeight;\n        var header = 0;\n        if (pageHeight && maxEmpty) {\n            maxEmpty *= pageHeight;\n        }\n        heights.forEach(function (h, i) {\n            if (headerRows != null && i < headerRows) {\n                header += h;\n            }\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < maxEmpty) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                    if (header > 0) {\n                        headerCoords.push(curr - header);\n                    }\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function doLayout(sheet, range, options) {\n        var grid = sheet._grid;\n        range = grid.normalize(range);\n        var wholeRect = grid.rectangle(range);\n        var drawings = [];\n        sheet._drawings.forEach(function (d) {\n            var box = sheet.drawingBoundingBox(d);\n            if (box.intersects(wholeRect)) {\n                drawings.push({\n                    drawing: d,\n                    box: box.offset(-wholeRect.left, -wholeRect.top)\n                });\n            }\n        });\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!options.forScreen) {\n                cell.drawings = drawings.filter(function (d) {\n                    var tl = d.drawing.topLeftCell;\n                    if (tl && tl.row == row && tl.col == col) {\n                        maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                        maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                        return true;\n                    }\n                });\n            }\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) || !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n                maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n            } else {\n                cell.empty = true;\n            }\n            cells.push(cell);\n        });\n        if (!options.forScreen) {\n            rowHeights = rowHeights.slice(0, maxRow + 1);\n            colWidths = colWidths.slice(0, maxCol + 1);\n        }\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = options.scale || 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n            }\n        }\n        pageWidth = Math.ceil(pageWidth / scaleFactor);\n        pageHeight = Math.ceil(pageHeight / scaleFactor);\n        var hyCoords = [];\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty, options.headerRows, hyCoords);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        var headerCells = [];\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            if (options.headerRows && cell.row < options.headerRows) {\n                headerCells.push(cell);\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            if (!options.forScreen) {\n                cell.drawings.forEach(function (d) {\n                    var box = d.box;\n                    box.left = cell.left + d.drawing.offsetX;\n                    box.top = cell.top + d.drawing.offsetY;\n                    box.right = box.left + box.width;\n                    box.bottom = box.top + box.height;\n                });\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.width();\n                cell.rowspan = ref.height();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cell.row = relrow;\n                    cell.col = relcol;\n                    cells.push(cell);\n                }\n            });\n        });\n        if (options.headerRows) {\n            hyCoords.forEach(function (y) {\n                headerCells.forEach(function (cell) {\n                    cell = clone(cell);\n                    cell.top += y;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                });\n                yCoords.push(y);\n            });\n            yCoords.sort(orderCoords);\n        }\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(orderCells),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords,\n            drawings: drawings\n        };\n    }\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function (copy, key) {\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n    function sameBorder(a, b) {\n        return a.size === b.size && a.color === b.color;\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderRight != null || cell.borderBottom != null || cell.validation != null && !cell.validation.value || cell.drawings && cell.drawings.length;\n    }\n    function orderCells(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function orderCoords(a, b) {\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n    function drawLayout(sheet, layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n        var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n        for (var j = 0; j < nrows; ++j) {\n            for (var i = 0; i < ncols; ++i) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            function isInside(box) {\n                if (box.right <= left || box.left >= right || box.bottom <= top || box.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(box.bottom, endbottom);\n                endright = Math.max(box.right, endright);\n                return true;\n            }\n            var cells = layout.cells.filter(isInside);\n            var drawings = layout.drawings.filter(function (d) {\n                return isInside(d.box);\n            });\n            endbottom = Math.min(endbottom, bottom);\n            endright = Math.min(endright, right);\n            if (cells.length || drawings.length) {\n                var page = new kdrw.Group();\n                group.append(page);\n                var content = new kdrw.Group();\n                page.append(content);\n                content.clip(kdrw.Path.fromRect(new geo.Rect([\n                    left - 1,\n                    top - 1\n                ], [\n                    endright + 1,\n                    endbottom + 1\n                ])));\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new kdrw.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new kdrw.Path().moveTo(left, y).lineTo(endright, y).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = Borders();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, options);\n                    borders.add(cell, sheet);\n                });\n                var bordersGroup = new kdrw.Group();\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new kdrw.Path().moveTo(b.x, b.top).lineTo(b.x, b.bottom).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new kdrw.Path().moveTo(b.left, b.y).lineTo(b.right, b.y).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                content.append(bordersGroup);\n                drawings.forEach(function (d) {\n                    var drawing = d.drawing;\n                    var image = drawing.image;\n                    if (image != null) {\n                        var box = d.box;\n                        var url = sheet._workbook.imageUrl(image);\n                        content.append(new kdrw.Image(url, new geo.Rect([\n                            box.left,\n                            box.top\n                        ], [\n                            box.width,\n                            box.height\n                        ])).opacity(drawing.opacity));\n                    }\n                });\n            }\n        }\n    }\n    function drawCell(cell, content, options) {\n        var g = new kdrw.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n            }\n            g.append(new kdrw.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new kdrw.Group();\n            clip.clip(kdrw.Path.fromRect(rect));\n            g.append(clip);\n            var f, format = cell.format;\n            if (!format && type == 'number' && val != Math.floor(val)) {\n                format = '0.##############';\n            }\n            if (format) {\n                f = formatting.textAndColor(val, format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function applyIndent(cell, style) {\n        if (cell.indent) {\n            var indent = 1.4 * cell.indent;\n            switch (style.textAlign) {\n            case null:\n            case 'left':\n                style.paddingLeft = indent + 'ch';\n                break;\n            case 'right':\n                style.paddingRight = indent + 'ch';\n                break;\n            case 'center':\n                style.paddingLeft = indent / 2 + 'ch';\n                style.paddingRight = indent / 2 + 'ch';\n                break;\n            }\n        }\n    }\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement('div');\n            CONT.style.position = 'fixed';\n            CONT.style.left = '0px';\n            CONT.style.top = '0px';\n            CONT.style.visibility = 'hidden';\n            CONT.style.overflow = 'hidden';\n            CONT.style.boxSizing = 'border-box';\n            CONT.style.lineHeight = 'normal';\n            document.body.appendChild(CONT);\n        }\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n        CONT.style.padding = '2px 4px';\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + 'px';\n        CONT.style.textAlign = cell.textAlign || 'left';\n        CONT.style.textDecoration = cell.underline ? 'underline' : 'none';\n        applyIndent(cell, CONT.style);\n        if (cell.wrap) {\n            CONT.style.whiteSpace = 'pre-wrap';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'break-word';\n        } else {\n            CONT.style.whiteSpace = 'pre';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'normal';\n        }\n        CONT.appendChild(document.createTextNode(text));\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = cell.height - CONT.offsetHeight >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = cell.height - CONT.offsetHeight;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        var text_group = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n        group.append(text_group);\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            guideColor: '#aaa',\n            emptyCells: true,\n            fitWidth: false,\n            center: false,\n            headerRows: null,\n            maxEmpty: 0.2,\n            scale: 1\n        }, options);\n        var group = new kdrw.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title,\n            autoPrint: options.autoPrint\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right + 1;\n            pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(sheet, layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    function Container() {\n    }\n    Container.prototype = {\n        forEach: function (f) {\n            Object.keys(this).forEach(function (key) {\n                f(this[key], key, this);\n            }, this);\n        }\n    };\n    function Borders() {\n        var horiz = new Container();\n        var vert = new Container();\n        function add(cell, sheet) {\n            if (sheet) {\n                var pb = sheet._properties;\n                var grid = sheet._grid;\n                cell.borderLeft = pb.get('vBorders', grid.index(cell.row, cell.col));\n                cell.borderRight = pb.get('vBorders', grid.index(cell.row, cell.col + cell.colspan));\n                cell.borderTop = pb.get('hBorders', grid.index(cell.row, cell.col));\n                cell.borderBottom = pb.get('hBorders', grid.index(cell.row + cell.rowspan, cell.col));\n            }\n            if (cell.borderLeft) {\n                addVert(cell.row, cell.col, cell.borderLeft, cell.left, cell.top, cell.bottom);\n            }\n            if (cell.borderRight) {\n                addVert(cell.row, cell.col + cell.colspan, cell.borderRight, cell.right, cell.top, cell.bottom);\n            }\n            if (cell.borderTop) {\n                addHoriz(cell.row, cell.col, cell.borderTop, cell.top, cell.left, cell.right);\n            }\n            if (cell.borderBottom) {\n                addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom, cell.bottom, cell.left, cell.right);\n            }\n        }\n        function addVert(row, col, border, x, top, bottom) {\n            var a = vert[col] || (vert[col] = new Container());\n            var prev = row > 0 && a[row - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[row] = prev;\n                prev.bottom = bottom;\n            } else {\n                a[row] = {\n                    size: border.size,\n                    color: border.color,\n                    x: x,\n                    top: top,\n                    bottom: bottom\n                };\n            }\n        }\n        function addHoriz(row, col, border, y, left, right) {\n            var a = horiz[row] || (horiz[row] = new Container());\n            var prev = col > 0 && a[col - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[col] = prev;\n                prev.right = right;\n            } else {\n                a[col] = {\n                    size: border.size,\n                    color: border.color,\n                    y: y,\n                    left: left,\n                    right: right\n                };\n            }\n        }\n        return {\n            add: add,\n            horiz: horiz,\n            vert: vert\n        };\n    }\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n        options = clone(options, {\n            dataSource: null,\n            guidelines: true,\n            guideColor: '#000',\n            columns: null,\n            headerBackground: '#999',\n            headerColor: '#000',\n            oddBackground: null,\n            evenBackground: null,\n            fontFamily: 'Arial',\n            fontSize: 12,\n            paperSize: 'A4',\n            margin: '1cm',\n            landscape: true,\n            fitWidth: false,\n            scale: 1,\n            rowHeight: 20,\n            maxEmpty: 1,\n            useGridFormat: true\n        });\n        kendo.drawing.pdf.defineFont(kendo.drawing.drawDOM.getFontFaces(document));\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n        var border = options.guidelines ? {\n            size: 1,\n            color: options.guideColor\n        } : null;\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n        options.dataSource.fetch(function () {\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject('Empty dataset');\n            }\n            var columns = options.columns.map(function (col) {\n                if (typeof col == 'string') {\n                    return {\n                        title: col,\n                        field: col\n                    };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function (col) {\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n            var rows = data.map(function (row, rowIndex) {\n                return {\n                    cells: columns.map(function (col, colIndex) {\n                        var value = row[col.field];\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += '';\n                                }\n                            }\n                            columnWidths[colIndex] = Math.max(textWidth(value), columnWidths[colIndex]);\n                        }\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n            rows.unshift({\n                cells: columnTitles.map(function (label) {\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n            var sheet = new kendo.spreadsheet.Sheet(rows.length + 1, columns.length + 1, options.rowHeight, 50, 20, 20, {\n                fontFamily: options.fontFamily,\n                fontSize: options.fontSize,\n                verticalAlign: 'center'\n            });\n            sheet.fromJSON({\n                name: 'Sheet1',\n                rows: rows,\n                columns: columnWidths.map(function (w, i) {\n                    return {\n                        index: i,\n                        width: w\n                    };\n                })\n            });\n            sheet.draw({\n                paperSize: options.paperSize,\n                landscape: options.landscape,\n                margin: options.margin,\n                guidelines: false,\n                scale: options.scale,\n                fitWidth: options.fitWidth,\n                maxEmpty: options.maxEmpty,\n                headerRows: 1\n            }, progress.resolve.bind(progress));\n        });\n        return promise;\n    }\n    var CACHE_CHAR_WIDTH = {};\n    var charWidthFunction = function (fontFamily, fontSize) {\n        var id = fontSize + ':' + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement('div');\n            div.style.position = 'fixed';\n            div.style.left = '-10000px';\n            div.style.top = '-10000px';\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + 'px';\n            div.style.whiteSpace = 'pre';\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement('span');\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while (span = div.firstChild) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function (ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    span = document.createElement('span');\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n    spreadsheet.draw = {\n        Borders: Borders,\n        doLayout: doLayout,\n        applyIndent: applyIndent\n    };\n    spreadsheet.drawTabularData = drawTabularData;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var keys = $.extend({\n            F10: 121,\n            F11: 122,\n            B: 66,\n            I: 73,\n            U: 85,\n            N: 78,\n            H: 72,\n            A: 65,\n            PAGEDOWN: 34,\n            PAGEUP: 33,\n            DELETE: 46,\n            R: 82\n        }, kendo.keys);\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this._view.enableClipboard(false);\n                this.refresh();\n                this._view.enableClipboard(true);\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n                this.element.on('keydown' + NS, this._keyDown.bind(this));\n            },\n            _keyDown: function (e) {\n                var key = e.keyCode;\n                var redoTool = $('.k-spreadsheet-quick-access-toolbar [title=Redo]');\n                if (key === keys.F11 && e.shiftKey) {\n                    this._view.sheetsbar._onAddSelect();\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.PAGEDOWN) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.PAGEUP) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.DELETE) {\n                    var closeCallback = function (e) {\n                        var dlg = e.sender;\n                        if (dlg.isConfirmed()) {\n                            this._view.sheetsbar.trigger('remove', {\n                                name: this.activeSheet()._name(),\n                                confirmation: true\n                            });\n                        }\n                    }.bind(this);\n                    this._view.sheetsbar._openDialog('confirmation', { close: closeCallback });\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.R) {\n                    this._view.sheetsbar._createEditor();\n                    e.preventDefault();\n                    return;\n                } else if (key === keys.F10 && this._view.tabstrip || key === keys.TAB && !e.shiftKey && $(document.activeElement).is(redoTool)) {\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find(':not(.k-overflow-anchor):kendoFocusable').first().trigger('focus');\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find('.k-toolbar-first-visible').addClass('k-focus');\n                    e.preventDefault();\n                    return;\n                } else if (e.ctrlKey && key === keys.B) {\n                    $('[data-tool=bold]')[0].click();\n                } else if (e.ctrlKey && key === keys.I) {\n                    $('[data-tool=italic]')[0].click();\n                } else if (e.ctrlKey && key === keys.U) {\n                    $('[data-tool=underline]')[0].click();\n                } else if (e.altKey && key === keys.H) {\n                    this._view.tabstrip.select(0);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.N) {\n                    this._view.tabstrip.select(1);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.A) {\n                    this._view.tabstrip.select(2);\n                    e.preventDefault();\n                    return;\n                }\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChanging: function (e) {\n                if (this.trigger('changing', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render(reason);\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            saveJSON: function () {\n                return this._workbook.saveJSON();\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'></div>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertSheet: function (e) {\n                if (this.trigger('insertSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRemoveSheet: function (e) {\n                if (this.trigger('removeSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelectSheet: function (e) {\n                if (this.trigger('selectSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRenameSheet: function (e) {\n                if (this.trigger('renameSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertRow: function (e) {\n                if (this.trigger('insertRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertColumn: function (e) {\n                if (this.trigger('insertColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteRow: function (e) {\n                if (this.trigger('deleteRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideRow: function (e) {\n                if (this.trigger('hideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideColumn: function (e) {\n                if (this.trigger('hideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideRow: function (e) {\n                if (this.trigger('unhideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _workbookChangeFormat: function (e) {\n                this.trigger('changeFormat', e);\n            },\n            _workbookDataBinding: function (e) {\n                if (this.trigger('dataBinding', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDataBound: function (e) {\n                this.trigger('dataBound', e);\n            },\n            _workbookProgress: function (e) {\n                kendo.ui.progress(this.element, e.toggle);\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('changing', this._workbookChanging.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n                this._workbook.bind('insertSheet', this._workbookInsertSheet.bind(this));\n                this._workbook.bind('removeSheet', this._workbookRemoveSheet.bind(this));\n                this._workbook.bind('selectSheet', this._workbookSelectSheet.bind(this));\n                this._workbook.bind('renameSheet', this._workbookRenameSheet.bind(this));\n                this._workbook.bind('insertRow', this._workbookInsertRow.bind(this));\n                this._workbook.bind('insertColumn', this._workbookInsertColumn.bind(this));\n                this._workbook.bind('deleteRow', this._workbookDeleteRow.bind(this));\n                this._workbook.bind('deleteColumn', this._workbookDeleteColumn.bind(this));\n                this._workbook.bind('hideRow', this._workbookHideRow.bind(this));\n                this._workbook.bind('hideColumn', this._workbookHideColumn.bind(this));\n                this._workbook.bind('unhideRow', this._workbookUnhideRow.bind(this));\n                this._workbook.bind('unhideColumn', this._workbookUnhideColumn.bind(this));\n                this._workbook.bind('select', this._workbookSelect.bind(this));\n                this._workbook.bind('changeFormat', this._workbookChangeFormat.bind(this));\n                this._workbook.bind('dataBinding', this._workbookDataBinding.bind(this));\n                this._workbook.bind('dataBound', this._workbookDataBound.bind(this));\n                this._workbook.bind('progress', this._workbookProgress.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: 'Arial',\n                    fontSize: 12\n                },\n                useCultureDecimals: false\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            cellContextMenu: function () {\n                return this._view.cellContextMenu;\n            },\n            rowHeaderContextMenu: function () {\n                return this._view.rowHeaderContextMenu;\n            },\n            colHeaderContextMenu: function () {\n                return this._view.colHeaderContextMenu;\n            },\n            addImage: function (image) {\n                return this._workbook.addImage(image);\n            },\n            cleanupImages: function () {\n                return this._workbook.cleanupImages();\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'changing',\n                'change',\n                'render',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'insertSheet',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat',\n                'dataBinding',\n                'dataBound'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}